<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoLib - Espace Client</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header .client-badge { background: #2c3e50; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; display: inline-block; margin-top: 10px; }
        .card { background: white; border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); }
        .card h2 { color: #3498db; margin-bottom: 15px; }
        .btn { background: linear-gradient(45deg, #3498db, #2980b9); color: white; border: none; padding: 12px 24px; border-radius: 25px; cursor: pointer; font-size: 16px; margin: 5px; transition: all 0.3s ease; }
        .btn:hover { transform: translateY(-2px); }
        .btn.success { background: linear-gradient(45deg, #27ae60, #2ecc71); }
        .btn.warning { background: linear-gradient(45deg, #f39c12, #e67e22); }
        .progress-bar { background: #ecf0f1; border-radius: 10px; height: 20px; margin: 10px 0; }
        .progress-fill { background: linear-gradient(45deg, #3498db, #2980b9); height: 100%; border-radius: 10px; transition: width 0.3s ease; }
        .status-badge { padding: 5px 12px; border-radius: 15px; font-size: 0.8em; font-weight: bold; }
        .status-open { background: #e8f5e8; color: #27ae60; }
        .status-progress { background: #fff3cd; color: #856404; }
        .status-closed { background: #d1ecf1; color: #0c5460; }
        .result { background: #f8f9fa; border-left: 4px solid #3498db; padding: 15px; margin-top: 15px; border-radius: 5px; }
        .success { border-left-color: #27ae60; background: #d4edda; }
        .error { border-left-color: #e74c3c; background: #f8d7da; }
        .warning { border-left-color: #f39c12; background: #fff3cd; }
        .info { border-left-color: #17a2b8; background: #d1ecf1; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #333; }
        .input-group input, .input-group select, .input-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; background: #ecf0f1; border: none; border-radius: 5px; cursor: pointer; }
        .tab.active { background: #3498db; color: white; }
        .hidden { display: none; }
        .case-card { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 10px; padding: 20px; margin: 15px 0; }
        .timeline-item { border-left: 3px solid #3498db; padding-left: 15px; margin: 15px 0; }
        .document-item { background: #e9ecef; padding: 10px; border-radius: 5px; margin: 10px 0; display: flex; justify-content: between; align-items: center; }
        .upload-area { border: 2px dashed #3498db; border-radius: 10px; padding: 30px; text-align: center; margin: 20px 0; cursor: pointer; transition: all 0.3s ease; }
        .upload-area:hover { background: #f8f9fa; }
        .upload-area.dragover { background: #e3f2fd; border-color: #2196f3; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë§ Mon Espace Client</h1>
            <div class="client-badge">CLIENT - Acc√®s S√©curis√©</div>
            <p>Suivi de vos dossiers en temps r√©el</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('dashboard')">üè† Tableau de Bord</button>
            <button class="tab" onclick="showTab('cases')">üìÅ Mes Dossiers</button>
            <button class="tab" onclick="showTab('documents')">üìÑ Documents</button>
            <button class="tab" onclick="showTab('messages')">üí¨ Messages</button>
            <button class="tab" onclick="showTab('profile')">üë§ Mon Profil</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content">
            <div class="card">
                <h2>Vue d'ensemble</h2>
                <div id="dashboard-content">
                    <div class="result info">
                        <strong>Bienvenue dans votre espace personnel</strong><br>
                        Vous pouvez consulter l'avancement de vos dossiers, t√©l√©charger des documents et communiquer avec votre avocat en toute s√©curit√©.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                        <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;">2</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Dossiers Actifs</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;">5</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Documents Fournis</div>
                        </div>
                        <div style="background: linear-gradient(135deg, #f39c12, #e67e22); color: white; padding: 20px; border-radius: 10px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold;">1</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Action Requise</div>
                        </div>
                    </div>

                    <div class="result warning">
                        <strong>‚ö†Ô∏è Action Requise</strong><br>
                        Dossier "Divorce" : Merci de fournir votre attestation employeur avant le 15/03/2026
                    </div>
                </div>
            </div>
        </div>

        <!-- Cases Tab -->
        <div id="cases-tab" class="tab-content hidden">
            <div class="card">
                <h2>Mes Dossiers</h2>
                <button class="btn" onclick="loadMyCases()">Actualiser</button>
                <div id="cases-result">
                    <div class="case-card">
                        <h3>üìã Proc√©dure de Divorce</h3>
                        <div style="margin: 10px 0;">
                            <span class="status-badge status-progress">En cours</span>
                            <span style="float: right; color: #666;">Ouvert le 15/01/2026</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%;"></div>
                        </div>
                        <p style="margin: 10px 0; color: #666;">Progression: 60% - Phase de n√©gociation</p>
                        <p><strong>Prochaine √©tape :</strong> Audience de conciliation pr√©vue le 20/03/2026</p>
                        <p><strong>Documents manquants :</strong> Attestation employeur</p>
                        <button class="btn" onclick="viewCaseDetails(1)">Voir D√©tails</button>
                    </div>

                    <div class="case-card">
                        <h3>üè† Litige Syndic</h3>
                        <div style="margin: 10px 0;">
                            <span class="status-badge status-open">Ouvert</span>
                            <span style="float: right; color: #666;">Ouvert le 28/02/2026</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 25%;"></div>
                        </div>
                        <p style="margin: 10px 0; color: #666;">Progression: 25% - Analyse du dossier</p>
                        <p><strong>Prochaine √©tape :</strong> R√©daction de la mise en demeure</p>
                        <p><strong>Documents manquants :</strong> Aucun</p>
                        <button class="btn" onclick="viewCaseDetails(2)">Voir D√©tails</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Documents Tab -->
        <div id="documents-tab" class="tab-content hidden">
            <div class="card">
                <h2>Mes Documents</h2>
                
                <div class="upload-area" onclick="document.getElementById('file-input').click()">
                    <input type="file" id="file-input" style="display: none;" multiple accept=".pdf,.doc,.docx,.jpg,.png" onchange="handleFileUpload(event)">
                    <div style="font-size: 3em; color: #3498db; margin-bottom: 10px;">üìÅ</div>
                    <h3>T√©l√©charger des documents</h3>
                    <p>Cliquez ici ou glissez-d√©posez vos fichiers</p>
                    <p style="font-size: 0.9em; color: #666; margin-top: 10px;">Formats accept√©s: PDF, DOC, DOCX, JPG, PNG (Max 10 Mo)</p>
                </div>

                <div class="input-group">
                    <label>Associer au dossier</label>
                    <select id="document-case-select">
                        <option value="1">Proc√©dure de Divorce</option>
                        <option value="2">Litige Syndic</option>
                    </select>
                </div>

                <button class="btn success" onclick="uploadDocuments()">Confirmer l'envoi</button>

                <h3 style="margin-top: 30px;">Documents envoy√©s</h3>
                <div id="documents-list">
                    <div class="document-item">
                        <div>
                            <strong>üìÑ Copie carte identit√©.pdf</strong><br>
                            <small>Envoy√© le 16/01/2026 - Dossier: Divorce</small>
                        </div>
                        <span class="status-badge status-open">Re√ßu</span>
                    </div>
                    <div class="document-item">
                        <div>
                            <strong>üìÑ Relev√© compte janvier.pdf</strong><br>
                            <small>Envoy√© le 18/01/2026 - Dossier: Divorce</small>
                        </div>
                        <span class="status-badge status-open">Re√ßu</span>
                    </div>
                    <div class="document-item">
                        <div>
                            <strong>üìÑ Contrat travail.pdf</strong><br>
                            <small>Envoy√© le 20/01/2026 - Dossier: Divorce</small>
                        </div>
                        <span class="status-badge status-open">Re√ßu</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messages Tab -->
        <div id="messages-tab" class="tab-content hidden">
            <div class="card">
                <h2>Messages avec mon Avocat</h2>
                
                <div style="background: #f8f9fa; border-radius: 10px; padding: 20px; margin: 20px 0; max-height: 400px; overflow-y: auto;">
                    <div style="margin-bottom: 20px;">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 10px; margin-bottom: 10px;">
                            <strong>Me Dupont</strong> <small style="color: #666;">Hier 14:30</small><br>
                            Bonjour, j'ai bien re√ßu vos documents. L'audience de conciliation est fix√©e au 20 mars. Je vous enverrai une convocation officielle dans les prochains jours.
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <div style="background: #fff; border: 1px solid #dee2e6; padding: 10px; border-radius: 10px; margin-left: 50px;">
                            <strong>Vous</strong> <small style="color: #666;">Hier 16:45</small><br>
                            Merci pour l'information. Dois-je pr√©parer quelque chose de particulier pour cette audience ?
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <div style="background: #e3f2fd; padding: 10px; border-radius: 10px; margin-bottom: 10px;">
                            <strong>Me Dupont</strong> <small style="color: #666;">Aujourd'hui 09:15</small><br>
                            Il nous manque encore votre attestation employeur. Pouvez-vous la fournir avant vendredi ? Pour l'audience, nous ferons un point ensemble la semaine prochaine.
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>Nouveau message</label>
                    <textarea id="new-message" rows="4" placeholder="Tapez votre message..."></textarea>
                </div>
                <button class="btn" onclick="sendMessage()">Envoyer Message</button>
            </div>
        </div>

        <!-- Profile Tab -->
        <div id="profile-tab" class="tab-content hidden">
            <div class="card">
                <h2>Mon Profil</h2>
                
                <div class="input-group">
                    <label>Nom complet</label>
                    <input type="text" id="profile-name" value="Sophie Martin" readonly>
                </div>
                
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="profile-email" value="sophie.martin@example.com" readonly>
                </div>
                
                <div class="input-group">
                    <label>T√©l√©phone</label>
                    <input type="tel" id="profile-phone" value="+33 6 12 34 56 78">
                </div>
                
                <div class="input-group">
                    <label>Adresse</label>
                    <textarea id="profile-address" rows="3">12 rue de la Paix
75001 Paris</textarea>
                </div>

                <div class="input-group">
                    <label>Notifications par email</label>
                    <select id="profile-notifications">
                        <option value="all">Toutes les notifications</option>
                        <option value="important" selected>Notifications importantes uniquement</option>
                        <option value="none">Aucune notification</option>
                    </select>
                </div>
                
                <button class="btn success" onclick="updateProfile()">Mettre √† jour</button>
                
                <div class="result info" style="margin-top: 20px;">
                    <strong>‚ÑπÔ∏è S√©curit√©</strong><br>
                    Vos donn√©es sont chiffr√©es et prot√©g√©es. Seul votre avocat peut acc√©der √† vos informations.
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5078';
        let token = localStorage.getItem('clientToken') || localStorage.getItem('authToken');
        let selectedFiles = [];

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            event.target.classList.add('active');
        }

        function showResult(elementId, message, isSuccess = true) {
            const element = document.getElementById(elementId);
            if (element) {
                const className = isSuccess ? 'success' : 'error';
                element.innerHTML = `<div class="result ${className}">${message}</div>`;
            }
        }

        function loadMyCases() {
            // Simulation du rechargement des dossiers
            showResult('cases-result', '‚úÖ Dossiers actualis√©s - Derni√®re mise √† jour: ' + new Date().toLocaleString('fr-FR'));
        }

        function viewCaseDetails(caseId) {
            const caseDetails = {
                1: {
                    title: "Proc√©dure de Divorce",
                    status: "En cours - Phase de n√©gociation",
                    progress: 60,
                    nextStep: "Audience de conciliation le 20/03/2026",
                    timeline: [
                        "15/01/2026 - Ouverture du dossier",
                        "18/01/2026 - R√©ception des documents initiaux",
                        "25/01/2026 - Premi√®re analyse juridique",
                        "02/02/2026 - √âchange avec la partie adverse",
                        "15/02/2026 - Pr√©paration de l'audience"
                    ]
                },
                2: {
                    title: "Litige Syndic",
                    status: "Ouvert - Analyse en cours",
                    progress: 25,
                    nextStep: "R√©daction mise en demeure",
                    timeline: [
                        "28/02/2026 - Ouverture du dossier",
                        "01/03/2026 - R√©ception de la documentation",
                        "05/03/2026 - Analyse des charges litigieuses"
                    ]
                }
            };

            const details = caseDetails[caseId];
            let html = `<div class="result info">
                <h3>${details.title}</h3>
                <p><strong>Statut:</strong> ${details.status}</p>
                <p><strong>Progression:</strong> ${details.progress}%</p>
                <p><strong>Prochaine √©tape:</strong> ${details.nextStep}</p>
                <h4>Chronologie:</h4>
                <ul>`;
            
            details.timeline.forEach(item => {
                html += `<li>${item}</li>`;
            });
            
            html += `</ul></div>`;
            
            document.getElementById('cases-result').innerHTML = html;
        }

        function handleFileUpload(event) {
            selectedFiles = Array.from(event.target.files);
            updateFileList();
        }

        function updateFileList() {
            if (selectedFiles.length > 0) {
                let html = '<div class="result success">üìÅ Fichiers s√©lectionn√©s:</div>';
                selectedFiles.forEach((file, index) => {
                    html += `<div class="document-item">
                        <div>
                            <strong>üìÑ ${file.name}</strong><br>
                            <small>Taille: ${(file.size / 1024 / 1024).toFixed(2)} Mo</small>
                        </div>
                        <button class="btn" style="background: #e74c3c;" onclick="removeFile(${index})">Supprimer</button>
                    </div>`;
                });
                document.getElementById('documents-list').innerHTML = html;
            }
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
        }

        async function uploadDocuments() {
            if (selectedFiles.length === 0) {
                alert('Veuillez s√©lectionner au moins un fichier');
                return;
            }

            const caseId = document.getElementById('document-case-select').value;
            
            // Simulation d'upload
            let html = '<div class="result success">‚úÖ Documents envoy√©s avec succ√®s!</div>';
            selectedFiles.forEach(file => {
                html += `<div class="document-item">
                    <div>
                        <strong>üìÑ ${file.name}</strong><br>
                        <small>Envoy√© le ${new Date().toLocaleDateString('fr-FR')} - Dossier: ${caseId === '1' ? 'Divorce' : 'Litige Syndic'}</small>
                    </div>
                    <span class="status-badge status-success">Envoy√©</span>
                </div>`;
            });

            document.getElementById('documents-list').innerHTML = html;
            selectedFiles = [];
            document.getElementById('file-input').value = '';
        }

        async function sendMessage() {
            const message = document.getElementById('new-message').value;
            if (!message.trim()) {
                alert('Veuillez saisir un message');
                return;
            }

            // Simulation d'envoi de message
            const messagesContainer = document.querySelector('#messages-tab .card > div');
            const newMessage = document.createElement('div');
            newMessage.style.marginBottom = '20px';
            newMessage.innerHTML = `
                <div style="background: #fff; border: 1px solid #dee2e6; padding: 10px; border-radius: 10px; margin-left: 50px;">
                    <strong>Vous</strong> <small style="color: #666;">√Ä l'instant</small><br>
                    ${message}
                </div>
            `;
            messagesContainer.appendChild(newMessage);

            document.getElementById('new-message').value = '';
            
            // Simulation de r√©ponse automatique
            setTimeout(() => {
                const autoReply = document.createElement('div');
                autoReply.style.marginBottom = '20px';
                autoReply.innerHTML = `
                    <div style="background: #e3f2fd; padding: 10px; border-radius: 10px; margin-bottom: 10px;">
                        <strong>Me Dupont</strong> <small style="color: #666;">√Ä l'instant</small><br>
                        Message bien re√ßu. Je vous r√©ponds dans les plus brefs d√©lais.
                    </div>
                `;
                messagesContainer.appendChild(autoReply);
            }, 2000);
        }

        async function updateProfile() {
            const profileData = {
                phone: document.getElementById('profile-phone').value,
                address: document.getElementById('profile-address').value,
                notifications: document.getElementById('profile-notifications').value
            };

            // Simulation de mise √† jour
            showResult('profile-result', '‚úÖ Profil mis √† jour avec succ√®s');
        }

        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            selectedFiles = Array.from(e.dataTransfer.files);
            updateFileList();
        });

        // Auto-refresh notifications
        setInterval(() => {
            // Simulation de v√©rification de nouvelles notifications
            console.log('V√©rification des notifications...');
        }, 30000);
    </script>
</body>
</html>