<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture Embeddings - IAPosteManager</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">
            üèóÔ∏è Architecture OpenAI Embeddings - IAPosteManager
        </h1>

        <!-- Architecture Diagram -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-2xl font-bold mb-6 text-gray-700">Flux de Donn√©es</h2>
            
            <!-- Frontend -->
            <div class="mb-6 p-4 bg-blue-50 rounded-lg border-2 border-blue-300">
                <h3 class="text-xl font-bold text-blue-800 mb-3">üé® Frontend</h3>
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-blue-700">semantic-search-demo.html</div>
                        <div class="text-xs text-gray-600 mt-1">Interface de recherche</div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-blue-700">JavaScript Fetch API</div>
                        <div class="text-xs text-gray-600 mt-1">Appels REST</div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-blue-700">Affichage R√©sultats</div>
                        <div class="text-xs text-gray-600 mt-1">Scores de similarit√©</div>
                    </div>
                </div>
            </div>

            <!-- Arrow Down -->
            <div class="text-center text-3xl text-gray-400 my-4">‚Üì</div>

            <!-- API Layer -->
            <div class="mb-6 p-4 bg-green-50 rounded-lg border-2 border-green-300">
                <h3 class="text-xl font-bold text-green-800 mb-3">üîå API REST (Flask)</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-green-700">POST /api/ai/embeddings</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Body: {text: "...", model: "ada-002"}<br>
                            ‚Üí Cr√©ation d'embeddings
                        </div>
                        <div class="text-xs bg-yellow-100 p-1 rounded mt-2">
                            üîí Auth Required | ‚è± Rate Limit: 20/min
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-green-700">POST /api/ai/similarity</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Body: {embedding1: [...], embedding2: [...]}<br>
                            ‚Üí Calcul de similarit√©
                        </div>
                        <div class="text-xs bg-yellow-100 p-1 rounded mt-2">
                            üîí Auth Required
                        </div>
                    </div>
                </div>
            </div>

            <!-- Arrow Down -->
            <div class="text-center text-3xl text-gray-400 my-4">‚Üì</div>

            <!-- Service Layer -->
            <div class="mb-6 p-4 bg-purple-50 rounded-lg border-2 border-purple-300">
                <h3 class="text-xl font-bold text-purple-800 mb-3">‚öôÔ∏è UnifiedAIService (Backend)</h3>
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-purple-700">create_embedding()</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Param√®tres:<br>
                            ‚Ä¢ text: str<br>
                            ‚Ä¢ model: str<br>
                            ‚Ä¢ dimensions: int?
                        </div>
                        <div class="text-xs bg-green-100 p-1 rounded mt-2">
                            ‚Üí {embedding: [1536 floats]}
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-purple-700">batch_create_embeddings()</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Param√®tres:<br>
                            ‚Ä¢ texts: list[str]<br>
                            ‚Ä¢ model: str
                        </div>
                        <div class="text-xs bg-green-100 p-1 rounded mt-2">
                            ‚Üí {embeddings: [...], count: N}
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-purple-700">calculate_similarity()</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Param√®tres:<br>
                            ‚Ä¢ embedding1: list<br>
                            ‚Ä¢ embedding2: list
                        </div>
                        <div class="text-xs bg-green-100 p-1 rounded mt-2">
                            ‚Üí float (0.0 to 1.0)
                        </div>
                    </div>
                </div>
            </div>

            <!-- Arrow Down -->
            <div class="text-center text-3xl text-gray-400 my-4">‚Üì</div>

            <!-- OpenAI API -->
            <div class="mb-6 p-4 bg-orange-50 rounded-lg border-2 border-orange-300">
                <h3 class="text-xl font-bold text-orange-800 mb-3">ü§ñ OpenAI API</h3>
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-orange-700">text-embedding-ada-002</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Dimensions: 1536<br>
                            Prix: $0.10/1M tokens<br>
                            ‚úÖ Standard
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-orange-700">text-embedding-3-small</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Dimensions: 512-1536<br>
                            Prix: $0.02/1M tokens<br>
                            üí∞ √âconomique
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-orange-700">text-embedding-3-large</div>
                        <div class="text-xs text-gray-600 mt-1">
                            Dimensions: 256-3072<br>
                            Prix: $0.13/1M tokens<br>
                            üéØ Pr√©cision max
                        </div>
                    </div>
                </div>
            </div>

            <!-- Arrow Down -->
            <div class="text-center text-3xl text-gray-400 my-4">‚Üì</div>

            <!-- Storage (Future) -->
            <div class="p-4 bg-gray-50 rounded-lg border-2 border-gray-300 opacity-60">
                <h3 class="text-xl font-bold text-gray-700 mb-3">üíæ Stockage (Futur)</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-gray-700">Table: email_embeddings</div>
                        <div class="text-xs text-gray-600 mt-1">
                            ‚Ä¢ id: INTEGER<br>
                            ‚Ä¢ email_id: INTEGER<br>
                            ‚Ä¢ embedding_vector: TEXT (JSON)<br>
                            ‚Ä¢ model: VARCHAR(50)<br>
                            ‚Ä¢ created_at: TIMESTAMP
                        </div>
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <div class="font-semibold text-gray-700">Cache Redis (Optionnel)</div>
                        <div class="text-xs text-gray-600 mt-1">
                            ‚Ä¢ Cl√©: hash(text + model)<br>
                            ‚Ä¢ Valeur: embedding vector<br>
                            ‚Ä¢ TTL: 30 jours<br>
                            ‚Ä¢ √âconomie: 95% des appels API
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Use Cases -->
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-700">üéØ Cas d'Usage</h2>
                <ul class="space-y-3">
                    <li class="flex items-start">
                        <span class="text-2xl mr-3">üîç</span>
                        <div>
                            <div class="font-semibold text-gray-800">Recherche S√©mantique</div>
                            <div class="text-sm text-gray-600">Trouver emails par sens, pas par mots-cl√©s</div>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-3">üìä</span>
                        <div>
                            <div class="font-semibold text-gray-800">Classification Auto</div>
                            <div class="text-sm text-gray-600">Cat√©goriser les messages entrants</div>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-3">üîÑ</span>
                        <div>
                            <div class="font-semibold text-gray-800">D√©tection Doublons</div>
                            <div class="text-sm text-gray-600">Identifier messages similaires (>95%)</div>
                        </div>
                    </li>
                    <li class="flex items-start">
                        <span class="text-2xl mr-3">üí°</span>
                        <div>
                            <div class="font-semibold text-gray-800">Suggestions R√©ponses</div>
                            <div class="text-sm text-gray-600">Proposer r√©ponses-type pertinentes</div>
                        </div>
                    </li>
                </ul>
            </div>

            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-700">üìà M√©triques & Tests</h2>
                <div class="space-y-4">
                    <div class="bg-green-50 p-4 rounded-lg">
                        <div class="text-sm text-gray-600 mb-1">Tests R√©ussis</div>
                        <div class="text-3xl font-bold text-green-600">100%</div>
                        <div class="text-xs text-gray-500">4/4 tests pass√©s</div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <div class="text-sm text-gray-600 mb-1">Temps de R√©ponse Moyen</div>
                        <div class="text-3xl font-bold text-blue-600">~200ms</div>
                        <div class="text-xs text-gray-500">Par embedding</div>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg">
                        <div class="text-sm text-gray-600 mb-1">Pr√©cision Similarit√©</div>
                        <div class="text-3xl font-bold text-purple-600">90.74%</div>
                        <div class="text-xs text-gray-500">Textes similaires</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Results -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">‚úÖ R√©sultats des Tests</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="px-4 py-2 text-left">Test</th>
                            <th class="px-4 py-2 text-left">R√©sultat</th>
                            <th class="px-4 py-2 text-left">D√©tails</th>
                            <th class="px-4 py-2 text-right">Tokens</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b">
                            <td class="px-4 py-3 font-medium">Embedding Simple</td>
                            <td class="px-4 py-3"><span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">‚úÖ R√©ussi</span></td>
                            <td class="px-4 py-3 text-sm text-gray-600">1536 dimensions, ada-002</td>
                            <td class="px-4 py-3 text-right font-mono">14</td>
                        </tr>
                        <tr class="border-b">
                            <td class="px-4 py-3 font-medium">Batch Embeddings</td>
                            <td class="px-4 py-3"><span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">‚úÖ R√©ussi</span></td>
                            <td class="px-4 py-3 text-sm text-gray-600">4 textes trait√©s</td>
                            <td class="px-4 py-3 text-right font-mono">42</td>
                        </tr>
                        <tr class="border-b">
                            <td class="px-4 py-3 font-medium">Calcul Similarit√©</td>
                            <td class="px-4 py-3"><span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">‚úÖ R√©ussi</span></td>
                            <td class="px-4 py-3 text-sm text-gray-600">90.74% vs 81.48%</td>
                            <td class="px-4 py-3 text-right font-mono">14</td>
                        </tr>
                        <tr>
                            <td class="px-4 py-3 font-medium">Mod√®le v3-small</td>
                            <td class="px-4 py-3"><span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">‚úÖ R√©ussi</span></td>
                            <td class="px-4 py-3 text-sm text-gray-600">512 dimensions</td>
                            <td class="px-4 py-3 text-right font-mono">14</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="bg-gray-100 font-bold">
                            <td class="px-4 py-3">TOTAL</td>
                            <td class="px-4 py-3"></td>
                            <td class="px-4 py-3 text-sm">Co√ªt: ~$0.0001</td>
                            <td class="px-4 py-3 text-right font-mono">84</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <!-- Files Created -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">üì¶ Fichiers Cr√©√©s/Modifi√©s</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <h3 class="font-semibold text-green-700 mb-2">‚ú® Nouveaux Fichiers</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">test_embeddings.py</span>
                            <span class="text-gray-500">185 lignes</span>
                        </li>
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">semantic-search-demo.html</span>
                            <span class="text-gray-500">377 lignes</span>
                        </li>
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">EMBEDDINGS_GUIDE.md</span>
                            <span class="text-gray-500">580 lignes</span>
                        </li>
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">TEST_EMBEDDINGS.bat</span>
                            <span class="text-gray-500">55 lignes</span>
                        </li>
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">EMBEDDINGS_IMPLEMENTATION.md</span>
                            <span class="text-gray-500">R√©sum√©</span>
                        </li>
                        <li class="flex justify-between items-center bg-green-50 p-2 rounded">
                            <span class="font-mono">EMBEDDINGS_QUICKREF.md</span>
                            <span class="text-gray-500">R√©f√©rence</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-semibold text-blue-700 mb-2">üîß Fichiers Modifi√©s</h3>
                    <ul class="space-y-2 text-sm">
                        <li class="bg-blue-50 p-2 rounded">
                            <div class="font-mono">src/backend/app.py</div>
                            <div class="text-xs text-gray-600 mt-1">
                                + create_embedding()<br>
                                + batch_create_embeddings()<br>
                                + calculate_similarity()
                            </div>
                        </li>
                        <li class="bg-blue-50 p-2 rounded">
                            <div class="font-mono">src/api/routes.py</div>
                            <div class="text-xs text-gray-600 mt-1">
                                + POST /api/ai/embeddings<br>
                                + POST /api/ai/similarity
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-8 text-gray-600">
            <p class="text-sm">IAPosteManager v2.2.0 - OpenAI Embeddings Integration</p>
            <p class="text-xs mt-1">D√©velopp√© le 20 d√©cembre 2024</p>
        </div>
    </div>
</body>
</html>
