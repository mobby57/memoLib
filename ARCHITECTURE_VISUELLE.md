# ğŸ“Š ARCHITECTURE VISUELLE â€” memoLib

## Vue d'Ensemble SystÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          IAPOSTEMANAGER FULL STACK                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           EXTERNAL CHANNELS                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Email   â”‚ WhatsApp â”‚   SMS   â”‚  Slack  â”‚  Teams  â”‚  Forms  â”‚ Documents â”‚
â”‚ (Resend) â”‚ (Twilio) â”‚(Twilio) â”‚(Webhooks) â”‚(Webhooks) â”‚(Web) â”‚(Upload)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚          â”‚         â”‚         â”‚         â”‚        â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   WEBHOOK RECEIVER      â”‚
           â”‚  (Next.js API Routes)   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  MESSAGE QUEUE          â”‚
           â”‚  (Bull + Redis)         â”‚
           â”‚  Async Processing       â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚NORMALIZEâ”‚  â”‚CLASSIFY  â”‚  â”‚EXTRACT     â”‚
   â”‚(Format) â”‚  â”‚(Category)â”‚  â”‚(Entities)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  INDEXATION             â”‚
           â”‚  (Elasticsearch/Upstash)â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  WORKSPACE CREATED      â”‚
           â”‚  State: RECEIVED        â”‚
           â”‚  (Postgres)             â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚      WORKSPACE REASONING (7-STATES)         â”‚
           â”‚                                              â”‚
           â”‚  1ï¸âƒ£ RECEIVED                                 â”‚
           â”‚  2ï¸âƒ£ FACTS_EXTRACTED      (IA)               â”‚
           â”‚  3ï¸âƒ£ CONTEXT_IDENTIFIED   (IA)               â”‚
           â”‚  4ï¸âƒ£ OBLIGATIONS_DEDUCED  (IA)               â”‚
           â”‚  5ï¸âƒ£ MISSING_IDENTIFIED   (IA)               â”‚
           â”‚  6ï¸âƒ£ RISKS_EVALUATED      (IA)               â”‚
           â”‚  7ï¸âƒ£ ACTION_PROPOSED      (IA)               â”‚
           â”‚  âœ… READY_FOR_HUMAN      (Locked)           â”‚
           â”‚                                              â”‚
           â”‚  âš™ï¸ Human validation at each step           â”‚
           â”‚  ğŸ”’ Immutable audit trail                   â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚DASHBOARD â”‚ â”‚WORKSPACE â”‚ â”‚ACTIONS   â”‚
   â”‚(Stats)   â”‚ â”‚(Detail)  â”‚ â”‚(Follow-up)
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND LAYER (Next.js)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ React 19 + TailwindCSS + Shadcn/UI                                     â”‚
â”‚  â€¢ Multi-page app (dashboard, workspace, actions, reporting)              â”‚
â”‚  â€¢ RBAC (roles: LAWYER, ADMIN, CLERK, CLIENT)                             â”‚
â”‚  â€¢ Real-time updates (WebSocket SSE)                                      â”‚
â”‚  â€¢ Responsive (desktop + mobile)                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API (Next.js API Routes)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Webhooks (in)                                                          â”‚
â”‚  â€¢ Multi-channel services (email, whatsapp, sms, slack...)                â”‚
â”‚  â€¢ Queue processing (Bull)                                                â”‚
â”‚  â€¢ Workspace management (CRUD, state transitions)                         â”‚
â”‚  â€¢ Reasoning orchestration (Python async calls)                           â”‚
â”‚  â€¢ Notifications (WebSocket, email, SMS)                                  â”‚
â”‚  â€¢ Auth (NextAuth + JWT)                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI SERVICES (Python Microservices)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Reasoning engine (Ollama LLaMA 3.2 / GPT-4 fallback)                   â”‚
â”‚  â€¢ Text extraction & normalization                                        â”‚
â”‚  â€¢ Document parsing (PDF, DOCX, images)                                   â”‚
â”‚  â€¢ Entity extraction (dates, names, obligations)                          â”‚
â”‚  â€¢ Confidence scoring & uncertainty tracking                              â”‚
â”‚  â€¢ Learning loop (feedback integration)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATABASE LAYER (PostgreSQL)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Multi-tenant isolation (tenantId)                                      â”‚
â”‚  â€¢ Immutable audit trail (logs never deleted)                             â”‚
â”‚  â€¢ Message storage (normalized)                                           â”‚
â”‚  â€¢ Workspace + reasoning states                                           â”‚
â”‚  â€¢ Users, roles, permissions                                              â”‚
â”‚  â€¢ Encryption for sensitive fields (AES-256)                              â”‚
â”‚  â€¢ Backups (replicated, encrypted)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INFRASTRUCTURE & SECURITY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Frontend: Vercel (CDN + serverless)                                    â”‚
â”‚  â€¢ Backend: Azure Container Instances (auto-scale)                        â”‚
â”‚  â€¢ Database: PostgreSQL (Neon / Azure DB)                                 â”‚
â”‚  â€¢ Secrets: Azure Key Vault + GitHub Secrets                              â”‚
â”‚  â€¢ Cache: Redis Upstash (session + rate-limit)                            â”‚
â”‚  â€¢ WAF: Cloudflare (DDoS + IP filtering)                                  â”‚
â”‚  â€¢ Monitoring: Sentry (errors) + Datadog (logs)                           â”‚
â”‚  â€¢ SSL/TLS 1.3, CORS restrictive, CSP headers                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flux de DonnÃ©es (DÃ©tail)

### Message Entry Point

```
Message Source
    â†“
Webhook Route
    â†“
[Validate signature]
    â†“
[Normalize to standard format]
    â†“
[Queue job in Bull]
    â†“
ACK 200 to source (async process)
    â†“
[Async: Classification]
    â†“
[Async: Extraction]
    â†“
[Async: Workspace creation]
    â†“
[Notify lawyer via WebSocket]
    â†“
[Store in PostgreSQL]
```

### Reasoning Loop (7 States)

```
RECEIVED
    â†“ [Human review]
    â”œâ”€ OK â†’ Next
    â””â”€ REJECT
    â†“
FACTS_EXTRACTED
    â†“ [IA: extract certain facts from message]
    â”œâ”€ Validate confidence > 0.9
    â”œâ”€ Source horodatage
    â””â”€ Next state
    â†“
CONTEXT_IDENTIFIED
    â†“ [IA: identify legal framework]
    â”œâ”€ CESEDA? CEDH? Administrative?
    â”œâ”€ Temporal constraints?
    â””â”€ Human validates
    â†“
OBLIGATIONS_DEDUCED
    â†“ [IA: deduce legal obligations]
    â”œâ”€ Must-do vs. recommended
    â”œâ”€ Mandatory vs. optional
    â””â”€ Next state
    â†“
MISSING_IDENTIFIED
    â†“ [IA: identify gaps]
    â”œâ”€ Blocking? Non-blocking?
    â”œâ”€ How to resolve?
    â””â”€ Human approves plan
    â†“
RISKS_EVALUATED
    â†“ [IA: risk matrix]
    â”œâ”€ Probability Ã— Impact
    â”œâ”€ Mitigations
    â””â”€ Documentation
    â†“
ACTION_PROPOSED
    â†“ [IA: generate actions]
    â”œâ”€ Who? What? When?
    â”œâ”€ Priority level
    â””â”€ Tracking
    â†“
READY_FOR_HUMAN âœ…
    â†“ [Workspace locked]
    â””â”€ Lawyer can now decide
```

---

## Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PRODUCTION                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Vercel (CDN)   â”‚         â”‚  Azure App Service       â”‚    â”‚
â”‚  â”‚  â”œâ”€ Next.js      â”‚         â”‚  â”œâ”€ Node.js API         â”‚    â”‚
â”‚  â”‚  â”œâ”€ React SPA    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€ Webhooks            â”‚    â”‚
â”‚  â”‚  â””â”€ Static assetsâ”‚  HTTPS  â”‚  â””â”€ Async jobs          â”‚    â”‚
â”‚  â”‚                  â”‚         â”‚                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â”‚                            â–² API calls                         â”‚
â”‚                            â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚                                              â”‚              â”‚
â”‚  â–¼                                              â–¼              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚  PostgreSQL          â”‚         â”‚  Redis (Upstash)    â”‚     â”‚
â”‚ â”‚  (Neon / Azure DB)   â”‚         â”‚  â”œâ”€ Sessions        â”‚     â”‚
â”‚ â”‚  â”œâ”€ Workspaces      â”‚         â”‚  â”œâ”€ Rate-limit      â”‚     â”‚
â”‚ â”‚  â”œâ”€ Audit trail      â”‚         â”‚  â””â”€ Cache           â”‚     â”‚
â”‚ â”‚  â”œâ”€ Messages        â”‚         â”‚                      â”‚     â”‚
â”‚ â”‚  â””â”€ Users/Roles     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚ â”‚                     â”‚                                       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚         â–²                                                      â”‚
â”‚         â”‚ Python services (async)                             â”‚
â”‚         â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚  AI Services                â”‚                             â”‚
â”‚  â”‚  â”œâ”€ Ollama (LLaMA 3.2)       â”‚                             â”‚
â”‚  â”‚  â”œâ”€ OpenAI (fallback)        â”‚                             â”‚
â”‚  â”‚  â”œâ”€ Document parsing         â”‚                             â”‚
â”‚  â”‚  â””â”€ Reasoning engine         â”‚                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Cloudflare WAF                                  â”‚         â”‚
â”‚  â”‚  â”œâ”€ DDoS protection                              â”‚         â”‚
â”‚  â”‚  â”œâ”€ Rate-limiting                                â”‚         â”‚
â”‚  â”‚  â””â”€ IP filtering                                 â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Security

```
â”Œâ”€ EXTERNAL SOURCE
â”‚
â”œâ”€ [Validate signature/token]
â”‚
â”œâ”€ [Normalize (sanitize input)]
â”‚
â”œâ”€ [Store in queue (encrypted)]
â”‚
â”œâ”€ [Async processing (isolated)]
â”‚
â”œâ”€ [Classification & extraction]
â”‚
â”œâ”€ [Encrypt sensitive fields (AES-256)]
â”‚
â”œâ”€ [Store in PostgreSQL]
â”‚
â”œâ”€ [Log action (audit trail)]
â”‚
â””â”€ [Response to user (filtered)]

ğŸ”’ No unencrypted sensitive data in transit
ğŸ”’ No raw PII logged
ğŸ”’ All changes audit-trailed
```

---

## Tenant Isolation (Multi-tenancy)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Multi-Tenant Architecture              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Cabinet A (tenantId=abc123)                       â”‚
â”‚  â”œâ”€ Users (isolated)                               â”‚
â”‚  â”œâ”€ Workspaces (filtered by tenantId)             â”‚
â”‚  â”œâ”€ Messages (row-level security)                  â”‚
â”‚  â””â”€ Audit logs (tenant-scoped)                     â”‚
â”‚                                                     â”‚
â”‚  Cabinet B (tenantId=def456)                       â”‚
â”‚  â”œâ”€ Users (isolated)                               â”‚
â”‚  â”œâ”€ Workspaces (filtered by tenantId)             â”‚
â”‚  â”œâ”€ Messages (row-level security)                  â”‚
â”‚  â””â”€ Audit logs (tenant-scoped)                     â”‚
â”‚                                                     â”‚
â”‚  Cabinet C (tenantId=ghi789)                       â”‚
â”‚  â”œâ”€ Users (isolated)                               â”‚
â”‚  â”œâ”€ Workspaces (filtered by tenantId)             â”‚
â”‚  â”œâ”€ Messages (row-level security)                  â”‚
â”‚  â””â”€ Audit logs (tenant-scoped)                     â”‚
â”‚                                                     â”‚
â”‚  ğŸ”’ Database view filtering (RLS)                  â”‚
â”‚  ğŸ”’ API middleware tenantId check                  â”‚
â”‚  ğŸ”’ Frontend: no cross-tenant navigation           â”‚
â”‚  ğŸ”’ Audit logs prevent tampering                   â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Performance & Scalability

| Layer                  | Current | Target 2026 |
| ---------------------- | ------- | ----------- |
| **Frontend load**      | < 2s    | < 1s        |
| **API latency p95**    | < 1s    | < 500ms     |
| **Message processing** | < 5s    | < 2s        |
| **Reasoning latency**  | < 30s   | < 10s       |
| **Database queries**   | < 100ms | < 50ms      |
| **Concurrent users**   | 10      | 1000+       |

**Scaling strategies:**

- Frontend: Vercel auto-scaling (CDN, edge)
- Backend: Azure Container Instances (1-20 replicas)
- Database: Neon auto-scaling, connection pooling
- Queue: Bull with Redis cluster
- Cache: Upstash Redis (auto-scaling)

---

## Security Controls

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SECURITY ARCHITECTURE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  EXTERNAL LAYER                                    â”‚
â”‚  â”œâ”€ Cloudflare WAF (DDoS, IP blocking)            â”‚
â”‚  â”œâ”€ Certificate pinning (TLS 1.3)                 â”‚
â”‚  â””â”€ CORS (restrictive in prod)                    â”‚
â”‚                                                     â”‚
â”‚  AUTHENTICATION LAYER                              â”‚
â”‚  â”œâ”€ NextAuth (SSO + JWT)                          â”‚
â”‚  â”œâ”€ 2FA (TOTP + backup codes)                     â”‚
â”‚  â”œâ”€ Session timeout (1h)                          â”‚
â”‚  â””â”€ Token rotation (30d)                          â”‚
â”‚                                                     â”‚
â”‚  AUTHORIZATION LAYER                               â”‚
â”‚  â”œâ”€ RBAC (roles: LAWYER, ADMIN, CLERK, CLIENT)   â”‚
â”‚  â”œâ”€ Fine-grained (workspace-level access)         â”‚
â”‚  â”œâ”€ Row-level security (PostgreSQL RLS)           â”‚
â”‚  â””â”€ Tenant isolation (strict filtering)           â”‚
â”‚                                                     â”‚
â”‚  DATA LAYER                                        â”‚
â”‚  â”œâ”€ AES-256 encryption (sensitive fields)         â”‚
â”‚  â”œâ”€ Field-level encryption (PII)                  â”‚
â”‚  â”œâ”€ TLS 1.3 in transit                            â”‚
â”‚  â””â”€ Encrypted backups                             â”‚
â”‚                                                     â”‚
â”‚  AUDIT LAYER                                       â”‚
â”‚  â”œâ”€ Immutable audit trail (never deleted)         â”‚
â”‚  â”œâ”€ Signature verification (edits)                â”‚
â”‚  â”œâ”€ Timestamp validation (horodatage)             â”‚
â”‚  â””â”€ Export audit logs on demand                   â”‚
â”‚                                                     â”‚
â”‚  MONITORING                                        â”‚
â”‚  â”œâ”€ Sentry (error tracking)                       â”‚
â”‚  â”œâ”€ Datadog (security logs)                       â”‚
â”‚  â”œâ”€ Alert rules (anomalies)                       â”‚
â”‚  â””â”€ Regular pen-tests (annual)                    â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**SchÃ©ma d'architecture â€” memoLib**
**Statut : OFFICIEL**
**DerniÃ¨re mise Ã  jour : 27 janvier 2026**
