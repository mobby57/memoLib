<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Vocal - SecureVault</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/navigation.css">
</head>
<body>
    <nav class="main-nav">
        <div class="nav-brand">
            <svg width="32" height="32" viewBox="0 0 40 40">
                <circle cx="20" cy="20" r="18" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M20 10 L20 20 L28 20" stroke="currentColor" stroke-width="2" fill="none"/>
            </svg>
            <span>SecureVault</span>
        </div>
        <div class="nav-links">
            <a href="/" class="nav-link">üè† Accueil</a>
            <a href="/composer" class="nav-link">‚ú® Composer</a>
            <a href="/agent" class="nav-link active">üé§ Agent IA</a>
        </div>
        <button class="theme-toggle" id="themeToggle">üåô</button>
    </nav>

    <div class="container" style="max-width: 1000px; margin: 2rem auto;">
        <header style="text-align: center; margin-bottom: 2rem;">
            <h1>ü§ñ Assistant Intelligent</h1>
            <p style="color: #666;">Commandes rapides et raccourcis</p>
        </header>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
            
            <div class="action-card" onclick="location.href='/composer'">
                <div class="action-icon">‚ú®</div>
                <h3>Composer Email IA</h3>
                <p>G√©n√©ration intelligente d'emails</p>
                <div class="action-shortcut">Ctrl + N</div>
            </div>

            <div class="action-card" onclick="quickSend()">
                <div class="action-icon">üìß</div>
                <h3>Envoi Rapide</h3>
                <p>Envoyer un email simple</p>
                <div class="action-shortcut">Ctrl + E</div>
            </div>

            <div class="action-card" onclick="location.href='/history'">
                <div class="action-icon">üìä</div>
                <h3>Historique</h3>
                <p>Voir les emails envoy√©s</p>
                <div class="action-shortcut">Ctrl + H</div>
            </div>

            <div class="action-card" onclick="location.href='/templates'">
                <div class="action-icon">üìã</div>
                <h3>Templates</h3>
                <p>Mod√®les d'emails</p>
                <div class="action-shortcut">Ctrl + T</div>
            </div>

            <div class="action-card" onclick="quickGenerate()">
                <div class="action-icon">ü§ñ</div>
                <h3>G√©n√©ration Express</h3>
                <p>G√©n√©rer rapidement</p>
                <div class="action-shortcut">Ctrl + G</div>
            </div>

            <div class="action-card" onclick="location.href='/'">
                <div class="action-icon">‚öôÔ∏è</div>
                <h3>Configuration</h3>
                <p>Gmail, OpenAI, Param√®tres</p>
                <div class="action-shortcut">Ctrl + ,</div>
            </div>

        </div>

        <div class="card" style="margin-top: 2rem;">
            <h2>‚ö° Actions Rapides</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <button onclick="testEmail()" class="btn btn-primary">üìß Test Email</button>
                <button onclick="checkStatus()" class="btn btn-secondary">üîç V√©rifier Status</button>
                <button onclick="clearCache()" class="btn btn-info">üóëÔ∏è Vider Cache</button>
                <button onclick="exportData()" class="btn btn-success">üíæ Export Donn√©es</button>
            </div>
        </div>

        <div class="card">
            <h2>‚å®Ô∏è Raccourcis Clavier</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                <div><kbd>Ctrl + N</kbd> Nouveau email</div>
                <div><kbd>Ctrl + E</kbd> Envoi rapide</div>
                <div><kbd>Ctrl + H</kbd> Historique</div>
                <div><kbd>Ctrl + T</kbd> Templates</div>
                <div><kbd>Ctrl + G</kbd> G√©n√©rer IA</div>
                <div><kbd>Ctrl + ,</kbd> Configuration</div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script src="/static/js/navigation.js"></script>
    <script>
        // Raccourcis clavier
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 'n': e.preventDefault(); location.href = '/composer'; break;
                    case 'e': e.preventDefault(); quickSend(); break;
                    case 'h': e.preventDefault(); location.href = '/history'; break;
                    case 't': e.preventDefault(); location.href = '/templates'; break;
                    case 'g': e.preventDefault(); quickGenerate(); break;
                    case ',': e.preventDefault(); location.href = '/'; break;
                }
            }
        });

        function quickSend() {
            const recipient = prompt('üìß Destinataire:');
            if (!recipient) return;
            const subject = prompt('üìù Objet:');
            if (!subject) return;
            const body = prompt('‚úçÔ∏è Message:');
            if (!body) return;
            
            fetch('/api/send-email', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({recipient, subject, body})
            })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ Email envoy√©!');
                    location.href = '/history';
                } else {
                    alert('‚ùå ' + data.error);
                }
            })
            .catch(e => alert('‚ùå Erreur: ' + e.message));
        }

        function quickGenerate() {
            const context = prompt('ü§ñ Contexte pour g√©n√©ration IA:');
            if (!context) return;
            
            fetch('/api/generate-content', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({context, tone: 'professionnel', emailType: 'demande'})
            })
            .then(r => r.json())
            .then(data => {
                if (data.success) {
                    alert('‚úÖ G√©n√©r√©!\n\nObjet: ' + data.subject + '\n\n' + data.body.substring(0, 200) + '...');
                    location.href = '/composer';
                } else {
                    alert('‚ùå ' + data.error);
                }
            })
            .catch(e => alert('‚ùå Erreur: ' + e.message));
        }

        function testEmail() {
            alert('üìß Fonction de test email\nRedirection vers envoi...');
            location.href = '/send';
        }

        function checkStatus() {
            fetch('/api/health')
                .then(r => r.json())
                .then(data => alert('‚úÖ Status: ' + data.status + '\nüì¶ Version: ' + data.version))
                .catch(() => alert('‚ùå Erreur de connexion'));
        }

        function clearCache() {
            if (confirm('Vider le cache?')) {
                localStorage.clear();
                sessionStorage.clear();
                alert('‚úÖ Cache vid√©!');
            }
        }

        function exportData() {
            alert('üíæ Export des donn√©es...\nFonctionnalit√© en d√©veloppement');
        }
    </script>

    <style>
        .action-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .action-card:hover {
            border-color: #667eea;
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.2);
        }
        .action-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        .action-card h3 {
            margin: 0 0 0.5rem 0;
            color: #333;
        }
        .action-card p {
            color: #666;
            font-size: 0.9rem;
            margin: 0 0 1rem 0;
        }
        .action-shortcut {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: #f0f0f0;
            border-radius: 8px;
            font-size: 0.85rem;
            color: #666;
            font-family: monospace;
        }
        kbd {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
        }
        body.dark-mode .action-card {
            background: #2d2d2d;
            border-color: #444;
        }
        body.dark-mode .action-card h3 {
            color: #fff;
        }
        body.dark-mode .action-card p {
            color: #aaa;
        }
        body.dark-mode .action-shortcut {
            background: #444;
            color: #aaa;
        }
        body.dark-mode kbd {
            background: #444;
            border-color: #555;
            color: #fff;
        }
    </style>
</body>
</html>
