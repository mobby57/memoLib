# ===========================================
# OWASP ZAP Security Exceptions
# ===========================================
# Policy: Option A (Strict) - All exceptions fully justified
# Date: 2026-01-22
# Reviewed by: Security Team
# Next review: 2026-04-22 (quarterly)
#
# Format: [Alert ID] [ACTION] ([Justification])
# Actions: IGNORE (suppress), WARN (log only)
# ===========================================

# Rule 10021: X-Content-Type-Options Header Missing
# Status: FALSE POSITIVE
# Justification: Header IS set via next.config.js line 75
# Code: 'X-Content-Type-Options': 'nosniff'
# Verification: Browser DevTools → Network → Response Headers
# Evidence: Header present in all production responses
# Risk: None - false positive due to ZAP scanning HTTP dev mode
10021 IGNORE

# Rule 10020: X-Frame-Options Header Not Set
# Status: FALSE POSITIVE
# Justification: Header IS set via next.config.js line 76
# Code: 'X-Frame-Options': 'DENY'
# Verification: Browser DevTools shows X-Frame-Options: DENY
# Evidence: Clickjacking protection active in production
# Risk: None - false positive due to ZAP scanning HTTP dev mode
10020 IGNORE

# Rule 10096: Timestamp Disclosure
# Status: NON-EXPLOITABLE
# Justification: Standard HTTP Date header per RFC 7231
# Evidence: No sensitive timestamp data beyond HTTP spec
# Risk: Informational only - not exploitable
# Decision: Accept as standard HTTP behavior
10096 IGNORE

# Rule 10011: Cookie Without Secure Flag
# Status: FALSE POSITIVE (Dev Mode Scan)
# Justification: Cookies ARE secure in production
# Code location: src/app/api/auth/[...nextauth]/route.ts lines 195-220
# Configuration:
#   - httpOnly: true (prevents XSS cookie theft)
#   - secure: process.env.NODE_ENV === 'production' (HTTPS enforced in prod)
#   - sameSite: 'strict' (prevents CSRF attacks)
#   - __Secure- prefix on sessionToken (enforces HTTPS)
#   - __Host- prefix on csrfToken (strictest policy)
# Evidence: ZAP scanned http://localhost:3000 (dev mode without HTTPS)
# Production verification: Cookies include Secure flag on HTTPS deployment
# Risk: None - false positive, secure in production environment
10011 IGNORE

# ===========================================
# REAL ISSUES (If Any Found)
# ===========================================
# Document any REAL security issues here with:
# - Fix timeline
# - Assigned to
# - Mitigation in place
# Example:
# 90022 WARN (SQL Injection - Fix scheduled for 2026-01-25, Input sanitization added)
# ===========================================
