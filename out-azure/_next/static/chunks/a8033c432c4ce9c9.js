(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,772919,e=>{"use strict";var s,t,r=((s={}).FAIBLE="faible",s.MOYEN="moyen",s.ELEVE="eleve",s.CRITIQUE="critique",s),l=((t={}).VERIFICATIONS="verifications",t.PIECES="pieces",t.ACTIONS="actions",t);e.s(["ChecklistCategory",()=>l,"PROCEDURE_COLORS",0,{OQTF:"#B91C1C",REFUS_TITRE:"#CA8A04",RETRAIT_TITRE:"#EA580C",ASILE:"#1E40AF",REGROUPEMENT_FAMILIAL:"#7C3AED",NATURALISATION:"#059669"},"PROCEDURE_LABELS",0,{OQTF:"OQTF (Obligation de Quitter le Territoire Francais)",REFUS_TITRE:"Refus de Titre de Sejour",RETRAIT_TITRE:"Retrait de Titre de Sejour",ASILE:"Demande d'Asile",REGROUPEMENT_FAMILIAL:"Regroupement Familial",NATURALISATION:"Naturalisation Francaise"},"URGENCY_COLORS",0,{faible:"#10B981",moyen:"#F59E0B",eleve:"#EA580C",critique:"#DC2626"},"UrgencyLevel",()=>r])},502166,e=>{"use strict";var s=e.i(843476),t=e.i(772919);function r({level:e,label:r,size:l="md"}){return(0,s.jsxs)("span",{className:`inline-flex items-center gap-1 font-semibold rounded-full ${{sm:"px-2 py-0.5 text-xs",md:"px-3 py-1 text-sm",lg:"px-4 py-2 text-base"}[l]}`,style:{backgroundColor:`${t.URGENCY_COLORS[e]}20`,color:t.URGENCY_COLORS[e],border:`1px solid ${t.URGENCY_COLORS[e]}`},children:[(0,s.jsx)("span",{children:(()=>{switch(e){case t.UrgencyLevel.CRITIQUE:case t.UrgencyLevel.ELEVE:case t.UrgencyLevel.MOYEN:case t.UrgencyLevel.FAIBLE:return"[emoji]"}})()}),(0,s.jsx)("span",{children:r||(()=>{switch(e){case t.UrgencyLevel.CRITIQUE:return"Critique";case t.UrgencyLevel.ELEVE:return"eleve";case t.UrgencyLevel.MOYEN:return"Moyen";case t.UrgencyLevel.FAIBLE:return"Faible"}})()})]})}e.s(["default",()=>r])},90206,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(522016),l=e.i(772919),a=e.i(502166);function i({workspace:e,onClick:t}){let i=l.PROCEDURE_COLORS[e.procedureType],n=l.PROCEDURE_LABELS[e.procedureType],c=(()=>{if(!e.deadlineDate)return null;let s=new Date,t=new Date(e.deadlineDate).getTime()-s.getTime();if(t<=0)return"Expire";let r=Math.floor(t/36e5),l=Math.floor(r/24);return l>0?`${l}j restants`:`${r}h restantes`})();return(0,s.jsxs)(r.default,{href:`/workspaces/${e.id}`,onClick:t,className:"block bg-white border border-gray-200 rounded-lg p-4 hover:shadow-lg hover:border-gray-300 transition-all duration-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("div",{className:"w-1 h-6 rounded-full",style:{backgroundColor:i}}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:e.title})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.client.firstName," ",e.client.lastName]})]}),(0,s.jsx)(a.default,{level:e.urgencyLevel,size:"sm"})]}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium rounded",style:{backgroundColor:`${i}15`,color:i},children:n})}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:e.description}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e._count?.checklist||0}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Checklist"})]}),(0,s.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e._count?.documents||0}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Documents"})]}),(0,s.jsxs)("div",{className:"text-center p-2 bg-gray-50 rounded",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e._count?.alerts||0}),(0,s.jsx)("div",{className:"text-xs text-gray-600",children:"Alertes"})]})]}),e.deadlineDate&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm",children:"ï¸"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:"echeance:"})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("div",{className:`text-sm font-semibold ${"Expire"===c||c?.includes("h")?"text-red-600":"text-gray-900"}`,children:c}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:new Date(e.deadlineDate).toLocaleDateString("fr-FR")})]})]}),(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100 flex items-center justify-between text-xs text-gray-500",children:[(0,s.jsxs)("span",{children:["Cree le ",new Date(e.createdAt).toLocaleDateString("fr-FR")]}),e.reference&&(0,s.jsx)("span",{className:"font-mono",children:e.reference})]})]})}function n(){let[e,l]=(0,t.useState)([]),[a,n]=(0,t.useState)(!0),[c,d]=(0,t.useState)({procedureType:"",urgencyLevel:"",status:""});(0,t.useEffect)(()=>{o()},[c]);let o=async()=>{n(!0);try{let e=new URLSearchParams;c.procedureType&&e.set("procedureType",c.procedureType),c.urgencyLevel&&e.set("urgencyLevel",c.urgencyLevel),c.status&&e.set("status",c.status);let s=await fetch(`/api/workspaces?${e.toString()}`);if(!s.ok)throw Error("Erreur lors du chargement");let t=await s.json();l(t)}catch(e){console.error("Error fetching workspaces:",e)}finally{n(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes Dossiers CESDA"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Gestion des procedures contentieuses des etrangers"})]}),(0,s.jsx)(r.default,{href:"/workspaces/new",className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"+ Nouveau Dossier"})]}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de procedure"}),(0,s.jsxs)("select",{value:c.procedureType,onChange:e=>d({...c,procedureType:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Tous"}),(0,s.jsx)("option",{value:"OQTF",children:"OQTF"}),(0,s.jsx)("option",{value:"ASILE",children:"Asile"}),(0,s.jsx)("option",{value:"REFUS_TITRE",children:"Refus de titre"}),(0,s.jsx)("option",{value:"RETRAIT_TITRE",children:"Retrait de titre"}),(0,s.jsx)("option",{value:"REGROUPEMENT_FAMILIAL",children:"Regroupement familial"}),(0,s.jsx)("option",{value:"NATURALISATION",children:"Naturalisation"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Niveau d'urgence"}),(0,s.jsxs)("select",{value:c.urgencyLevel,onChange:e=>d({...c,urgencyLevel:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Tous"}),(0,s.jsx)("option",{value:"CRITIQUE",children:"[emoji] Critique"}),(0,s.jsx)("option",{value:"ELEVE",children:"[emoji] eleve"}),(0,s.jsx)("option",{value:"MOYEN",children:"[emoji] Moyen"}),(0,s.jsx)("option",{value:"FAIBLE",children:"[emoji] Faible"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),(0,s.jsxs)("select",{value:c.status,onChange:e=>d({...c,status:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Tous"}),(0,s.jsx)("option",{value:"active",children:"Actif"}),(0,s.jsx)("option",{value:"pending",children:"En attente"}),(0,s.jsx)("option",{value:"closed",children:"Clos"}),(0,s.jsx)("option",{value:"archived",children:"Archive"})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total dossiers"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Critiques"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-red-600",children:e.filter(e=>"CRITIQUE"===e.urgencyLevel).length})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"eleve"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:e.filter(e=>"ELEVE"===e.urgencyLevel).length})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Actifs"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:e.filter(e=>"active"===e.status).length})]})]}),a?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"}),(0,s.jsx)("p",{className:"text-gray-600 mt-4",children:"Chargement des dossiers..."})]}):0===e.length?(0,s.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm",children:[(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"Aucun dossier trouve"}),(0,s.jsx)(r.default,{href:"/workspaces/new",className:"inline-block mt-4 text-blue-600 hover:text-blue-700 font-medium",children:"Creer votre premier dossier [Next]"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,s.jsx)(i,{workspace:e},e.id))})]})})}e.s(["default",()=>n,"dynamic",0,"force-dynamic"],90206)}]);