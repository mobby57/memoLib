(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16715,e=>{"use strict";let t=(0,e.i(475254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},320970,e=>{"use strict";var t=e.i(843476),a=e.i(522016);function s(){return(0,t.jsx)("nav",{className:"sticky top-0 z-50 bg-white shadow-md border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(a.default,{href:"/admin",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"ðŸ  Dashboard"}),(0,t.jsx)(a.default,{href:"/admin/clients",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"[emoji] Clients"}),(0,t.jsx)(a.default,{href:"/admin/dossiers",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"[emoji] Dossiers"}),(0,t.jsx)(a.default,{href:"/admin/documents",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"[emoji] Documents"}),(0,t.jsx)(a.default,{href:"/admin/messages",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"[emoji] Messages"}),(0,t.jsx)(a.default,{href:"/admin/email-monitoring",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"[emoji] Emails"}),(0,t.jsx)(a.default,{href:"/admin/parametres",className:"px-4 py-2 rounded-lg font-semibold text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-all",children:"ï¸ Parametres"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-full text-sm font-semibold",children:"ADMIN"}),(0,t.jsx)(a.default,{href:"/api/auth/signout",className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-semibold transition-colors",children:"Deconnexion"})]})]})})})}e.s(["default",()=>s])},524341,e=>{"use strict";var t=e.i(843476),a=e.i(271645),s=e.i(217255),r=e.i(618566),l=e.i(320970),i=e.i(263488),n=e.i(878894),d=e.i(687130),o=e.i(16715),c=e.i(761911),x=e.i(98919),h=e.i(503116);let m=(0,e.i(475254).default)("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function g(){let{data:e,status:g}=(0,s.useSession)(),u=(0,r.useRouter)(),[p,y]=(0,a.useState)([]),[b,j]=(0,a.useState)(null),[f,v]=(0,a.useState)(!0),[N,w]=(0,a.useState)({type:"",priority:""}),[k,C]=(0,a.useState)(null),[M,S]=(0,a.useState)(null);(0,a.useEffect)(()=>{"unauthenticated"===g?u.push("/auth/login"):e?.user?.role!=="ADMIN"&&u.push("/client")},[g,e,u]),(0,a.useEffect)(()=>{T()},[N]);let T=async()=>{try{v(!0);let e=new URLSearchParams;N.type&&e.append("type",N.type),N.priority&&e.append("priority",N.priority);let t=await fetch(`/api/admin/email-monitor?${e}`),a=await t.json();y(a.emails||[]),j(a.stats||null)}catch(e){console.error("Erreur:",e)}finally{v(!1)}},R=async(e,t)=>{try{await fetch("/api/admin/email-monitor",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailId:e,read:t})}),T()}catch(e){console.error("Erreur:",e)}},E=async e=>{try{S(e);let t=await fetch("/api/admin/create-dossier-from-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailId:e})}),a=await t.json();a.success?(alert(`[OK] Dossier cree avec succes!

Client: ${a.client.nom} ${a.client.prenom}
Type: ${a.clientInfo.typeDemande}
Dossier ID: ${a.dossier.id}`),T()):alert("[ERROR] Erreur lors de la creation du dossier")}catch(e){console.error("Erreur:",e),alert("[ERROR] Erreur serveur")}finally{S(null)}};return"loading"===g||f?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,t.jsx)(l.default,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Chargement..."})]})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,t.jsx)(l.default,{}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[(0,t.jsx)(i.Mail,{className:"h-8 w-8 text-blue-600"}),"Monitoring Email"]}),(0,t.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Surveillance en temps reel de votre boite mail professionnelle"})]}),b&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Emails"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-1",children:b.total})]}),(0,t.jsx)(i.Mail,{className:"h-12 w-12 text-blue-500 opacity-20"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Nouveaux Clients"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-green-600 mt-1",children:b.nouveauClient})]}),(0,t.jsx)(c.Users,{className:"h-12 w-12 text-green-500 opacity-20"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Urgents"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-red-600 mt-1",children:b.urgent})]}),(0,t.jsx)(n.AlertTriangle,{className:"h-12 w-12 text-red-500 opacity-20"})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Aujourd'hui"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-purple-600 mt-1",children:b.today})]}),(0,t.jsx)(h.Clock,{className:"h-12 w-12 text-purple-500 opacity-20"})]})})]}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,t.jsx)(d.Filter,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("select",{value:N.type,onChange:e=>w({...N,type:e.target.value}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"",children:"Tous les types"}),(0,t.jsx)("option",{value:"nouveau_client",children:"Nouveau Client"}),(0,t.jsx)("option",{value:"urgent",children:"Urgent"}),(0,t.jsx)("option",{value:"spam",children:"Spam"}),(0,t.jsx)("option",{value:"general",children:"General"})]}),(0,t.jsxs)("select",{value:N.priority,onChange:e=>w({...N,priority:e.target.value}),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"",children:"Toutes les priorites"}),(0,t.jsx)("option",{value:"urgent",children:"Urgent"}),(0,t.jsx)("option",{value:"high",children:"Haute"}),(0,t.jsx)("option",{value:"medium",children:"Moyenne"}),(0,t.jsx)("option",{value:"low",children:"Basse"})]}),(0,t.jsxs)("button",{onClick:T,className:"ml-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,t.jsx)(o.RefreshCw,{className:"h-4 w-4"}),"Actualiser"]})]})}),(0,t.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:(0,t.jsx)("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:0===p.length?(0,t.jsxs)("div",{className:"p-12 text-center",children:[(0,t.jsx)(i.Mail,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Aucun email trouve"})]}):p.map(e=>(0,t.jsxs)("div",{className:`p-6 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition ${!e.read?"bg-blue-50 dark:bg-blue-900/20":""}`,onClick:()=>C(e),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.from}),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"nouveau_client":return"text-blue-600 bg-blue-50";case"spam":return"text-red-600 bg-red-50";case"laposte":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}})(e.type)}`,children:e.type}),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"urgent":return"text-red-600 bg-red-50";case"high":return"text-orange-600 bg-orange-50";case"medium":return"text-yellow-600 bg-yellow-50";default:return"text-gray-600 bg-gray-50"}})(e.priority)}`,children:e.priority})]}),(0,t.jsx)("p",{className:"text-gray-900 dark:text-white font-medium mb-1",children:e.subject}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:e.snippet}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 dark:text-gray-500",children:[(0,t.jsx)("span",{children:new Date(e.date).toLocaleString("fr-FR")}),(0,t.jsxs)("span",{children:["Confiance: ",e.confidence,"%"]}),e.tags?.length>0&&(0,t.jsxs)("span",{children:["Tags: ",e.tags.join(", ")]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),E(e.id)},disabled:M===e.id,className:"p-2 hover:bg-green-100 dark:hover:bg-green-900 rounded-lg disabled:opacity-50",title:"Creer un dossier",children:M===e.id?(0,t.jsx)("div",{className:"animate-spin h-5 w-5 border-2 border-green-600 border-t-transparent rounded-full"}):(0,t.jsx)(m,{className:"h-5 w-5 text-green-600"})}),(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),R(e.id,!e.read)},className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg",title:e.read?"Marquer non lu":"Marquer lu",children:(0,t.jsx)(x.Shield,{className:`h-5 w-5 ${e.read?"text-gray-400":"text-blue-600"}`})})]})]}),e.action&&(0,t.jsx)("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["[emoji] ",(0,t.jsx)("strong",{children:"Action suggeree:"})," ",e.action]})})]},e.id))})})]})]})}e.s(["default",()=>g,"dynamic",0,"force-dynamic"],524341)}]);