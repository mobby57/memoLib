(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,309648,e=>{"use strict";var s=e.i(843476),r=e.i(217255),l=e.i(618566),t=e.i(271645),a=e.i(522016);function o(){let{data:e,status:o}=(0,r.useSession)(),n=(0,l.useRouter)(),[i,d]=(0,t.useState)(null),[c,u]=(0,t.useState)(!0),[m,b]=(0,t.useState)(!1),[x,p]=(0,t.useState)("infos"),[h,g]=(0,t.useState)(null),[f,y]=(0,t.useState)({currentPassword:"",newPassword:"",confirmPassword:""});(0,t.useEffect)(()=>{"unauthenticated"===o?n.push("/auth/login"):e?.user&&"CLIENT"!==e.user.role?n.push("/dashboard"):e?.user?.role==="CLIENT"&&j()},[e,o,n]);let j=async()=>{try{let e=await fetch("/api/client/profil");if(e.ok){let s=await e.json();d(s)}u(!1)}catch(e){console.error("Error fetching profile:",e),u(!1)}},N=e=>{let{name:s,value:r,type:l}=e.target;i&&d(t=>{if(!t)return t;if("checkbox"===l){let r=e.target.checked;return{...t,[s]:r}}return"number"===l?{...t,[s]:parseInt(r)||0}:{...t,[s]:r}})},v=async e=>{e.preventDefault(),b(!0),g(null);try{(await fetch("/api/client/profil",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?(g({type:"success",text:"Profil mis a jour avec succes !"}),setTimeout(()=>g(null),5e3)):g({type:"error",text:"Erreur lors de la mise a jour"})}catch(e){g({type:"error",text:"Erreur de connexion"})}finally{b(!1)}},w=async e=>{if(e.preventDefault(),f.newPassword!==f.confirmPassword)return void g({type:"error",text:"Les mots de passe ne correspondent pas"});if(f.newPassword.length<8)return void g({type:"error",text:"Le mot de passe doit contenir au moins 8 caracteres"});b(!0),g(null);try{let e=await fetch("/api/client/profil/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:f.currentPassword,newPassword:f.newPassword})});if(e.ok)g({type:"success",text:"Mot de passe modifie avec succes !"}),y({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>g(null),5e3);else{let s=await e.json();g({type:"error",text:s.error||"Erreur lors de la modification"})}}catch(e){g({type:"error",text:"Erreur de connexion"})}finally{b(!1)}};return c?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Chargement du profil..."})]})}):i?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-md border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-8 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(a.default,{href:"/client",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)("span",{className:"text-2xl",children:"[Back]"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Mon Profil"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Gerez vos informations personnelles"})]})]}),(0,s.jsxs)("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg",children:[i.firstName?.charAt(0),i.lastName?.charAt(0)]})]})})}),(0,s.jsxs)("main",{className:"max-w-5xl mx-auto px-8 py-8",children:[h&&(0,s.jsx)("div",{className:`p-4 rounded-lg mb-6 ${"success"===h.type?"bg-green-50 border-l-4 border-green-500":"bg-red-50 border-l-4 border-red-500"}`,children:(0,s.jsx)("p",{className:`font-semibold ${"success"===h.type?"text-green-800":"text-red-800"}`,children:h.text})}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg mb-8 overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex border-b border-gray-200",children:[(0,s.jsx)("button",{onClick:()=>p("infos"),className:`flex-1 px-6 py-4 font-semibold transition-colors ${"infos"===x?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"[emoji] Informations Personnelles"}),(0,s.jsx)("button",{onClick:()=>p("securite"),className:`flex-1 px-6 py-4 font-semibold transition-colors ${"securite"===x?"bg-blue-500 text-white":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"[emoji] Securite"})]}),"infos"===x&&(0,s.jsxs)("form",{onSubmit:v,className:"p-8",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 uppercase border-b pb-2",children:"Identite"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Prenom *"}),(0,s.jsx)("input",{type:"text",name:"firstName",value:i.firstName,onChange:N,required:!0,className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nom *"}),(0,s.jsx)("input",{type:"text",name:"lastName",value:i.lastName,onChange:N,required:!0,className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Date de naissance"}),(0,s.jsx)("input",{type:"date",name:"dateOfBirth",value:i.dateOfBirth||"",onChange:N,className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nationalite"}),(0,s.jsx)("input",{type:"text",name:"nationality",value:i.nationality||"",onChange:N,placeholder:"Ex: Francaise",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 uppercase border-b pb-2",children:"Contact"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email *"}),(0,s.jsx)("input",{type:"email",name:"email",value:i.email,onChange:N,required:!0,className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none bg-gray-50",disabled:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"L'email ne peut pas etre modifie"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Telephone"}),(0,s.jsx)("input",{type:"tel",name:"phone",value:i.phone||"",onChange:N,placeholder:"06 12 34 56 78",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Telephone secondaire"}),(0,s.jsx)("input",{type:"tel",name:"phoneSecondaire",value:i.phoneSecondaire||"",onChange:N,placeholder:"01 23 45 67 89",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 uppercase border-b pb-2",children:"Adresse"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Adresse"}),(0,s.jsx)("input",{type:"text",name:"address",value:i.address||"",onChange:N,placeholder:"123 rue de la Republique",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Code Postal"}),(0,s.jsx)("input",{type:"text",name:"codePostal",value:i.codePostal||"",onChange:N,placeholder:"75001",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Ville"}),(0,s.jsx)("input",{type:"text",name:"ville",value:i.ville||"",onChange:N,placeholder:"Paris",className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Pays"}),(0,s.jsxs)("select",{name:"pays",value:i.pays,onChange:N,className:"w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none",children:[(0,s.jsx)("option",{value:"France",children:"France"}),(0,s.jsx)("option",{value:"Belgique",children:"Belgique"}),(0,s.jsx)("option",{value:"Suisse",children:"Suisse"}),(0,s.jsx)("option",{value:"Autre",children:"Autre"})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 uppercase border-b pb-2",children:"Preferences"}),(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"accepteNotifications",name:"accepteNotifications",checked:i.accepteNotifications,onChange:N,className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,s.jsx)("label",{htmlFor:"accepteNotifications",className:"text-gray-700",children:"Recevoir les notifications par email"})]})})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-4 mt-8 pt-6 border-t border-gray-200",children:[(0,s.jsx)(a.default,{href:"/client",className:"px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition-colors",children:"Annuler"}),(0,s.jsx)("button",{type:"submit",disabled:m,className:"px-8 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-semibold transition-colors disabled:opacity-50",children:m?"Enregistrement...":"Enregistrer les modifications"})]})]}),"securite"===x&&(0,s.jsx)("form",{onSubmit:w,className:"p-8",children:(0,s.jsxs)("div",{className:"space-y-6 max-w-2xl",children:[(0,s.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded",children:(0,s.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,s.jsx)("strong",{children:"Conseil:"})," Choisissez un mot de passe d'au moins 8 caracteres, contenant des lettres majuscules, minuscules, des chiffres et des caracteres speciaux."]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Mot de passe actuel *"}),(0,s.jsx)("input",{type:"password",value:f.currentPassword,onChange:e=>y(s=>({...s,currentPassword:e.target.value})),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Nouveau mot de passe *"}),(0,s.jsx)("input",{type:"password",value:f.newPassword,onChange:e=>y(s=>({...s,newPassword:e.target.value})),required:!0,minLength:8,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirmer le nouveau mot de passe *"}),(0,s.jsx)("input",{type:"password",value:f.confirmPassword,onChange:e=>y(s=>({...s,confirmPassword:e.target.value})),required:!0,minLength:8,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-4 pt-6 border-t border-gray-200",children:[(0,s.jsx)("button",{type:"button",onClick:()=>y({currentPassword:"",newPassword:"",confirmPassword:""}),className:"px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-semibold transition-colors",children:"Annuler"}),(0,s.jsx)("button",{type:"submit",disabled:m,className:"px-8 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-semibold transition-colors disabled:opacity-50",children:m?"Modification...":"Modifier le mot de passe"})]})]})})]})]})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Profil non trouve"})})}e.s(["default",()=>o,"dynamic",0,"force-dynamic"])}]);