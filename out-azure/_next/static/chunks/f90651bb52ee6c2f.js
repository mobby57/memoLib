(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,833884,e=>{"use strict";var s=e.i(843476),t=e.i(271645);let r=(0,t.memo)(({size:e="md",color:t="blue",className:r=""})=>(0,s.jsxs)("div",{className:`inline-block ${r}`,role:"status","aria-label":"Chargement",children:[(0,s.jsxs)("svg",{className:`animate-spin ${{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[e]} ${{blue:"text-blue-600",gray:"text-gray-600",white:"text-white"}[t]} gpu-accelerated`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{className:"sr-only",children:"Chargement..."})]}));r.displayName="LoadingSpinner";var i=e.i(165918);let a=(0,t.memo)(t.default.forwardRef(({variant:e="primary",size:t="md",isLoading:a=!1,className:l="",children:n,disabled:o,...c},d)=>{let u="primary"===e?{backgroundColor:i.colors.button,color:"white"}:{};return(0,s.jsx)("button",{ref:d,className:`
          inline-flex items-center justify-center font-medium rounded-lg transition-all duration-150 ease-out focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed will-change-transform
          ${{primary:"text-white hover:scale-105",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500 hover:scale-105",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 hover:scale-105",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500 hover:scale-105"}[e]}
          ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]}
          ${l}
        `,style:u,disabled:o||a,...c,children:a?(0,s.jsxs)("span",{className:"flex items-center justify-center",children:[(0,s.jsx)(r,{size:"sm",color:"outline"===e?"gray":"white",className:"mr-2"}),"Chargement..."]}):n})}));a.displayName="Button",e.s(["Button",0,a],833884)},659544,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(975157);let i=t.forwardRef(({className:e,variant:t="default",size:i="default",...a},l)=>(0,s.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===t,"border border-input hover:bg-accent hover:text-accent-foreground":"outline"===t,"hover:bg-accent hover:text-accent-foreground":"ghost"===t,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===t},{"h-10 py-2 px-4":"default"===i,"h-9 px-3 rounded-md":"sm"===i,"h-11 px-8 rounded-md":"lg"===i},e),ref:l,...a}));i.displayName="Button",e.s(["Button",()=>i])},815518,e=>{"use strict";e.i(159354),e.s([])},716787,e=>{"use strict";e.i(339964),e.i(738171),e.i(447647),e.i(496640),e.i(473668),e.i(61418),e.i(659544),e.i(815518),e.i(888840),e.i(843476),e.i(964753),e.i(558700),e.s([],716787)},871689,e=>{"use strict";let s=(0,e.i(475254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],871689)},908406,e=>{"use strict";var s=e.i(271645);function t(){let[e,t]=(0,s.useState)([]);return{toast:(0,s.useCallback)(({title:e,description:s,variant:r="default"})=>{let i=Math.random().toString(36).substr(2,9),a={id:i,title:e,description:s,variant:r};return t(e=>[...e,a]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==i))},5e3),i},[]),dismiss:(0,s.useCallback)(e=>{t(s=>s.filter(s=>s.id!==e))},[]),toasts:e}}e.s(["useToast",()=>t])},356909,e=>{"use strict";let s=(0,e.i(475254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>s],356909)},457082,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(217255),i=e.i(618566),a=e.i(50270),l=e.i(653145),n=e.i(994814),o=e.i(178583),c=e.i(284614),d=e.i(63727),u=e.i(356909),m=e.i(871689),x=e.i(63209);e.i(716787);var h=e.i(339964),b=e.i(908406),g=e.i(833884);let p=a.z.object({clientId:a.z.string().min(1,"Client requis"),typeDossier:a.z.enum(["TITRE_SEJOUR","RECOURS_OQTF","NATURALISATION","REGROUPEMENT_FAMILIAL","ASILE","VISA","AUTRE"]),objetDemande:a.z.string().min(10,"Minimum 10 caracteres"),priorite:a.z.enum(["NORMALE","HAUTE","URGENTE","CRITIQUE"]),dateEcheance:a.z.string().optional(),statut:a.z.enum(["BROUILLON","EN_COURS","EN_ATTENTE","TERMINE","REJETE","ANNULE"]).optional(),notes:a.z.string().optional()}),f=[{value:"TITRE_SEJOUR",label:"Titre de Sejour"},{value:"RECOURS_OQTF",label:"Recours OQTF"},{value:"NATURALISATION",label:"Naturalisation"},{value:"REGROUPEMENT_FAMILIAL",label:"Regroupement Familial"},{value:"ASILE",label:"Demande d'Asile"},{value:"VISA",label:"Visa"},{value:"AUTRE",label:"Autre"}];function j(){let{data:e,status:a}=(0,r.useSession)(),j=(0,i.useRouter)(),{toast:y}=(0,b.useToast)(),[N,v]=(0,t.useState)([]),[E,w]=(0,t.useState)(!1),[T,R]=(0,t.useState)(!0),{register:A,handleSubmit:C,formState:{errors:S},watch:I}=(0,l.useForm)({resolver:(0,n.zodResolver)(p),defaultValues:{priorite:"NORMALE",statut:"EN_COURS"}});(0,t.useEffect)(()=>{"unauthenticated"===a?j.push("/auth/login"):e?.user?.role!=="AVOCAT"&&e?.user?.role!=="ADMIN"?j.push("/dashboard"):O()},[e,a]);let O=async()=>{try{R(!0);let e=await fetch("/api/admin/clients");if(!e.ok)throw Error("Erreur chargement clients");let s=await e.json();v(s.clients||[])}catch(e){y({variant:"destructive",title:"Erreur",description:"Impossible de charger la liste des clients"})}finally{R(!1)}},U=async e=>{try{w(!0);let s=await fetch("/api/admin/dossiers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){let e=await s.json();throw Error(e.error||"Erreur creation dossier")}let t=await s.json();y({variant:"success",title:"Dossier cree",description:`Dossier ${t.dossier.numeroDossier} cree avec succes`}),j.push("/admin/dossiers")}catch(e){y({variant:"destructive",title:"Erreur",description:e.message})}finally{w(!1)}},k=I("clientId"),z=N.find(e=>e.id===k);return T?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)(g.Button,{onClick:()=>j.back(),className:"mb-4 bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:[(0,s.jsx)(m.ArrowLeft,{size:20}),"Retour"]}),(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,s.jsx)(o.FileText,{className:"text-blue-600",size:32}),"Nouveau Dossier Client"]}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Creer un nouveau dossier pour un client existant"})]}),(0,s.jsxs)("form",{onSubmit:C(U),className:"space-y-6",children:[(0,s.jsxs)(h.Card,{className:"p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(c.User,{className:"text-blue-600",size:24}),"Client"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selectionner un client *"}),(0,s.jsxs)("select",{...A("clientId"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"-- Choisir un client --"}),N.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName," (",e.email,")"]},e.id))]}),S.clientId&&(0,s.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[(0,s.jsx)(x.AlertCircle,{size:14}),S.clientId.message]})]}),z&&(0,s.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Client selectionne:"}),(0,s.jsxs)("p",{className:"text-blue-700",children:[z.firstName," ",z.lastName," - ",z.email]})]})]})]}),(0,s.jsxs)(h.Card,{className:"p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(d.Briefcase,{className:"text-blue-600",size:24}),"Informations du Dossier"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de dossier *"}),(0,s.jsxs)("select",{...A("typeDossier"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"",children:"-- Choisir un type --"}),f.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))]}),S.typeDossier&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.typeDossier.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorite *"}),(0,s.jsxs)("select",{...A("priorite"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"NORMALE",children:"Normale"}),(0,s.jsx)("option",{value:"HAUTE",children:"Haute"}),(0,s.jsx)("option",{value:"URGENTE",children:"Urgente"}),(0,s.jsx)("option",{value:"CRITIQUE",children:"Critique"})]}),S.priorite&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.priorite.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut initial"}),(0,s.jsxs)("select",{...A("statut"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"BROUILLON",children:"Brouillon"}),(0,s.jsx)("option",{value:"EN_COURS",children:"En cours"}),(0,s.jsx)("option",{value:"EN_ATTENTE",children:"En attente"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'echeance"}),(0,s.jsx)("input",{type:"date",...A("dateEcheance"),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),S.dateEcheance&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.dateEcheance.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet de la demande *"}),(0,s.jsx)("textarea",{...A("objetDemande"),rows:3,placeholder:"Decrivez l'objet de la demande (minimum 10 caracteres)...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"}),S.objetDemande&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:S.objetDemande.message})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes internes (optionnel)"}),(0,s.jsx)("textarea",{...A("notes"),rows:4,placeholder:"Notes ou commentaires internes sur le dossier...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none"})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(g.Button,{type:"button",onClick:()=>j.back(),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white",children:"Annuler"}),(0,s.jsx)(g.Button,{type:"submit",disabled:E,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center gap-2",children:E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creation..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Save,{size:20}),"Creer le Dossier"]})})]})]})]})})}e.s(["default",()=>j,"dynamic",0,"force-dynamic"])}]);