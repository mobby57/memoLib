(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,659544,e=>{"use strict";var t=e.i(843476),a=e.i(271645),r=e.i(975157);let s=a.forwardRef(({className:e,variant:a="default",size:s="default",...n},i)=>(0,t.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===a,"border border-input hover:bg-accent hover:text-accent-foreground":"outline"===a,"hover:bg-accent hover:text-accent-foreground":"ghost"===a,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===a},{"h-10 py-2 px-4":"default"===s,"h-9 px-3 rounded-md":"sm"===s,"h-11 px-8 rounded-md":"lg"===s},e),ref:i,...n}));s.displayName="Button",e.s(["Button",()=>s])},815518,e=>{"use strict";e.i(159354),e.s([])},716787,e=>{"use strict";e.i(339964),e.i(738171),e.i(447647),e.i(496640),e.i(473668),e.i(61418),e.i(659544),e.i(815518),e.i(888840),e.i(843476),e.i(964753),e.i(558700),e.s([],716787)},440160,e=>{"use strict";let t=(0,e.i(475254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);e.s(["Download",()=>t],440160)},727612,e=>{"use strict";let t=(0,e.i(475254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],727612)},514764,e=>{"use strict";let t=(0,e.i(475254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],514764)},592930,657359,e=>{"use strict";let t=(0,e.i(475254).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["Edit2",()=>t],592930);var a=e.i(843476);function r({columns:e,data:t,onRowClick:r}){return(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,a.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,a.jsx)("tr",{children:e.map(e=>(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.header},String(e.accessor)))})}),(0,a.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:t.map(t=>(0,a.jsx)("tr",{onClick:()=>r?.(t),className:r?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800":"",children:e.map(e=>{let r=t[e.accessor];return(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:e.render?e.render(r,t):String(r)},String(e.accessor))})},t.id))})]}),0===t.length&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"Aucune donnee a afficher"})]})}e.s(["Table",()=>r],657359)},865378,e=>{"use strict";var t=e.i(843476),a=e.i(217255),r=e.i(271645),s=e.i(107233),n=e.i(555436),i=e.i(592930),d=e.i(727612),l=e.i(440160),o=e.i(514764),c=e.i(178583),u=e.i(599811),m=e.i(503116),x=e.i(269638);e.i(716787);var g=e.i(339964),h=e.i(738171),y=e.i(496640),b=e.i(558700),p=e.i(964753),v=e.i(61418),f=e.i(888840),j=e.i(657359),k=e.i(159354),T=e.i(653145),N=e.i(994814),w=e.i(50270);let C=w.z.object({numero:w.z.string().min(1,"Numero requis"),client:w.z.string().min(1,"Client requis"),dossier:w.z.string().optional(),montantHT:w.z.string().min(1,"Montant HT requis"),tauxTVA:w.z.string().min(1,"Taux TVA requis"),statut:w.z.enum(["brouillon","envoyee","payee","en_retard","annulee"]),dateEmission:w.z.string().min(1,"Date d'emission requise"),dateEcheance:w.z.string().min(1,"Date d'echeance requise"),datePaiement:w.z.string().optional()}),E=[{id:"1",numero:"FACT-2024-001",client:"SARL Martin",dossier:"DOS-2024-001",montantHT:1500,montantTTC:1800,statut:"payee",dateEmission:"2024-01-05",dateEcheance:"2024-02-05",datePaiement:"2024-01-28"},{id:"2",numero:"FACT-2024-002",client:"SAS TechCorp",dossier:"DOS-2024-002",montantHT:2200,montantTTC:2640,statut:"envoyee",dateEmission:"2024-01-10",dateEcheance:"2024-02-10"},{id:"3",numero:"FACT-2024-003",client:"EURL Dupont",montantHT:850,montantTTC:1020,statut:"brouillon",dateEmission:"2024-01-15",dateEcheance:"2024-02-15"},{id:"4",numero:"FACT-2024-004",client:"SCI Investissement",dossier:"DOS-2024-004",montantHT:3500,montantTTC:4200,statut:"en_retard",dateEmission:"2023-12-20",dateEcheance:"2024-01-20"},{id:"5",numero:"FACT-2023-125",client:"M. Bernard",dossier:"DOS-2023-125",montantHT:1200,montantTTC:1440,statut:"payee",dateEmission:"2023-12-01",dateEcheance:"2024-01-01",datePaiement:"2023-12-28"},{id:"6",numero:"FACT-2024-005",client:"SARL Dubois",montantHT:1800,montantTTC:2160,statut:"envoyee",dateEmission:"2024-01-12",dateEcheance:"2024-02-12"},{id:"7",numero:"FACT-2024-006",client:"Entreprise ABC",dossier:"DOS-2024-006",montantHT:2500,montantTTC:3e3,statut:"brouillon",dateEmission:"2024-01-18",dateEcheance:"2024-02-18"},{id:"8",numero:"FACT-2024-007",client:"Client XYZ",montantHT:950,montantTTC:1140,statut:"payee",dateEmission:"2024-01-08",dateEcheance:"2024-02-08",datePaiement:"2024-02-05"}],S={brouillon:"Brouillon",envoyee:"Envoyee",payee:"Payee",en_retard:"En retard",annulee:"Annulee"},A={brouillon:"default",envoyee:"info",payee:"success",en_retard:"danger",annulee:"warning"};function F(){let{data:e,status:w}=(0,a.useSession)(),[F,M]=(0,r.useState)(E),[H,P]=(0,r.useState)(""),[D,z]=(0,r.useState)("all"),[L,V]=(0,r.useState)(!1),[R,O]=(0,r.useState)(null),[$,B]=(0,r.useState)(1),{addToast:q}=(0,f.useToast)(),{register:_,handleSubmit:I,reset:U,watch:G,formState:{errors:K}}=(0,T.useForm)({resolver:(0,N.zodResolver)(C)}),X=G("montantHT"),Y=G("tauxTVA"),Z=(0,r.useMemo)(()=>F.filter(e=>{let t=e.numero.toLowerCase().includes(H.toLowerCase())||e.client.toLowerCase().includes(H.toLowerCase())||e.dossier?.toLowerCase().includes(H.toLowerCase()),a="all"===D||e.statut===D;return t&&a}),[F,H,D]),J=Math.ceil(Z.length/10),Q=(0,r.useMemo)(()=>{let e=($-1)*10;return Z.slice(e,e+10)},[Z,$]),W=(0,r.useMemo)(()=>{let e=F.reduce((e,t)=>e+t.montantTTC,0),t=F.filter(e=>"payee"===e.statut).reduce((e,t)=>e+t.montantTTC,0);return{total:e,montantPaye:t,montantEnAttente:F.filter(e=>"envoyee"===e.statut||"brouillon"===e.statut).reduce((e,t)=>e+t.montantTTC,0),enRetard:F.filter(e=>"en_retard"===e.statut).length}},[F]),ee=[{accessor:"numero",header:"Numero"},{accessor:"client",header:"Client"},{accessor:"dossier",header:"Dossier",render:e=>e||"-"},{accessor:"montantHT",header:"Montant HT",render:e=>`${e.toFixed(2)} €`},{accessor:"montantTTC",header:"Montant TTC",render:e=>`${e.toFixed(2)} €`},{accessor:"statut",header:"Statut",render:e=>(0,t.jsx)(y.Badge,{variant:A[e],children:S[e]})},{accessor:"dateEmission",header:"Date emission"},{accessor:"dateEcheance",header:"Date echeance"},{accessor:"id",header:"Actions",render:(e,a)=>(0,t.jsxs)("div",{className:"flex gap-2",children:["brouillon"===a.statut&&(0,t.jsx)("button",{onClick:()=>{"brouillon"===a.statut&&(M(e=>e.map(e=>e.id===a.id?{...e,statut:"envoyee"}:e)),q({variant:"success",title:"Facture envoyee",message:`La facture ${a.numero} a ete envoyee au client.`}))},className:"p-1 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",title:"Envoyer",children:(0,t.jsx)(o.Send,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>{O(a),U({numero:a.numero,client:a.client,dossier:a.dossier||"",montantHT:a.montantHT.toString(),tauxTVA:"20",statut:a.statut,dateEmission:a.dateEmission,dateEcheance:a.dateEcheance,datePaiement:a.datePaiement||""}),V(!0)},className:"p-1 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:"Modifier",children:(0,t.jsx)(i.Edit2,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>{var e;let t;return e=a.id,t=F.find(t=>t.id===e),void(window.confirm(`etes-vous sur de vouloir supprimer la facture ${t?.numero} ?`)&&(M(t=>t.filter(t=>t.id!==e)),q({variant:"info",title:"Facture supprimee",message:`La facture ${t?.numero} a ete supprimee.`})))},className:"p-1 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",title:"Supprimer",children:(0,t.jsx)(d.Trash2,{className:"w-4 h-4"})})]})}];return"loading"===w?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Chargement..."})}):(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsx)(p.Breadcrumb,{items:[{label:"Factures"}]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Gestion des factures"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Gerez vos factures et suivez les paiements"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>{q({variant:"info",title:"Export en cours",message:"Votre fichier CSV sera telecharge dans quelques instants."})},className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,t.jsx)(l.Download,{className:"w-4 h-4"}),"Exporter"]}),(0,t.jsxs)("button",{onClick:()=>{O(null),U({numero:"",client:"",dossier:"",montantHT:"",tauxTVA:"20",statut:"brouillon",dateEmission:new Date().toISOString().split("T")[0],dateEcheance:"",datePaiement:""}),V(!0)},className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,t.jsx)(s.Plus,{className:"w-4 h-4"}),"Nouvelle facture"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)(h.StatCard,{title:"CA Total",value:`${W.total.toFixed(2)} €`,icon:u.Euro,trend:{value:15,isPositive:!0}}),(0,t.jsx)(h.StatCard,{title:"Montant paye",value:`${W.montantPaye.toFixed(2)} €`,icon:x.CheckCircle}),(0,t.jsx)(h.StatCard,{title:"En attente",value:`${W.montantEnAttente.toFixed(2)} €`,icon:m.Clock}),(0,t.jsx)(h.StatCard,{title:"En retard",value:W.enRetard,icon:c.FileText})]}),W.enRetard>0&&(0,t.jsxs)(v.Alert,{variant:"warning",title:"Factures en retard",children:["Vous avez ",W.enRetard," facture(s) en retard de paiement. Pensez a relancer vos clients."]}),(0,t.jsxs)(g.Card,{children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(n.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,t.jsx)("input",{type:"text",placeholder:"Rechercher par numero, client ou dossier...",value:H,onChange:e=>P(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,t.jsxs)("select",{value:D,onChange:e=>z(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"all",children:"Tous les statuts"}),Object.entries(S).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))]})]}),(H||"all"!==D)&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-600 dark:text-gray-400",children:[Z.length," resultat(s) trouve(s)"]})]}),(0,t.jsxs)(g.Card,{children:[(0,t.jsx)(j.Table,{columns:ee,data:Q}),J>1&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(b.Pagination,{currentPage:$,totalPages:J,onPageChange:B,itemsPerPage:10,totalItems:Z.length})})]}),(0,t.jsx)(k.Modal,{isOpen:L,onClose:()=>V(!1),title:R?"Modifier la facture":"Creer une facture",children:(0,t.jsxs)("form",{onSubmit:I(e=>{let t=parseFloat(e.montantHT),a=t*(1+parseFloat(e.tauxTVA)/100);if(R)M(r=>r.map(r=>r.id===R.id?{...r,...e,montantHT:t,montantTTC:a}:r)),q({variant:"success",title:"Facture modifiee",message:`La facture ${e.numero} a ete modifiee avec succes.`});else{let r={id:Date.now().toString(),...e,montantHT:t,montantTTC:a};M(e=>[r,...e]),q({variant:"success",title:"Facture creee",message:`La facture ${e.numero} a ete creee avec succes.`})}V(!1)}),className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Numero *"}),(0,t.jsx)("input",{..._("numero"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),K.numero&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:K.numero.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Client *"}),(0,t.jsx)("input",{..._("client"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),K.client&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:K.client.message})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Dossier associe"}),(0,t.jsx)("input",{..._("dossier"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Montant HT *"}),(0,t.jsx)("input",{type:"number",step:"0.01",..._("montantHT"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),K.montantHT&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:K.montantHT.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"TVA (%)"}),(0,t.jsxs)("select",{..._("tauxTVA"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[(0,t.jsx)("option",{value:"0",children:"0%"}),(0,t.jsx)("option",{value:"5.5",children:"5.5%"}),(0,t.jsx)("option",{value:"10",children:"10%"}),(0,t.jsx)("option",{value:"20",children:"20%"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Montant TTC"}),(0,t.jsx)("input",{type:"text",value:`${(parseFloat(X||"0")*(1+parseFloat(Y||"20")/100)).toFixed(2)} €`,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Statut *"}),(0,t.jsx)("select",{..._("statut"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:Object.entries(S).map(([e,a])=>(0,t.jsx)("option",{value:e,children:a},e))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date emission *"}),(0,t.jsx)("input",{type:"date",..._("dateEmission"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),K.dateEmission&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:K.dateEmission.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date echeance *"}),(0,t.jsx)("input",{type:"date",..._("dateEcheance"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"}),K.dateEcheance&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",children:K.dateEcheance.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date paiement"}),(0,t.jsx)("input",{type:"date",..._("datePaiement"),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>V(!1),className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600",children:"Annuler"}),(0,t.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:R?"Modifier":"Creer"})]})]})})]})}e.s(["default",()=>F,"dynamic",0,"force-dynamic"])}]);