(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,739145,e=>{"use strict";var t=e.i(843476),s=e.i(271645);function a(){let[e,a]=(0,s.useState)([]),[r,i]=(0,s.useState)(!1),d=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?i(!0):"dragleave"===e.type&&i(!1)},n=async e=>{for(let t=0;t<e.length;t++)l(e[t])},l=async e=>{let t=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;a(s=>[...s,{id:t,filename:e.name,status:"uploading"}]);try{let s=new FormData;s.append("file",e),s.append("tenantId","demo-tenant-001"),s.append("uploadedBy","demo-user-001");let r=await fetch("/api/documents",{method:"POST",body:s}),i=await r.json();r.ok?(a(e=>e.map(e=>e.id===t?{...e,id:i.document.id,status:"processing"}:e)),o(i.document.id)):a(e=>e.map(e=>e.id===t?{...e,status:"error",error:i.error||"Erreur upload"}:e))}catch(e){console.error("Erreur upload:",e),a(e=>e.map(e=>e.id===t?{...e,status:"error",error:"Erreur reseau"}:e))}},o=(0,s.useCallback)(async e=>{let t=0,s=async()=>{t++;try{let r=await fetch(`/api/documents?id=${e}`),i=await r.json();i.document?.ocrProcessed?a(t=>t.map(t=>t.id===e?{...t,status:"completed",ocrText:i.document.ocrText,extractedData:i.document.extractedData?JSON.parse(i.document.extractedData):void 0}:t)):t<30?setTimeout(s,1e3):a(t=>t.map(t=>t.id===e?{...t,status:"completed",ocrText:"Traitement en cours..."}:t))}catch(e){console.error("Erreur verification OCR:",e)}};setTimeout(s,2e3)},[]);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"[emoji] Documents & OCR"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Importez vos documents pour extraction automatique du texte et des donnees"})]}),(0,t.jsxs)("div",{onDragEnter:d,onDragLeave:d,onDragOver:d,onDrop:e=>{e.preventDefault(),e.stopPropagation(),i(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&n(e.dataTransfer.files)},className:`border-2 border-dashed rounded-lg p-12 text-center transition-colors ${r?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"[emoji]"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-700 mb-2",children:"Glissez-deposez vos fichiers ici"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"ou cliquez pour selectionner"}),(0,t.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.tiff,.doc,.docx",onChange:e=>{e.target.files&&e.target.files[0]&&n(e.target.files)},className:"hidden",id:"file-upload"}),(0,t.jsx)("label",{htmlFor:"file-upload",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg cursor-pointer hover:bg-blue-700 transition-colors",children:"Selectionner des fichiers"}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-4",children:"Formats supportes: PDF, Images (PNG, JPG), Documents (DOC, DOCX)"})]}),e.length>0&&(0,t.jsxs)("div",{className:"mt-8",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Documents importes"}),(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>{var s;return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-2xl",children:e.filename.endsWith(".pdf")?"[emoji]":"[emoji]ï¸"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.filename}),(s=e.status,(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{uploading:"bg-blue-100 text-blue-800",processing:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",error:"bg-red-100 text-red-800"}[s]}`,children:{uploading:"[emoji] Upload...",processing:"[emoji] Analyse OCR...",completed:" Termine",error:" Erreur"}[s]}))]})]}),"processing"===e.status&&(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})]}),"error"===e.status&&(0,t.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg text-sm",children:e.error}),"completed"===e.status&&e.ocrText&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"[emoji] Texte extrait:"}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 max-h-40 overflow-y-auto text-sm font-mono",children:[e.ocrText.substring(0,1e3),e.ocrText.length>1e3&&"..."]})]}),e.extractedData&&Object.keys(e.extractedData).length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"[emoji] Donnees analysees:"}),(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-3",children:Object.entries(e.extractedData).map(([e,s])=>(0,t.jsxs)("div",{className:"flex gap-2 text-sm mb-1",children:[(0,t.jsxs)("span",{className:"font-medium text-gray-600",children:[e,":"]}),(0,t.jsx)("span",{className:"text-gray-800",children:"object"==typeof s?JSON.stringify(s):String(s)})]},e))})]})]})]},e.id)})})]}),(0,t.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"[emoji] Comment ca marche ?"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"[emoji]"}),(0,t.jsx)("p",{className:"font-medium",children:"1. Upload"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Importez vos documents (factures, contrats, pieces d'identite...)"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"[emoji]"}),(0,t.jsx)("p",{className:"font-medium",children:"2. Analyse OCR"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Le texte est automatiquement extrait par reconnaissance optique"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"[emoji]"}),(0,t.jsx)("p",{className:"font-medium",children:"3. IA"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"L'IA identifie les informations cles (dates, montants, noms...)"})]})]})]})]})}e.s(["default",()=>a,"dynamic",0,"force-dynamic"])}]);