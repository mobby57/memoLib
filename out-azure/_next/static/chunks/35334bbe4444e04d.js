(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,833884,e=>{"use strict";var s=e.i(843476),t=e.i(271645);let r=(0,t.memo)(({size:e="md",color:t="blue",className:r=""})=>(0,s.jsxs)("div",{className:`inline-block ${r}`,role:"status","aria-label":"Chargement",children:[(0,s.jsxs)("svg",{className:`animate-spin ${{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[e]} ${{blue:"text-blue-600",gray:"text-gray-600",white:"text-white"}[t]} gpu-accelerated`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{className:"sr-only",children:"Chargement..."})]}));r.displayName="LoadingSpinner";var a=e.i(165918);let i=(0,t.memo)(t.default.forwardRef(({variant:e="primary",size:t="md",isLoading:i=!1,className:l="",children:n,disabled:o,...c},d)=>{let u="primary"===e?{backgroundColor:a.colors.button,color:"white"}:{};return(0,s.jsx)("button",{ref:d,className:`
          inline-flex items-center justify-center font-medium rounded-lg transition-all duration-150 ease-out focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed will-change-transform
          ${{primary:"text-white hover:scale-105",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500 hover:scale-105",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 hover:scale-105",outline:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500 hover:scale-105"}[e]}
          ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]}
          ${l}
        `,style:u,disabled:o||i,...c,children:i?(0,s.jsxs)("span",{className:"flex items-center justify-center",children:[(0,s.jsx)(r,{size:"sm",color:"outline"===e?"gray":"white",className:"mr-2"}),"Chargement..."]}):n})}));i.displayName="Button",e.s(["Button",0,i],833884)},659544,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(975157);let a=t.forwardRef(({className:e,variant:t="default",size:a="default",...i},l)=>(0,s.jsx)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===t,"border border-input hover:bg-accent hover:text-accent-foreground":"outline"===t,"hover:bg-accent hover:text-accent-foreground":"ghost"===t,"bg-destructive text-destructive-foreground hover:bg-destructive/90":"destructive"===t},{"h-10 py-2 px-4":"default"===a,"h-9 px-3 rounded-md":"sm"===a,"h-11 px-8 rounded-md":"lg"===a},e),ref:l,...i}));a.displayName="Button",e.s(["Button",()=>a])},815518,e=>{"use strict";e.i(159354),e.s([])},716787,e=>{"use strict";e.i(339964),e.i(738171),e.i(447647),e.i(496640),e.i(473668),e.i(61418),e.i(659544),e.i(815518),e.i(888840),e.i(843476),e.i(964753),e.i(558700),e.s([],716787)},727612,e=>{"use strict";let s=(0,e.i(475254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],727612)},908406,e=>{"use strict";var s=e.i(271645);function t(){let[e,t]=(0,s.useState)([]);return{toast:(0,s.useCallback)(({title:e,description:s,variant:r="default"})=>{let a=Math.random().toString(36).substr(2,9),i={id:a,title:e,description:s,variant:r};return t(e=>[...e,i]),setTimeout(()=>{t(e=>e.filter(e=>e.id!==a))},5e3),a},[]),dismiss:(0,s.useCallback)(e=>{t(s=>s.filter(s=>s.id!==e))},[]),toasts:e}}e.s(["useToast",()=>t])},751975,e=>{"use strict";let s=(0,e.i(475254).default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);e.s(["Tag",()=>s],751975)},688511,e=>{"use strict";let s=(0,e.i(475254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>s],688511)},730996,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(217255),a=e.i(618566),i=e.i(178583),l=e.i(107233),n=e.i(555436),o=e.i(87316),c=e.i(503116),d=e.i(688511),u=e.i(727612),h=e.i(284614),m=e.i(751975);e.i(716787);var x=e.i(339964),g=e.i(496640),p=e.i(833884),v=e.i(908406);let f={BROUILLON:"gray",EN_COURS:"blue",EN_ATTENTE:"yellow",TERMINE:"green",REJETE:"red",ANNULE:"gray"},b={NORMALE:"gray",HAUTE:"yellow",URGENTE:"orange",CRITIQUE:"red"},y={TITRE_SEJOUR:"Titre de Sejour",RECOURS_OQTF:"Recours OQTF",NATURALISATION:"Naturalisation",REGROUPEMENT_FAMILIAL:"Regroupement Familial",ASILE:"Demande d'Asile",VISA:"Visa",AUTRE:"Autre"};function j(){let{data:e,status:j}=(0,r.useSession)(),N=(0,a.useRouter)(),{toast:E}=(0,v.useToast)(),[w,C]=(0,t.useState)([]),[T,L]=(0,t.useState)(!0),[A,R]=(0,t.useState)(""),[k,S]=(0,t.useState)("ALL"),[U,D]=(0,t.useState)("ALL"),[I,M]=(0,t.useState)("date");(0,t.useEffect)(()=>{"unauthenticated"===j?N.push("/auth/login"):e?.user?.role!=="AVOCAT"&&e?.user?.role!=="ADMIN"?N.push("/dashboard"):O()},[e,j]);let O=async()=>{try{L(!0);let e=await fetch("/api/admin/dossiers");if(!e.ok)throw Error("Erreur chargement dossiers");let s=await e.json();C(s.dossiers||[])}catch(e){E({variant:"destructive",title:"Erreur",description:"Impossible de charger les dossiers"})}finally{L(!1)}},z=async e=>{if(confirm("Supprimer ce dossier ? Cette action est irreversible."))try{if(!(await fetch(`/api/admin/dossiers/${e}`,{method:"DELETE"})).ok)throw Error("Erreur suppression");E({variant:"success",title:"Dossier supprime",description:"Le dossier a ete supprime avec succes"}),O()}catch(e){E({variant:"destructive",title:"Erreur",description:"Impossible de supprimer le dossier"})}},B=w.filter(e=>{let s=e.numeroDossier.toLowerCase().includes(A.toLowerCase())||e.client.nom.toLowerCase().includes(A.toLowerCase())||e.client.prenom.toLowerCase().includes(A.toLowerCase())||e.objetDemande.toLowerCase().includes(A.toLowerCase()),t="ALL"===k||e.statut===k,r="ALL"===U||e.priorite===U;return s&&t&&r}).sort((e,s)=>{if("date"===I)return new Date(s.dateCreation).getTime()-new Date(e.dateCreation).getTime();if("echeance"===I)return e.dateEcheance?s.dateEcheance?new Date(e.dateEcheance).getTime()-new Date(s.dateEcheance).getTime():-1:1;{let t={CRITIQUE:4,URGENTE:3,HAUTE:2,NORMALE:1};return t[s.priorite]-t[e.priorite]}});return T?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,s.jsx)(i.FileText,{className:"text-blue-600",size:32}),"Gestion des Dossiers"]}),(0,s.jsxs)("p",{className:"text-gray-600 mt-2",children:[w.length," dossier",w.length>1?"s":""," au total"]})]}),(0,s.jsxs)(p.Button,{onClick:()=>N.push("/admin/dossiers/nouveau"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[(0,s.jsx)(l.Plus,{size:20}),"Nouveau Dossier"]})]}),(0,s.jsxs)(x.Card,{className:"p-6 mb-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)("div",{className:"md:col-span-2",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",value:A,onChange:e=>R(e.target.value),placeholder:"Rechercher par numero, client, objet...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"ALL",children:"Tous les statuts"}),(0,s.jsx)("option",{value:"BROUILLON",children:"Brouillon"}),(0,s.jsx)("option",{value:"EN_COURS",children:"En cours"}),(0,s.jsx)("option",{value:"EN_ATTENTE",children:"En attente"}),(0,s.jsx)("option",{value:"TERMINE",children:"Termine"}),(0,s.jsx)("option",{value:"REJETE",children:"Rejete"}),(0,s.jsx)("option",{value:"ANNULE",children:"Annule"})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("select",{value:U,onChange:e=>D(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"ALL",children:"Toutes priorites"}),(0,s.jsx)("option",{value:"CRITIQUE",children:"Critique"}),(0,s.jsx)("option",{value:"URGENTE",children:"Urgente"}),(0,s.jsx)("option",{value:"HAUTE",children:"Haute"}),(0,s.jsx)("option",{value:"NORMALE",children:"Normale"})]})})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>M("date"),className:`px-4 py-2 rounded-lg ${"date"===I?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Par date"}),(0,s.jsx)("button",{onClick:()=>M("echeance"),className:`px-4 py-2 rounded-lg ${"echeance"===I?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Par echeance"}),(0,s.jsx)("button",{onClick:()=>M("priorite"),className:`px-4 py-2 rounded-lg ${"priorite"===I?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Par priorite"})]})]}),0===B.length?(0,s.jsxs)(x.Card,{className:"p-12 text-center",children:[(0,s.jsx)(i.FileText,{className:"mx-auto text-gray-400 mb-4",size:48}),(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"Aucun dossier trouve"}),(0,s.jsx)("p",{className:"text-gray-400 mt-2",children:A||"ALL"!==k||"ALL"!==U?"Essayez de modifier vos filtres":"Creez votre premier dossier pour commencer"})]}):(0,s.jsx)("div",{className:"space-y-4",children:B.map(e=>(0,s.jsx)(x.Card,{className:"p-6 hover:shadow-lg transition-all cursor-pointer border-l-4 border-transparent hover:border-l-blue-600 hover:bg-blue-50/50",onClick:()=>N.push(`/admin/dossiers/${e.id}`),children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:e.numeroDossier}),(0,s.jsx)(g.Badge,{variant:f[e.statut],children:e.statut.replace("_"," ")}),(0,s.jsx)(g.Badge,{variant:b[e.priorite],children:e.priorite})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(h.User,{size:16}),(0,s.jsxs)("span",{children:[e.client.prenom," ",e.client.nom]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(m.Tag,{size:16}),(0,s.jsx)("span",{children:y[e.typeDossier]||e.typeDossier})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-600",children:[(0,s.jsx)(o.Calendar,{size:16}),(0,s.jsxs)("span",{children:["Cree le ",new Date(e.dateCreation).toLocaleDateString("fr-FR")]})]}),e.dateEcheance&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-orange-600",children:[(0,s.jsx)(c.Clock,{size:16}),(0,s.jsxs)("span",{children:["echeance: ",new Date(e.dateEcheance).toLocaleDateString("fr-FR")]})]})]}),(0,s.jsx)("p",{className:"text-gray-700 line-clamp-2",children:e.objetDemande}),(0,s.jsxs)("div",{className:"flex gap-4 mt-3 text-sm text-gray-500",children:[(0,s.jsxs)("span",{children:[e._count?.documents||0," document(s)"]}),(0,s.jsxs)("span",{children:[e._count?.echeances||0," echeance(s)"]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 ml-4",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)(p.Button,{onClick:()=>N.push(`/admin/dossiers/${e.id}/edit`),className:"bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:[(0,s.jsx)(d.Edit,{size:16}),"Modifier"]}),(0,s.jsxs)(p.Button,{onClick:()=>z(e.id),className:"bg-red-600 hover:bg-red-700 text-white flex items-center gap-2",children:[(0,s.jsx)(u.Trash2,{size:16}),"Supprimer"]})]})]})},e.id))})]})})}e.s(["default",()=>j,"dynamic",0,"force-dynamic"])}]);