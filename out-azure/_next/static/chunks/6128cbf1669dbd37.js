(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,417964,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(618566),r=e.i(263488),i=e.i(870273),l=e.i(475254);let n=(0,l.default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var d=e.i(643531),c=e.i(37727),x=e.i(82735);function o({emails:e,workspaceId:a,onRefresh:l}){let[o,m]=(0,t.useState)(null),[g,h]=(0,t.useState)("all"),[p,u]=(0,t.useState)(""),j=async(e,s)=>{try{await fetch(`/api/lawyer/workspaces/${e.split("-")[0]}/emails`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailId:e,action:s})}),l()}catch(e){console.error("Erreur action email:",e)}},y=e.filter(e=>{if("unread"===g&&e.isRead||"starred"===g&&!e.isStarred||"needsResponse"===g&&!e.needsResponse||"urgent"===g&&"critical"!==e.priority&&"high"!==e.priority)return!1;if(p){let s=p.toLowerCase();return e.from.toLowerCase().includes(s)||e.subject.toLowerCase().includes(s)||e.bodyText?.toLowerCase().includes(s)}return!0});return(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-6 h-[calc(100vh-400px)]",children:[(0,s.jsxs)("div",{className:"col-span-1 space-y-4",children:[(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)("input",{type:"text",placeholder:"Rechercher...",value:p,onChange:e=>u(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})}),(0,s.jsx)("div",{className:"flex space-x-2",children:[{id:"all",label:"Tous"},{id:"unread",label:"Non lus"},{id:"starred",label:"Favoris"},{id:"urgent",label:"Urgents"},{id:"needsResponse",label:"a repondre"}].map(e=>(0,s.jsx)("button",{onClick:()=>h(e.id),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${g===e.id?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.label},e.id))}),(0,s.jsxs)("div",{className:"space-y-2 overflow-y-auto max-h-[calc(100vh-500px)]",children:[y.map(e=>{var t;let a;return(0,s.jsxs)("div",{onClick:()=>m(e),className:`p-4 border rounded-lg cursor-pointer transition-all ${o?.id===e.id?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300 hover:shadow-sm"} ${!e.isRead?"bg-blue-50":"bg-white"}`,children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[!e.isRead&&(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0"}),(0,s.jsx)("span",{className:"font-medium text-gray-900 truncate text-sm",children:"inbound"===e.direction?e.from:`a: ${e.to}`})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[e.isStarred&&(0,s.jsx)(i.Star,{className:"w-4 h-4 text-yellow-500 fill-current"}),e.hasAttachments&&(0,s.jsx)(x.Paperclip,{className:"w-4 h-4 text-gray-400"})]})]}),(0,s.jsx)("p",{className:"font-medium text-gray-900 mb-1 text-sm line-clamp-1",children:e.subject}),e.aiSummary&&(0,s.jsxs)("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:["[emoji] ",e.aiSummary]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(t=e.priority,(a={critical:"bg-red-100 text-red-800",high:"bg-orange-100 text-orange-800",medium:"bg-blue-100 text-blue-800",low:"bg-gray-100 text-gray-800"})[t]||a.medium)}`,children:e.priority}),e.needsResponse&&(0,s.jsx)("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-800 rounded-full text-xs font-medium",children:"a repondre"})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.receivedDate).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},e.id)}),0===y.length&&(0,s.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,s.jsx)(r.Mail,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{children:"Aucun email trouve"})]})]})]}),(0,s.jsx)("div",{className:"col-span-2 border border-gray-200 rounded-lg bg-white overflow-hidden",children:o?(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:o.subject}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("p",{className:"text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"De:"})," ",o.from]}),(0,s.jsxs)("p",{className:"text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"a:"})," ",o.to]}),(0,s.jsxs)("p",{className:"text-gray-600",children:[(0,s.jsx)("span",{className:"font-medium",children:"Date:"})," ",new Date(o.receivedDate).toLocaleString("fr-FR")]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>j(o.id,o.isStarred?"unstar":"star"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:o.isStarred?"Retirer des favoris":"Ajouter aux favoris",children:(0,s.jsx)(i.Star,{className:`w-5 h-5 ${o.isStarred?"text-yellow-500 fill-current":"text-gray-400"}`})}),(0,s.jsx)("button",{onClick:()=>j(o.id,o.isArchived?"unarchive":"archive"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:o.isArchived?"Desarchiver":"Archiver",children:(0,s.jsx)(n,{className:"w-5 h-5 text-gray-600"})}),(0,s.jsx)("button",{onClick:()=>j(o.id,o.isRead?"mark_unread":"mark_read"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:o.isRead?"Marquer non lu":"Marquer lu",children:o.isRead?(0,s.jsx)(c.X,{className:"w-5 h-5 text-gray-600"}):(0,s.jsx)(d.Check,{className:"w-5 h-5 text-green-600"})})]})]}),o.aiProcessed&&(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 p-4 rounded-lg border border-purple-200",children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,s.jsx)("span",{className:"text-white text-sm font-bold",children:"IA"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 mb-1",children:"Analyse IA"}),o.aiSummary&&(0,s.jsxs)("p",{className:"text-sm text-gray-700 mb-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Resume:"})," ",o.aiSummary]}),o.aiClassified&&(0,s.jsxs)("p",{className:"text-sm text-gray-700 mb-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Classification:"})," ",(0,s.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:o.aiClassified}),o.aiConfidence&&(0,s.jsxs)("span",{className:"ml-2 text-xs text-gray-600",children:["(confiance: ",Math.round(100*o.aiConfidence),"%)"]})]}),o.aiActionNeeded&&(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,s.jsx)("span",{className:"font-medium",children:"Action suggeree:"})," ",o.aiActionNeeded]})]})]})})]}),(0,s.jsxs)("div",{className:"flex-1 p-6 overflow-y-auto",children:[(0,s.jsx)("div",{className:"prose max-w-none",children:(0,s.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-gray-700",children:o.bodyText||"Pas de contenu texte"})}),o.hasAttachments&&o.attachments&&(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,s.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[(0,s.jsx)(x.Paperclip,{className:"w-4 h-4 mr-2"}),"Pieces jointes"]}),(0,s.jsx)("div",{className:"space-y-2",children:JSON.parse(o.attachments).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gray-200 rounded flex items-center justify-center",children:(0,s.jsx)(x.Paperclip,{className:"w-5 h-5 text-gray-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.filename}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[(e.size/1024).toFixed(0)," KB"]})]})]}),(0,s.jsx)("button",{className:"px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700",children:"Telecharger"})]},t))})]})]}),(0,s.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Repondre"}),(0,s.jsx)("button",{className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Transferer"}),(0,s.jsx)("button",{className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Generer reponse IA"})]})})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full text-gray-500",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.Mail,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{children:"Selectionnez un email pour afficher son contenu"})]})})})]})}var m=e.i(178583),g=e.i(595468),h=e.i(503116),p=e.i(87316),u=e.i(107233);function j({procedures:e,onRefresh:t}){let a={critique:"bg-red-600 text-white border-red-600",eleve:"bg-orange-500 text-white border-orange-500",moyen:"bg-yellow-500 text-white border-yellow-500",faible:"bg-green-500 text-white border-green-500"},r={active:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",closed:"bg-gray-100 text-gray-800"},i={OQTF:"OQTF",REFUS_TITRE:"Refus Titre",RETRAIT_TITRE:"Retrait Titre",ASILE:"Asile Politique",REGROUPEMENT_FAMILIAL:"Regroupement Familial",NATURALISATION:"Naturalisation"};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Procedures Juridiques"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," procedure(s) au total"]})]}),(0,s.jsxs)("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,s.jsx)(u.Plus,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Nouvelle procedure"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{className:"px-3 py-1 bg-indigo-600 text-white rounded-lg text-sm font-medium",children:"Toutes"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"En cours"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"Urgentes"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"Terminees"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[e.map(e=>{var t;let l=(t=e.checklist)&&0!==t.length?Math.round(t.filter(e=>e.completed).length/t.length*100):0,n=(e=>{if(!e)return null;let s=new Date(e),t=new Date;return Math.ceil((s.getTime()-t.getTime())/864e5)})(e.deadlineDate),d=e.metadata?JSON.parse(e.metadata):{};return(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",children:[(0,s.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsx)("span",{className:`px-3 py-1 rounded-lg text-sm font-bold ${a[e.urgencyLevel]}`,children:i[e.procedureType]||e.procedureType}),(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r[e.status]}`,children:"active"===e.status?"En cours":"pending"===e.status?"En attente":"Termine"}),e.reference&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Ref: ",e.reference]})]}),(0,s.jsx)("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:e.title}),e.description&&(0,s.jsx)("p",{className:"text-gray-600",children:e.description})]}),null!==n&&(0,s.jsxs)("div",{className:`px-4 py-2 rounded-lg text-center ${n<0?"bg-red-100 text-red-800":n<7?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:Math.abs(n)}),(0,s.jsx)("div",{className:"text-xs",children:n<0?"jours depasses":"jours restants"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[e.notificationDate&&(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-1",children:"Notification"}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:new Date(e.notificationDate).toLocaleDateString("fr-FR")})]}),e.deadlineDate&&(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-1",children:"echeance"}),(0,s.jsxs)("p",{className:"font-medium text-gray-900 flex items-center",children:[(0,s.jsx)(p.Calendar,{className:"w-4 h-4 mr-1"}),new Date(e.deadlineDate).toLocaleDateString("fr-FR")]})]}),(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsx)("p",{className:"text-gray-500 mb-1",children:"Cree le"}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:new Date(e.createdAt).toLocaleDateString("fr-FR")})]})]}),Object.keys(d).length>0&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Details procedure"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[d.oqtfType&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Type OQTF:"})," ",(0,s.jsx)("span",{className:"font-medium text-gray-900",children:d.oqtfType})]}),d.juridiction&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Juridiction:"})," ",(0,s.jsx)("span",{className:"font-medium text-gray-900",children:d.juridiction})]}),d.motifAsile&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Motif:"})," ",(0,s.jsx)("span",{className:"font-medium text-gray-900",children:d.motifAsile})]}),d.articlesCeseda&&(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Articles CESEDA:"})," ",(0,s.jsx)("span",{className:"font-medium text-gray-900",children:d.articlesCeseda.join(", ")})]})]})]})]}),(0,s.jsxs)("div",{className:"p-6 bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h5",{className:"font-semibold text-gray-900 flex items-center",children:[(0,s.jsx)(g.CheckCircle2,{className:"w-4 h-4 mr-2"}),"Checklist (",e.checklist.filter(e=>e.completed).length,"/",e.checklist.length,")"]}),(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:[l,"% complete"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:(0,s.jsx)("div",{className:`h-2 rounded-full transition-all ${100===l?"bg-green-600":l>=50?"bg-blue-600":"bg-yellow-600"}`,style:{width:`${l}%`}})}),(0,s.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.checklist.map(e=>(0,s.jsxs)("label",{className:"flex items-start space-x-3 p-2 rounded hover:bg-white cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:e.completed,className:"mt-0.5 w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500",readOnly:!0}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:`text-sm ${e.completed?"line-through text-gray-500":"text-gray-900"}`,children:e.label}),e.description&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.description})]}),e.required&&(0,s.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:"Requis"})]},e.id))})]}),(0,s.jsxs)("div",{className:"p-4 bg-white border-t border-gray-200 flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(m.FileText,{className:"w-4 h-4 mr-1"}),e.documents.length," documents"]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(h.Clock,{className:"w-4 h-4 mr-1"}),e.echeances.length," echeances"]}),e.documentDrafts.length>0&&(0,s.jsxs)("span",{className:"flex items-center text-purple-600",children:[(0,s.jsx)(m.FileText,{className:"w-4 h-4 mr-1"}),e.documentDrafts.length," brouillons IA"]})]}),(0,s.jsx)("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm font-medium",children:"Voir details"})]})]},e.id)}),0===e.length&&(0,s.jsxs)("div",{className:"text-center py-12 text-gray-500 bg-white rounded-lg border border-gray-200",children:[(0,s.jsx)(m.FileText,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{className:"text-lg font-medium",children:"Aucune procedure"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:"Creez une nouvelle procedure pour commencer"}),(0,s.jsx)("button",{className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Nouvelle procedure"})]})]})]})}var y=e.i(284614),b=e.i(878894),f=e.i(686311);function N({events:e}){let t,a={created:i.Star,email_received:r.Mail,email_sent:r.Mail,procedure_created:m.FileText,procedure_updated:m.FileText,document_added:m.FileText,meeting_scheduled:p.Calendar,deadline_updated:h.Clock,alert_created:b.AlertTriangle,ai_suggestion:f.MessageSquare,status_changed:g.CheckCircle2,default:h.Clock},l={created:"bg-purple-100 text-purple-600",email_received:"bg-blue-100 text-blue-600",email_sent:"bg-green-100 text-green-600",procedure_created:"bg-indigo-100 text-indigo-600",procedure_updated:"bg-indigo-100 text-indigo-600",document_added:"bg-yellow-100 text-yellow-600",meeting_scheduled:"bg-orange-100 text-orange-600",deadline_updated:"bg-red-100 text-red-600",alert_created:"bg-red-100 text-red-600",ai_suggestion:"bg-purple-100 text-purple-600",status_changed:"bg-green-100 text-green-600",default:"bg-gray-100 text-gray-600"},n={user:"Utilisateur",ai:"IA Poste Manager",system:"Systeme"},d={user:y.User,ai:f.MessageSquare,system:h.Clock},c=(t={},e.forEach(e=>{let s=new Date(e.createdAt).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"});t[s]||(t[s]=[]),t[s].push(e)}),t),x=Object.keys(c).sort((e,s)=>new Date(s).getTime()-new Date(e).getTime());return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Timeline Complete"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," evenement(s) au total"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{className:"px-3 py-1 bg-indigo-600 text-white rounded-lg text-sm font-medium",children:"Tous"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"Emails"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"Procedures"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"Documents"}),(0,s.jsx)("button",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200",children:"IA"})]})]}),(0,s.jsxs)("div",{className:"relative",children:[x.map((e,t)=>(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-gray-50 py-2 mb-4",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 w-32",children:(0,s.jsx)("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-sm font-medium",children:e})}),(0,s.jsx)("div",{className:"flex-1 border-t border-gray-300"})]})}),(0,s.jsx)("div",{className:"space-y-4",children:c[e].map((t,r)=>{let i=a[t.eventType]||a.default,x=d[t.actorType],o=l[t.eventType]||l.default;return(0,s.jsxs)("div",{className:"relative pl-32",children:[r!==c[e].length-1&&(0,s.jsx)("div",{className:"absolute left-14 top-12 bottom-0 w-0.5 bg-gray-200"}),(0,s.jsx)("div",{className:"absolute left-0 top-0 w-28 text-right",children:(0,s.jsx)("span",{className:"text-sm text-gray-500",children:new Date(t.createdAt).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})}),(0,s.jsx)("div",{className:"absolute left-11 top-0",children:(0,s.jsx)("div",{className:`w-10 h-10 rounded-full ${o} flex items-center justify-center shadow-lg`,children:(0,s.jsx)(i,{className:"w-5 h-5"})})}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900",children:t.title}),t.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 bg-gray-100 rounded-full text-xs text-gray-700",children:[(0,s.jsx)(x,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:n[t.actorType]})]})]}),t.metadata&&(0,s.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:(0,s.jsxs)("details",{className:"text-xs text-gray-600",children:[(0,s.jsx)("summary",{className:"cursor-pointer hover:text-gray-900",children:"Voir details"}),(0,s.jsx)("pre",{className:"mt-2 p-2 bg-gray-50 rounded overflow-x-auto",children:JSON.stringify(JSON.parse(t.metadata),null,2)})]})}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Type: ",(0,s.jsx)("span",{className:"font-medium",children:t.eventType})]})})]})]},t.id)})})]},e)),0===e.length&&(0,s.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,s.jsx)(h.Clock,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{className:"text-lg font-medium",children:"Aucun evenement"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:"La timeline sera alimentee au fil des actions"})]})]}),e.length>0&&(0,s.jsx)("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg border border-gray-200",children:(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-indigo-600",children:e.filter(e=>e.eventType.includes("email")).length}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Emails"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.filter(e=>e.eventType.includes("procedure")).length}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Procedures"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>e.eventType.includes("document")).length}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Documents"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"ai"===e.actorType).length}),(0,s.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"Actions IA"})]})]})})]})}let v=(0,l.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),w=(0,l.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),k=(0,l.default)("file",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]]);var T=e.i(440160),C=e.i(286536),P=e.i(569074),S=e.i(687130),A=e.i(555436);function D({documents:e,workspaceId:a,onRefresh:r}){let[i,l]=(0,t.useState)("grid"),[x,o]=(0,t.useState)("all"),[g,h]=(0,t.useState)(""),[p,u]=(0,t.useState)(null),[j,y]=(0,t.useState)(!1),b=async e=>{if(a&&e.target.files?.[0]){y(!0);try{let s=e.target.files[0],t=new FormData;t.append("file",s),t.append("documentType","document_general"),t.append("category","correspondance");let i=await fetch(`/api/lawyer/workspaces/${a}/documents`,{method:"POST",body:t});if(i.ok)r(),e.target.value="";else{let e=await i.json();console.error("Erreur upload:",e),alert(e.error||"Erreur lors de l'upload")}}catch(e){console.error("Erreur upload:",e),alert("Erreur lors de l'upload")}finally{y(!1)}}},f=e=>e.startsWith("image/")?v:e.startsWith("video/")?w:e.includes("pdf")?m.FileText:k,N=e=>e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`,D={identite:"bg-blue-100 text-blue-800",juridique:"bg-purple-100 text-purple-800",financier:"bg-green-100 text-green-800",correspondance:"bg-yellow-100 text-yellow-800"},R=e.filter(e=>{if("verified"===x&&!e.verified||"unverified"===x&&e.verified||"ai_processed"===x&&!e.aiProcessed)return!1;if(g){let s=g.toLowerCase();return e.originalName.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s)||e.documentType.toLowerCase().includes(s)}return!0});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Documents"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," document(s) au total"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("label",{className:`px-4 py-2 ${j?"bg-gray-400":"bg-indigo-600 hover:bg-indigo-700"} text-white rounded-lg transition-colors flex items-center space-x-2 cursor-pointer`,children:[(0,s.jsx)(P.Upload,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:j?"Upload en cours...":"Uploader"}),(0,s.jsx)("input",{type:"file",className:"hidden",onChange:b,disabled:j,accept:".pdf,.jpg,.jpeg,.png,.webp,.doc,.docx"})]}),(0,s.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,s.jsx)("button",{onClick:()=>l("grid"),className:`px-3 py-1 rounded ${"grid"===i?"bg-white shadow":""}`,children:"Grille"}),(0,s.jsx)("button",{onClick:()=>l("list"),className:`px-3 py-1 rounded ${"list"===i?"bg-white shadow":""}`,children:"Liste"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(A.Search,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}),(0,s.jsx)("input",{type:"text",placeholder:"Rechercher par nom, type ou description...",value:g,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(S.Filter,{className:"w-4 h-4 text-gray-500"}),[{id:"all",label:"Tous"},{id:"verified",label:"Verifies"},{id:"unverified",label:"Non verifies"},{id:"ai_processed",label:"Traites IA"}].map(e=>(0,s.jsx)("button",{onClick:()=>o(e.id),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${x===e.id?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.label},e.id))]})]}),"grid"===i?(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4",children:R.map(e=>{let t=f(e.mimeType);return(0,s.jsxs)("div",{onClick:()=>u(e),className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-all cursor-pointer group",children:[(0,s.jsxs)("div",{className:"w-full h-32 bg-gray-100 rounded-lg mb-3 flex items-center justify-center relative overflow-hidden",children:[e.mimeType.startsWith("image/")?(0,s.jsx)("img",{src:`/api/documents/${e.id}/thumbnail`,alt:e.originalName,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling?.classList.remove("hidden")}}):null,(0,s.jsx)("div",{className:e.mimeType.startsWith("image/")?"hidden":"",children:(0,s.jsx)(t,{className:"w-16 h-16 text-gray-400"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,s.jsx)(C.Eye,{className:"w-8 h-8 text-white"})})]}),(0,s.jsx)("p",{className:"font-medium text-gray-900 text-sm truncate mb-1",title:e.originalName,children:e.originalName}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[(0,s.jsx)("span",{children:N(e.sizeBytes)}),(0,s.jsx)("span",{children:new Date(e.uploadedAt).toLocaleDateString("fr-FR")})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 flex-wrap gap-1",children:[e.category&&(0,s.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${D[e.category]||"bg-gray-100 text-gray-800"}`,children:e.category}),e.verified&&(0,s.jsxs)("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 rounded-full text-xs font-medium flex items-center",children:[(0,s.jsx)(d.Check,{className:"w-3 h-3 mr-1"}),"Verifie"]}),e.aiProcessed&&(0,s.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:"IA"})]})]},e.id)})}):(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nom"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Categorie"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Taille"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,s.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Statut"}),(0,s.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:R.map(e=>{let t=f(e.mimeType);return(0,s.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>u(e),children:[(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(t,{className:"w-6 h-6 text-gray-400 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.originalName}),e.description&&(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate max-w-xs",children:e.description})]})]})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:e.documentType}),(0,s.jsx)("td",{className:"px-4 py-3",children:e.category&&(0,s.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${D[e.category]||"bg-gray-100 text-gray-800"}`,children:e.category})}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:N(e.sizeBytes)}),(0,s.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(e.uploadedAt).toLocaleDateString("fr-FR")}),(0,s.jsx)("td",{className:"px-4 py-3",children:(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[e.verified&&(0,s.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium flex items-center",children:[(0,s.jsx)(d.Check,{className:"w-3 h-3 mr-1"}),"Verifie"]}),e.aiProcessed&&(0,s.jsx)("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs font-medium",children:"IA"})]})}),(0,s.jsx)("td",{className:"px-4 py-3 text-right",children:(0,s.jsx)("button",{onClick:e=>{e.stopPropagation()},className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Telecharger",children:(0,s.jsx)(T.Download,{className:"w-4 h-4 text-gray-600"})})})]},e.id)})})]})}),0===R.length&&(0,s.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-gray-200",children:[(0,s.jsx)(n,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucun document"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Uploadez des documents pour commencer"}),(0,s.jsxs)("button",{className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2 mx-auto",children:[(0,s.jsx)(P.Upload,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Uploader un document"})]})]}),p&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>u(null),children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:p.originalName}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:p.documentType})]}),(0,s.jsx)("button",{onClick:()=>u(null),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)(c.X,{className:"w-5 h-5 text-gray-600"})})]})}),(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Taille"}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:N(p.sizeBytes)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Uploade le"}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:new Date(p.uploadedAt).toLocaleString("fr-FR")})]}),p.category&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Categorie"}),(0,s.jsx)("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${D[p.category]||"bg-gray-100 text-gray-800"}`,children:p.category})]}),p.verified&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Verification"}),(0,s.jsxs)("p",{className:"font-medium text-green-600 flex items-center",children:[(0,s.jsx)(d.Check,{className:"w-4 h-4 mr-1"}),"Verifie le ",new Date(p.verifiedAt).toLocaleDateString("fr-FR")]})]})]}),p.aiProcessed&&p.aiExtractedData&&(0,s.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200 mb-6",children:[(0,s.jsxs)("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[(0,s.jsx)("span",{className:"w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center text-white text-xs font-bold mr-2",children:"IA"}),"Donnees extraites par l'IA"]}),(0,s.jsx)("pre",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:p.aiExtractedData}),p.aiConfidence&&(0,s.jsxs)("p",{className:"text-xs text-purple-600 mt-2",children:["Confiance: ",Math.round(100*p.aiConfidence),"%"]})]}),p.description&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),(0,s.jsx)("p",{className:"text-gray-700",children:p.description})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center space-x-2",children:[(0,s.jsx)(T.Download,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Telecharger"})]}),!p.verified&&(0,s.jsxs)("button",{className:"flex-1 px-4 py-2 border border-green-600 text-green-600 rounded-lg hover:bg-green-50 transition-colors flex items-center justify-center space-x-2",children:[(0,s.jsx)(d.Check,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Verifier"})]})]})]})]})})]})}let R=(0,l.default)("sticky-note",[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]]),E=(0,l.default)("pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]);var $=e.i(688511),F=e.i(727612),L=e.i(356909),M=e.i(751975),_=e.i(77705);function O({notes:e,workspaceId:a,onRefresh:r}){let[i,l]=(0,t.useState)(!1),[n,d]=(0,t.useState)(null),[x,o]=(0,t.useState)("all"),[m,g]=(0,t.useState)({title:"",content:"",isPrivate:!1,isPinned:!1,tags:""}),h=async()=>{if(a)try{let e=m.tags?m.tags.split(",").map(e=>e.trim()).filter(Boolean):[];(await fetch(`/api/lawyer/workspaces/${a}/notes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:m.title||void 0,content:m.content,isPrivate:m.isPrivate,isPinned:m.isPinned,tags:e})})).ok&&(l(!1),g({title:"",content:"",isPrivate:!1,isPinned:!1,tags:""}),r())}catch(e){console.error("Erreur creation note:",e)}},p=e=>{d(e),g({title:e.title||"",content:e.content,isPrivate:e.isPrivate,isPinned:e.isPinned,tags:e.tags||""})},j=async()=>{if(n&&a)try{let e=m.tags?m.tags.split(",").map(e=>e.trim()).filter(Boolean):[];(await fetch(`/api/lawyer/workspaces/${a}/notes/${n.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:m.title||void 0,content:m.content,isPrivate:m.isPrivate,isPinned:m.isPinned,tags:e})})).ok&&(d(null),g({title:"",content:"",isPrivate:!1,isPinned:!1,tags:""}),r())}catch(e){console.error("Erreur mise a jour note:",e)}},y=async e=>{if(a&&confirm("Supprimer cette note ?"))try{(await fetch(`/api/lawyer/workspaces/${a}/notes/${e}`,{method:"DELETE"})).ok&&r()}catch(e){console.error("Erreur suppression note:",e)}},b=async(e,s)=>{if(a)try{(await fetch(`/api/lawyer/workspaces/${a}/notes/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPinned:!s})})).ok&&r()}catch(e){console.error("Erreur toggle pin:",e)}},f=e.filter(e=>"pinned"===x?e.isPinned:"private"===x?e.isPrivate:"team"!==x||!e.isPrivate),N=f.filter(e=>e.isPinned),v=f.filter(e=>!e.isPinned);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notes & Annotations"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[e.length," note(s) au total"]})]}),(0,s.jsxs)("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,s.jsx)(u.Plus,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Nouvelle note"})]})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:[{id:"all",label:"Toutes"},{id:"pinned",label:"epinglees"},{id:"team",label:"equipe"},{id:"private",label:"Privees"}].map(e=>(0,s.jsx)("button",{onClick:()=>o(e.id),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${x===e.id?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.label},e.id))}),(i||n)&&(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-900 mb-4",children:n?"Modifier la note":"Nouvelle note"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre (optionnel)"}),(0,s.jsx)("input",{type:"text",value:m.title,onChange:e=>g({...m,title:e.target.value}),placeholder:"Titre de la note...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Contenu ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("textarea",{value:m.content,onChange:e=>g({...m,content:e.target.value}),placeholder:"ecrivez votre note ici...",rows:8,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 font-mono text-sm"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Markdown supporte : **gras**, *italique*, - liste, # titre"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (separes par des virgules)"}),(0,s.jsx)("input",{type:"text",value:m.tags,onChange:e=>g({...m,tags:e.target.value}),placeholder:"strategie, urgent, important",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:m.isPinned,onChange:e=>g({...m,isPinned:e.target.checked}),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"}),(0,s.jsxs)("span",{className:"text-sm text-gray-700 flex items-center",children:[(0,s.jsx)(E,{className:"w-4 h-4 mr-1"}),"epingler en haut"]})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:m.isPrivate,onChange:e=>g({...m,isPrivate:e.target.checked}),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"}),(0,s.jsxs)("span",{className:"text-sm text-gray-700 flex items-center",children:[(0,s.jsx)(_.EyeOff,{className:"w-4 h-4 mr-1"}),"Note privee (visible uniquement par moi)"]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)("button",{onClick:n?j:h,disabled:!m.content.trim(),className:"flex-1 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[(0,s.jsx)(L.Save,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:n?"Enregistrer":"Creer"})]}),(0,s.jsxs)("button",{onClick:()=>{l(!1),d(null),g({title:"",content:"",isPrivate:!1,isPinned:!1,tags:""})},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[(0,s.jsx)(c.X,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Annuler"})]})]})]})]}),N.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[(0,s.jsx)(E,{className:"w-4 h-4 mr-2 text-indigo-600"}),"epinglees"]}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:N.map(e=>(0,s.jsx)(I,{note:e,onEdit:p,onDelete:y,onTogglePin:b},e.id))})]}),v.length>0&&(0,s.jsxs)("div",{children:[N.length>0&&(0,s.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Autres notes"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-4",children:v.map(e=>(0,s.jsx)(I,{note:e,onEdit:p,onDelete:y,onTogglePin:b},e.id))})]}),0===f.length&&(0,s.jsxs)("div",{className:"text-center py-12 bg-white rounded-lg border border-gray-200",children:[(0,s.jsx)(R,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),(0,s.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune note"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Creez votre premiere note pour commencer"}),(0,s.jsx)("button",{onClick:()=>l(!0),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Nouvelle note"})]})]})}function I({note:e,onEdit:t,onDelete:a,onTogglePin:r}){let i=e.tags?JSON.parse(e.tags):[];return(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-all group",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,s.jsxs)("div",{className:"flex-1",children:[e.title&&(0,s.jsx)("h5",{className:"font-semibold text-gray-900 mb-1",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(0,s.jsx)("span",{children:e.authorName}),(0,s.jsx)("span",{children:"-"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString("fr-FR")})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)("button",{onClick:()=>r(e.id,e.isPinned),className:`p-1 rounded hover:bg-gray-100 transition-colors ${e.isPinned?"text-indigo-600":"text-gray-400"}`,title:e.isPinned?"Desepingler":"epingler",children:(0,s.jsx)(E,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>t(e),className:"p-1 rounded hover:bg-gray-100 transition-colors text-gray-400",title:"Modifier",children:(0,s.jsx)($.Edit,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>a(e.id),className:"p-1 rounded hover:bg-gray-100 transition-colors text-red-400",title:"Supprimer",children:(0,s.jsx)(F.Trash2,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("div",{className:"text-sm text-gray-700 mb-3 line-clamp-4 whitespace-pre-wrap",children:e.content}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1 flex-wrap gap-1",children:[e.isPrivate&&(0,s.jsxs)("span",{className:"px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium flex items-center",children:[(0,s.jsx)(_.EyeOff,{className:"w-3 h-3 mr-1"}),"Privee"]}),i.map((e,t)=>(0,s.jsxs)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 rounded-full text-xs font-medium flex items-center",children:[(0,s.jsx)(M.Tag,{className:"w-3 h-3 mr-1"}),e]},t))]}),e.updatedAt!==e.createdAt&&(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["Modifiee ",new Date(e.updatedAt).toLocaleDateString("fr-FR")]})]})]})}var q=e.i(343432),U=e.i(346897),z=e.i(63727),V=e.i(373884),B=e.i(16715),J=e.i(25652);function W(){let e=(0,a.useParams)(),i=e.id,[l,d]=(0,t.useState)(null),[c,x]=(0,t.useState)(null),[g,p]=(0,t.useState)(!0),[u,y]=(0,t.useState)("overview"),[f,v]=(0,t.useState)("all");(0,t.useEffect)(()=>{w()},[i]);let w=async()=>{try{p(!0);let e=await fetch(`/api/lawyer/workspaces/${i}`),s=await e.json();s.success&&(d(s.workspace),x(s.stats))}catch(e){console.error("Erreur chargement workspace:",e)}finally{p(!1)}};if(g)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(B.RefreshCw,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-indigo-600"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Chargement du workspace..."})]})});if(!l)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(V.XCircle,{className:"w-16 h-16 mx-auto mb-4 text-red-500"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Workspace non trouvé"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Le workspace demandé n'existe pas."})]})});let k={critique:"bg-red-100 text-red-800 border-red-300",haute:"bg-orange-100 text-orange-800 border-orange-300",normale:"bg-blue-100 text-blue-800 border-blue-300",faible:"bg-gray-100 text-gray-800 border-gray-300"},T={critique:"bg-red-600 text-white",eleve:"bg-orange-500 text-white",moyen:"bg-yellow-500 text-white",faible:"bg-green-500 text-white"};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white shadow",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"w-16 h-16 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold",children:[l.client.firstName[0],l.client.lastName[0]]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:[l.client.firstName," ",l.client.lastName]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:l.reference}),(0,s.jsxs)("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${k[l.globalPriority]||k.normale}`,children:["Priorité ",l.globalPriority]}),"active"===l.status&&(0,s.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:"Actif"})]})]})]}),(0,s.jsx)("div",{className:"flex space-x-2",children:(0,s.jsxs)("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,s.jsx)(r.Mail,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Nouveau message"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,s.jsx)(r.Mail,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:l.client.email})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,s.jsx)(q.Phone,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:l.client.phone||"Non renseigné"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,s.jsx)(U.MapPin,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:l.client.ville||"Non renseigné"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,s.jsx)(z.Briefcase,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:l.client.profession||"Non renseigné"})]})]})]})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Procédures"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l.totalProcedures}),(0,s.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:[l.activeProcedures," actives"]})]}),(0,s.jsx)(m.FileText,{className:"w-8 h-8 text-indigo-600"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Emails"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l.totalEmails}),(0,s.jsxs)("p",{className:"text-xs text-orange-600 mt-1",children:[c?.emailsUnread||0," non lus"]})]}),(0,s.jsx)(r.Mail,{className:"w-8 h-8 text-blue-600"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Documents"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l.totalDocuments}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Tous vérifiés"})]}),(0,s.jsx)(n,{className:"w-8 h-8 text-green-600"})]})}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Alertes"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:l.alerts.length}),(0,s.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:[c?.alertesCritiques||0," critiques"]})]}),(0,s.jsx)(b.AlertTriangle,{className:"w-8 h-8 text-red-600"})]})})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6",children:[(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[{id:"overview",label:"Vue d'ensemble",icon:J.TrendingUp},{id:"emails",label:"Emails",icon:r.Mail,badge:c?.emailsUnread},{id:"procedures",label:"Procédures",icon:m.FileText,badge:c?.proceduresCritiques},{id:"documents",label:"Documents",icon:n},{id:"timeline",label:"Timeline",icon:h.Clock},{id:"notes",label:"Notes",icon:R}].map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>y(e.id),className:`
                      flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm
                      ${u===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                    `,children:[(0,s.jsx)(t,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:e.label}),e.badge?(0,s.jsx)("span",{className:"ml-2 px-2 py-0.5 bg-red-100 text-red-800 rounded-full text-xs font-bold",children:e.badge}):null]},e.id)})})}),(0,s.jsxs)("div",{className:"p-6",children:["overview"===u&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Procédures en cours"}),(0,s.jsx)("div",{className:"space-y-3",children:l.procedures.slice(0,5).map(e=>(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${T[e.urgencyLevel]}`,children:e.procedureType}),(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:e.title})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.deadlineDate&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Échéance: ",new Date(e.deadlineDate).toLocaleDateString("fr-FR")]})]})})},e.id))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Derniers emails"}),(0,s.jsx)("div",{className:"space-y-3",children:l.emails.slice(0,5).map(e=>(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[!e.isRead&&(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.from})]}),(0,s.jsx)("p",{className:"text-sm text-gray-900 mt-1",children:e.subject}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.receivedDate).toLocaleDateString("fr-FR")})]}),"critical"===e.priority&&(0,s.jsx)(b.AlertTriangle,{className:"w-4 h-4 text-red-600"})]})},e.id))})]})]}),l.alerts.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Alertes actives"}),(0,s.jsx)("div",{className:"space-y-3",children:l.alerts.map(e=>(0,s.jsx)("div",{className:`border-l-4 p-4 rounded ${"critical"===e.level?"bg-red-50 border-red-600":"warning"===e.level?"bg-yellow-50 border-yellow-600":"bg-blue-50 border-blue-600"}`,children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)(b.AlertTriangle,{className:`w-5 h-5 mt-0.5 ${"critical"===e.level?"text-red-600":"warning"===e.level?"text-yellow-600":"text-blue-600"}`}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message})]})]})},e.id))})]})]}),"emails"===u&&(0,s.jsx)(o,{emails:l.emails,workspaceId:e.id,onRefresh:w}),"procedures"===u&&(0,s.jsx)(j,{procedures:l.procedures,onRefresh:w}),"documents"===u&&(0,s.jsx)(D,{documents:l.documents,workspaceId:e.id,onRefresh:w}),"timeline"===u&&(0,s.jsx)(N,{events:l.timeline}),"notes"===u&&(0,s.jsx)(O,{notes:l.notes,workspaceId:e.id,onRefresh:w})]})]})]})]})}e.s(["default",()=>W,"dynamic",0,"force-dynamic"],417964)}]);