(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,791614,e=>{"use strict";var t=e.i(843476),a=e.i(271645);function s(){let[e,s]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[d,c]=(0,a.useState)(new Date),[o,m]=(0,a.useState)("month"),[u,x]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[p,j]=(0,a.useState)(null),b="demo-tenant-001",v=(0,a.useCallback)(async()=>{try{let e=new Date(d.getFullYear(),d.getMonth(),1),t=new Date(d.getFullYear(),d.getMonth()+1,0),a=await fetch(`/api/calendar?tenantId=${b}&startDate=${e.toISOString()}&endDate=${t.toISOString()}`),l=await a.json();s(l.events||[])}catch(e){console.error("Erreur chargement evenements:",e)}finally{i(!1)}},[d,b]);(0,a.useEffect)(()=>{v()},[v]);let y=e=>({rdv:"bg-blue-500",audience:"bg-red-500",deadline:"bg-orange-500",rappel:"bg-yellow-500",autre:"bg-gray-500"})[e]||"bg-gray-500",f=e=>({rdv:"[emoji]",audience:"️",deadline:"",rappel:"[emoji]",autre:"[emoji]"})[e]||"[emoji]",N=e=>{c(new Date(d.getFullYear(),d.getMonth()+e,1))};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"[emoji] Calendrier"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Gerez vos rendez-vous et echeances"})]}),(0,t.jsxs)("button",{onClick:()=>{j(new Date),x(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[(0,t.jsx)("span",{}),"Nouveau RDV"]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow mb-6 p-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("button",{onClick:()=>N(-1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"️"}),(0,t.jsxs)("h2",{className:"text-xl font-semibold min-w-[200px] text-center",children:[["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"][d.getMonth()]," ",d.getFullYear()]}),(0,t.jsx)("button",{onClick:()=>N(1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"️"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>c(new Date),className:"px-3 py-1 border rounded-lg hover:bg-gray-50",children:"Aujourd'hui"}),(0,t.jsx)("div",{className:"flex border rounded-lg overflow-hidden",children:["month","week","day"].map(e=>(0,t.jsx)("button",{onClick:()=>m(e),className:`px-3 py-1 ${o===e?"bg-blue-600 text-white":"bg-white hover:bg-gray-50"}`,children:"month"===e?"Mois":"week"===e?"Semaine":"Jour"},e))})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:n?(0,t.jsx)("div",{className:"p-8 text-center",children:"Chargement..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-7 bg-gray-50 border-b",children:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"].map(e=>(0,t.jsx)("div",{className:"p-3 text-center text-sm font-medium text-gray-500",children:e},e))}),(0,t.jsx)("div",{className:"grid grid-cols-7",children:(()=>{let e=d.getFullYear(),t=d.getMonth(),a=new Date(e,t,1),s=new Date(e,t+1,0).getDate(),l=a.getDay(),r=[],n=new Date(e,t,0);for(let a=l-1;a>=0;a--)r.push({date:new Date(e,t-1,n.getDate()-a),isCurrentMonth:!1});for(let a=1;a<=s;a++)r.push({date:new Date(e,t,a),isCurrentMonth:!0});let i=42-r.length;for(let a=1;a<=i;a++)r.push({date:new Date(e,t+1,a),isCurrentMonth:!1});return r})().map(({date:a,isCurrentMonth:s},l)=>{let r,n=e.filter(e=>{let t=new Date(e.startDate);return t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()&&t.getDate()===a.getDate()});return(0,t.jsxs)("div",{onClick:()=>{j(a),0===n.length&&x(!0)},className:`min-h-[120px] border-b border-r p-2 cursor-pointer hover:bg-gray-50 ${!s?"bg-gray-50 text-gray-400":""}`,children:[(0,t.jsx)("div",{className:`text-sm font-medium mb-1 w-7 h-7 flex items-center justify-center rounded-full ${(r=new Date,a.getFullYear()===r.getFullYear()&&a.getMonth()===r.getMonth()&&a.getDate()===r.getDate())?"bg-blue-600 text-white":""}`,children:a.getDate()}),(0,t.jsxs)("div",{className:"space-y-1",children:[n.slice(0,3).map(e=>(0,t.jsxs)("div",{onClick:t=>{t.stopPropagation(),g(e)},className:`${y(e.type)} text-white text-xs px-2 py-1 rounded truncate cursor-pointer hover:opacity-80`,children:[f(e.type)," ",e.title]},e.id)),n.length>3&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 px-2",children:["+",n.length-3," autres"]})]})]},l)})})]})}),(0,t.jsxs)("div",{className:"mt-6 bg-white rounded-lg shadow p-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-3",children:"[emoji] Prochains evenements"}),e.filter(e=>new Date(e.startDate)>=new Date).sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()).slice(0,5).map(e=>(0,t.jsxs)("div",{onClick:()=>g(e),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[(0,t.jsx)("div",{className:`w-3 h-3 rounded-full ${y(e.type)}`}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:e.title}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[new Date(e.startDate).toLocaleDateString("fr-FR")," a"," ",new Date(e.startDate).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),(0,t.jsx)("span",{className:"text-2xl",children:f(e.type)})]},e.id)),0===e.filter(e=>new Date(e.startDate)>=new Date).length&&(0,t.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Aucun evenement a venir"})]}),u&&(0,t.jsx)(l,{tenantId:b,userId:"demo-user-001",defaultDate:p||new Date,onClose:()=>{x(!1),j(null)},onCreated:()=>{x(!1),j(null),v()}}),h&&(0,t.jsx)(r,{event:h,onClose:()=>g(null),onUpdate:()=>{g(null),v()}})]})}function l({tenantId:e,userId:s,defaultDate:l,onClose:r,onCreated:n}){let[i,d]=(0,a.useState)(""),[c,o]=(0,a.useState)(""),[m,u]=(0,a.useState)(""),[x,h]=(0,a.useState)("rdv"),[g,p]=(0,a.useState)(l.toISOString().slice(0,16)),[j,b]=(0,a.useState)(new Date(l.getTime()+36e5).toISOString().slice(0,16)),[v,y]=(0,a.useState)(!1),f=async()=>{if(!i)return void alert("Le titre est requis");y(!0);try{let t=await fetch("/api/calendar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:e,userId:s,title:i,description:c,location:m,type:x,startDate:new Date(g).toISOString(),endDate:new Date(j).toISOString()})});if(t.ok)n();else{let e=await t.json();alert(e.error||"Erreur creation evenement")}}catch(e){console.error("Erreur:",e)}finally{y(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[(0,t.jsx)("div",{className:"p-6 border-b",children:(0,t.jsx)("h2",{className:"text-xl font-bold",children:" Nouvel evenement"})}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre"}),(0,t.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded-lg",placeholder:"Reunion client, Audience..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,t.jsxs)("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[(0,t.jsx)("option",{value:"rdv",children:"[emoji] Rendez-vous"}),(0,t.jsx)("option",{value:"audience",children:"️ Audience"}),(0,t.jsx)("option",{value:"deadline",children:" echeance"}),(0,t.jsx)("option",{value:"rappel",children:"[emoji] Rappel"}),(0,t.jsx)("option",{value:"autre",children:"[emoji] Autre"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Debut"}),(0,t.jsx)("input",{type:"datetime-local",value:g,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fin"}),(0,t.jsx)("input",{type:"datetime-local",value:j,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border rounded-lg"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lieu"}),(0,t.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border rounded-lg",placeholder:"Cabinet, Tribunal..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,t.jsx)("textarea",{value:c,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded-lg",rows:3,placeholder:"Notes sur l'evenement..."})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:r,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Annuler"}),(0,t.jsx)("button",{onClick:f,disabled:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:v?"Creation...":"Creer"})]})]})})}function r({event:e,onClose:s,onUpdate:l}){let[r,n]=(0,a.useState)(!1),i=async()=>{if(confirm("Supprimer cet evenement ?")){n(!0);try{await fetch(`/api/calendar?eventId=${e.id}`,{method:"DELETE"}),l()}catch(e){console.error("Erreur:",e)}finally{n(!1)}}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full mx-4",children:[(0,t.jsxs)("div",{className:"p-6 border-b flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:e.title}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"x"})]}),(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Type:"}),(0,t.jsx)("span",{children:{rdv:"[emoji] Rendez-vous",audience:"️ Audience",deadline:" echeance",rappel:"[emoji] Rappel",autre:"[emoji] Autre"}[e.type]||e.type})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"[emoji] Date:"}),(0,t.jsxs)("span",{children:[new Date(e.startDate).toLocaleDateString("fr-FR")," de"," ",new Date(e.startDate).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})," ","a"," ",new Date(e.endDate).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})]})]}),e.location&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"[emoji] Lieu:"}),(0,t.jsx)("span",{children:e.location})]}),e.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"[emoji] Description:"}),(0,t.jsx)("p",{className:"mt-1",children:e.description})]}),e.client&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"[emoji] Client:"}),(0,t.jsxs)("span",{children:[e.client.firstName," ",e.client.lastName]})]}),e.dossier&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"[emoji] Dossier:"}),(0,t.jsx)("span",{children:e.dossier.numero})]})]}),(0,t.jsxs)("div",{className:"p-6 border-t flex justify-between",children:[(0,t.jsx)("button",{onClick:i,disabled:r,className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg disabled:opacity-50",children:"[emoji]️ Supprimer"}),(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Fermer"})]})]})})}e.s(["default",()=>s,"dynamic",0,"force-dynamic"])}]);