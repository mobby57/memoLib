# =============================================================================
# CLOUDFLARE PAGES - VARIABLES D'ENVIRONNEMENT PRODUCTION
# =============================================================================
# 
# Ce fichier liste UNIQUEMENT les variables ESSENTIELLES pour Cloudflare Pages
# Configuration: Settings > Environment Variables > Production
# 
# ⚠️ NE PAS commiter les vraies valeurs - Utilisez les placeholders ci-dessous
# =============================================================================

# -----------------------------------------------------------------------------
# DATABASE - CRITICAL
# -----------------------------------------------------------------------------
# Pour Cloudflare Pages avec D1 (SQLite):
DATABASE_URL="file:./prisma/prod.db"

# Ou pour PostgreSQL externe (Supabase, Neon, PlanetScale):
# DATABASE_URL="postgresql://user:password@host:5432/database?sslmode=require"

# -----------------------------------------------------------------------------
# NEXTAUTH - CRITICAL
# -----------------------------------------------------------------------------
# URL de production Cloudflare Pages
NEXTAUTH_URL="https://votre-app.pages.dev"

# Secret pour JWT (IMPORTANT: Générer avec: openssl rand -base64 32)
NEXTAUTH_SECRET="REMPLACER_PAR_SECRET_GENERE_OPENSSL"

# -----------------------------------------------------------------------------
# OLLAMA IA - REQUIRED
# -----------------------------------------------------------------------------
# URL du serveur Ollama (doit être accessible publiquement)
OLLAMA_BASE_URL="https://votre-ollama-server.com:11434"
OLLAMA_MODEL="llama3.2:3b"
OLLAMA_TIMEOUT="30000"

# ⚠️ Alternative: Utiliser Cloudflare Workers AI
# CLOUDFLARE_WORKERS_AI="true"
# CLOUDFLARE_ACCOUNT_ID="votre-account-id"
# CLOUDFLARE_AI_TOKEN="votre-ai-token"

# -----------------------------------------------------------------------------
# GITHUB INTEGRATION - REQUIRED (OAuth + App)
# -----------------------------------------------------------------------------
# GitHub OAuth (pour NextAuth)
GITHUB_CLIENT_ID="Ov23li5eLXXXXXXXXXXX"
GITHUB_CLIENT_SECRET="votre-github-oauth-secret"

# GitHub App (pour Webhooks et API)
GITHUB_APP_ID="2594935"
GITHUB_APP_PRIVATE_KEY_PATH="./github-app-key.pem"
GITHUB_WEBHOOK_SECRET="votre-webhook-secret"
GITHUB_REPOSITORY="mobby57/iapostemanager"
GITHUB_BRANCH_MAIN="main"

# GitHub Webhook Configuration
PUBLIC_WEBHOOK_URL="https://votre-app.pages.dev/api/webhooks/github"
WEBHOOK_GITHUB_ENABLED="true"
WEBHOOK_GITHUB_EVENTS="push,pull_request,issues"

# -----------------------------------------------------------------------------
# EMAIL - GMAIL API (OAuth 2.0)
# -----------------------------------------------------------------------------
GMAIL_CLIENT_ID="votre-client-id.apps.googleusercontent.com"
GMAIL_CLIENT_SECRET="votre-gmail-secret"
GMAIL_REDIRECT_URI="https://votre-app.pages.dev/api/auth/callback/google"

# Email SMTP (Alternative ou backup)
EMAIL_ENABLED="true"
EMAIL_SMTP_HOST="smtp.gmail.com"
EMAIL_SMTP_PORT="587"
EMAIL_SMTP_USER="votre-email@gmail.com"
EMAIL_SMTP_APP_PASSWORD="votre-app-password"
EMAIL_FROM="IA Poste Manager <votre-email@gmail.com>"
EMAIL_ADDRESS="votre-email@gmail.com"

# -----------------------------------------------------------------------------
# API LÉGIFRANCE PISTE - PRODUCTION
# -----------------------------------------------------------------------------
# Sandbox (pour tests)
PISTE_SANDBOX_CLIENT_ID="f269101e-746d-41c8-a4b4-346979639e1e"
PISTE_SANDBOX_CLIENT_SECRET="votre-secret-sandbox"
PISTE_SANDBOX_OAUTH_URL="https://sandbox-oauth.piste.gouv.fr/api/oauth/token"
PISTE_SANDBOX_API_URL="https://sandbox-api.piste.gouv.fr/dila/legifrance/lf-engine-app"

# Production (nécessite demande à PISTE)
PISTE_PROD_CLIENT_ID="votre-client-id-production"
PISTE_PROD_CLIENT_SECRET="votre-secret-production"
PISTE_PROD_OAUTH_URL="https://oauth.piste.gouv.fr/api/oauth/token"
PISTE_PROD_API_URL="https://api.piste.gouv.fr/dila/legifrance/lf-engine-app"

# Environnement actif (sandbox | production)
PISTE_ENVIRONMENT="production"

# -----------------------------------------------------------------------------
# CLOUDFLARE TUNNEL - OPTIONAL (si vous utilisez Tunnel en prod)
# -----------------------------------------------------------------------------
CLOUDFLARE_TUNNEL_ENABLED="false"
# CLOUDFLARE_TUNNEL_URL="https://votre-tunnel.trycloudflare.com"
# CLOUDFLARE_TUNNEL_TOKEN="votre-tunnel-token"

# -----------------------------------------------------------------------------
# WEBSOCKET - REQUIRED (Notifications temps réel)
# -----------------------------------------------------------------------------
WEBSOCKET_ENABLED="true"
WEBSOCKET_PORT="3001"
WEBSOCKET_PATH="/api/socket"

# -----------------------------------------------------------------------------
# SECURITY - CRITICAL
# -----------------------------------------------------------------------------
# Encryption Keys (Générer avec: openssl rand -hex 32)
ENCRYPTION_KEY="REMPLACER_PAR_CLE_GENEREE_32_BYTES"
TENANT_ENCRYPTION_KEY="REMPLACER_PAR_CLE_GENEREE_32_BYTES"

# JWT Secrets (Générer avec: openssl rand -base64 32)
JWT_SECRET="REMPLACER_PAR_SECRET_JWT"
JWT_REFRESH_SECRET="REMPLACER_PAR_SECRET_REFRESH"

# Session Configuration
SESSION_TIMEOUT="7200000"
SESSION_ABSOLUTE_TIMEOUT="28800000"

# CORS Origins (Séparer par virgules)
ALLOWED_ORIGINS="https://votre-app.pages.dev,https://votre-domaine.com"

# Rate Limiting
API_RATE_LIMIT_ENABLED="true"
API_RATE_LIMIT_MAX="100"
API_RATE_LIMIT_WINDOW="60000"

# -----------------------------------------------------------------------------
# MONITORING & ANALYTICS - RECOMMENDED
# -----------------------------------------------------------------------------
# Sentry (Error tracking)
SENTRY_DSN="https://votre-sentry-dsn@sentry.io/123456"
SENTRY_ENVIRONMENT="production"
SENTRY_ENABLED="true"

# Google Analytics
NEXT_PUBLIC_GA_ID="G-XXXXXXXXXX"
ANALYTICS_ENABLED="true"

# Vercel Analytics (si déployé sur Vercel aussi)
# VERCEL_ANALYTICS_ENABLED="true"

# -----------------------------------------------------------------------------
# STORAGE - RECOMMENDED (Documents Cloud)
# -----------------------------------------------------------------------------
# AWS S3
AWS_ACCESS_KEY_ID="votre-access-key"
AWS_SECRET_ACCESS_KEY="votre-secret-key"
AWS_REGION="eu-west-3"
AWS_BUCKET_NAME="iaposte-documents-prod"
AWS_S3_ENABLED="true"

# Cloudflare R2 (Alternative S3-compatible)
# R2_ACCOUNT_ID="votre-account-id"
# R2_ACCESS_KEY_ID="votre-r2-access-key"
# R2_SECRET_ACCESS_KEY="votre-r2-secret"
# R2_BUCKET_NAME="iaposte-documents"
# R2_PUBLIC_URL="https://votre-bucket.r2.dev"
# R2_ENABLED="true"

# -----------------------------------------------------------------------------
# PAYMENT - OPTIONAL (Facturation SaaS)
# -----------------------------------------------------------------------------
STRIPE_PUBLIC_KEY="pk_live_votre_cle_publique"
STRIPE_SECRET_KEY="sk_live_votre_cle_secrete"
STRIPE_WEBHOOK_SECRET="whsec_votre_webhook_secret"
STRIPE_ENABLED="false"

# -----------------------------------------------------------------------------
# ADVANCED AI FEATURES - OPTIONAL
# -----------------------------------------------------------------------------
AI_LEARNING_ENABLED="true"
AI_SUGGESTIONS_ENABLED="true"
AI_SEMANTIC_SEARCH_ENABLED="true"

# OpenAI (Backup si Ollama indisponible)
# OPENAI_API_KEY="sk-votre-openai-key"
# OPENAI_MODEL="gpt-4-turbo"
# OPENAI_ENABLED="false"

# -----------------------------------------------------------------------------
# MULTI-TENANT - CRITICAL
# -----------------------------------------------------------------------------
TENANT_ISOLATION_ENABLED="true"
TENANT_DEFAULT_PLAN="BASIC"

# -----------------------------------------------------------------------------
# FEATURES FLAGS - OPTIONAL
# -----------------------------------------------------------------------------
EMAIL_MONITORING_ENABLED="true"
PDF_GENERATION_ENABLED="true"
OCR_ENABLED="false"
QUEUE_ENABLED="false"

# -----------------------------------------------------------------------------
# NODE ENVIRONMENT
# -----------------------------------------------------------------------------
NODE_ENV="production"
NEXT_TELEMETRY_DISABLED="1"

# =============================================================================
# INSTRUCTIONS DE CONFIGURATION CLOUDFLARE PAGES
# =============================================================================
#
# 1. Aller dans votre projet Cloudflare Pages
# 2. Settings > Environment Variables > Production
# 3. Ajouter CHAQUE variable ci-dessus avec les VRAIES valeurs
# 4. Cliquer "Encrypt" pour les secrets (passwords, tokens, keys)
# 5. Redéployer après ajout des variables
#
# VARIABLES CRITIQUES À CONFIGURER EN PRIORITÉ:
# ✅ DATABASE_URL
# ✅ NEXTAUTH_URL
# ✅ NEXTAUTH_SECRET
# ✅ OLLAMA_BASE_URL (ou activer Cloudflare Workers AI)
# ✅ GITHUB_CLIENT_ID + GITHUB_CLIENT_SECRET
# ✅ EMAIL_SMTP_* (pour notifications)
# ✅ ENCRYPTION_KEY + JWT_SECRET
#
# SÉCURITÉ:
# - Générer tous les secrets avec: openssl rand -base64 32
# - Ne JAMAIS commiter ce fichier avec de vraies valeurs
# - Utiliser "Encrypt" dans Cloudflare Pages pour tous les secrets
# - Activer "Preview" séparé pour tester avant production
#
# DOCUMENTATION COMPLÈTE:
# Voir CLOUDFLARE_PAGES_DEPLOY.md pour guide détaillé
#
# =============================================================================
