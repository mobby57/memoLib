<!DOCTYPE html>
<html>
<head>
    <title>Param√®tres - IAPosteManager</title>
    <style>
        body { font-family: Arial; margin: 0; background: #f8fafc; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .header { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .back-btn { background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        .settings-grid { display: grid; gap: 20px; }
        .settings-section { background: white; border-radius: 8px; padding: 25px; }
        .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333; display: flex; align-items: center; gap: 10px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #374151; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; box-sizing: border-box; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #3b82f6; }
        input:checked + .slider:before { transform: translateX(26px); }
        .btn-save { background: #10b981; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; }
        .btn-save:hover { background: #059669; }
        .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #f3f4f6; }
        .setting-item:last-child { border-bottom: none; }
        .setting-info h4 { margin: 0 0 5px 0; color: #374151; }
        .setting-info p { margin: 0; color: #6b7280; font-size: 14px; }
        .status-indicator { display: inline-block; width: 8px; height: 8px; border-radius: 50%; margin-right: 8px; }
        .status-online { background: #10b981; }
        .status-offline { background: #ef4444; }
        .status-warning { background: #f59e0b; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öôÔ∏è Param√®tres</h1>
            <button class="back-btn" onclick="window.location.href='/navigation.html'">‚Üê Retour</button>
        </div>
        
        <div class="settings-grid">
            <!-- Configuration Email -->
            <div class="settings-section">
                <h2 class="section-title">üìß Configuration Email</h2>
                
                <div class="form-group">
                    <label>Adresse email principale</label>
                    <input type="email" id="mainEmail" placeholder="votre@email.com">
                </div>
                
                <div class="form-group">
                    <label>Mot de passe d'application</label>
                    <input type="password" id="appPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                    <small style="color: #6b7280;">Utilisez un mot de passe d'application Gmail</small>
                </div>
                
                <div class="form-group">
                    <label>Serveur SMTP</label>
                    <select id="smtpServer">
                        <option value="gmail">Gmail (smtp.gmail.com)</option>
                        <option value="outlook">Outlook (smtp-mail.outlook.com)</option>
                        <option value="custom">Personnalis√©</option>
                    </select>
                </div>
                
                <button class="btn-save" onclick="saveEmailConfig()">üíæ Sauvegarder</button>
            </div>
            
            <!-- Configuration IA -->
            <div class="settings-section">
                <h2 class="section-title">ü§ñ Intelligence Artificielle</h2>
                
                <div class="form-group">
                    <label>Cl√© API OpenAI</label>
                    <input type="password" id="openaiKey" placeholder="sk-‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>G√©n√©ration automatique</h4>
                        <p>Activer la g√©n√©ration automatique de suggestions</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoGeneration">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>Am√©lioration automatique</h4>
                        <p>Corriger automatiquement la grammaire et le style</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoImprovement">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <button class="btn-save" onclick="saveAIConfig()">üíæ Sauvegarder</button>
            </div>
            
            <!-- Accessibilit√© -->
            <div class="settings-section">
                <h2 class="section-title">‚ôø Accessibilit√©</h2>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>Synth√®se vocale (TTS)</h4>
                        <p>Lecture automatique des messages</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="ttsEnabled">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>Mode haut contraste</h4>
                        <p>Am√©liorer la lisibilit√© pour les malvoyants</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="highContrast">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="form-group">
                    <label>Taille de police</label>
                    <select id="fontSize">
                        <option value="small">Petite</option>
                        <option value="medium">Moyenne</option>
                        <option value="large">Grande</option>
                        <option value="x-large">Tr√®s grande</option>
                    </select>
                </div>
                
                <button class="btn-save" onclick="saveAccessibilityConfig()">üíæ Sauvegarder</button>
            </div>
            
            <!-- Notifications -->
            <div class="settings-section">
                <h2 class="section-title">üîî Notifications</h2>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>Notifications email</h4>
                        <p>Recevoir des notifications pour les nouveaux emails</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="emailNotifications" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4>Sons de notification</h4>
                        <p>Jouer un son lors des notifications</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="soundNotifications">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <button class="btn-save" onclick="saveNotificationConfig()">üíæ Sauvegarder</button>
            </div>
            
            <!-- √âtat du syst√®me -->
            <div class="settings-section">
                <h2 class="section-title">üìä √âtat du Syst√®me</h2>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4><span class="status-indicator status-online"></span>API Backend</h4>
                        <p>Connexion au serveur principal</p>
                    </div>
                    <span style="color: #10b981; font-weight: 600;">En ligne</span>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4><span class="status-indicator status-warning"></span>Base de donn√©es</h4>
                        <p>√âtat de la base de donn√©es</p>
                    </div>
                    <span style="color: #f59e0b; font-weight: 600;">SQLite (Local)</span>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <h4><span class="status-indicator status-offline"></span>Service IA</h4>
                        <p>Connexion OpenAI</p>
                    </div>
                    <span style="color: #ef4444; font-weight: 600;">Non configur√©</span>
                </div>
                
                <button class="btn-save" onclick="testConnections()">üîç Tester les connexions</button>
            </div>
        </div>
    </div>

    <script>
        async function loadSettings() {
            try {
                // Charger les param√®tres d'accessibilit√©
                const accessResponse = await fetch('/api/accessibility/settings');
                if (accessResponse.ok) {
                    const accessData = await accessResponse.json();
                    if (accessData.success) {
                        document.getElementById('ttsEnabled').checked = accessData.settings.tts_enabled || false;
                        document.getElementById('highContrast').checked = accessData.settings.high_contrast || false;
                        document.getElementById('fontSize').value = accessData.settings.font_size || 'medium';
                    }
                }
                
                // Charger les param√®tres g√©n√©raux
                const configResponse = await fetch('/api/credentials');
                if (configResponse.ok) {
                    const configData = await configResponse.json();
                    if (configData.success) {
                        document.getElementById('mainEmail').value = configData.email || '';
                    }
                }
            } catch (error) {
                console.error('Erreur chargement param√®tres:', error);
            }
        }
        
        async function saveEmailConfig() {
            const emailData = {
                email: document.getElementById('mainEmail').value,
                app_password: document.getElementById('appPassword').value
            };
            
            try {
                const response = await fetch('/api/credentials', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(emailData)
                });
                
                const data = await response.json();
                if (data.success) {
                    alert('‚úÖ Configuration email sauvegard√©e !');
                } else {
                    alert('‚ùå Erreur: ' + (data.error || 'Erreur inconnue'));
                }
            } catch (error) {
                alert('‚ùå Erreur de connexion');
            }
        }
        
        async function saveAIConfig() {
            const aiData = {
                openai_key: document.getElementById('openaiKey').value
            };
            
            try {
                const response = await fetch('/api/credentials', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(aiData)
                });
                
                const data = await response.json();
                if (data.success) {
                    alert('‚úÖ Configuration IA sauvegard√©e !');
                } else {
                    alert('‚ùå Erreur: ' + (data.error || 'Erreur inconnue'));
                }
            } catch (error) {
                alert('‚ùå Erreur de connexion');
            }
        }
        
        async function saveAccessibilityConfig() {
            const accessData = {
                toggle_tts: document.getElementById('ttsEnabled').checked,
                toggle_contrast: document.getElementById('highContrast').checked,
                font_size: document.getElementById('fontSize').value
            };
            
            try {
                const response = await fetch('/api/accessibility/settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(accessData)
                });
                
                const data = await response.json();
                if (data.success) {
                    alert('‚úÖ Param√®tres d\'accessibilit√© sauvegard√©s !');
                } else {
                    alert('‚ùå Erreur: ' + (data.error || 'Erreur inconnue'));
                }
            } catch (error) {
                alert('‚ùå Erreur de connexion');
            }
        }
        
        function saveNotificationConfig() {
            alert('‚úÖ Param√®tres de notification sauvegard√©s !');
        }
        
        async function testConnections() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                
                if (data.status === 'healthy') {
                    alert('‚úÖ Toutes les connexions sont fonctionnelles !');
                } else {
                    alert('‚ö†Ô∏è Certains services ne r√©pondent pas correctement');
                }
            } catch (error) {
                alert('‚ùå Erreur lors du test des connexions');
            }
        }
        
        window.onload = loadSettings;
    </script>
</body>
</html>