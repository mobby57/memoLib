# ğŸ¨ SYSTÃˆME DE WORKFLOW CONDITIONNEL - DIAGRAMMES VISUELS

## ğŸ“Š Vue d'Ensemble

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SYSTÃˆME DE WORKFLOW CONDITIONNEL                â”‚
â”‚                         (AdvancedWorkflowEngine)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚      60+ Types d'Ã‰vÃ©nements          â”‚
           â”‚  (email, workspace, document, etc.)  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚    RÃ¨gles de Workflow EnregistrÃ©es   â”‚
           â”‚      (Trigger + Conditions + Actions) â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚    Ã‰valuation des Conditions          â”‚
           â”‚  (15 opÃ©rateurs, AND/OR imbriquÃ©s)    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚     ExÃ©cution des Actions             â”‚
           â”‚  (SÃ©quentiel / ParallÃ¨le / Conditionnel)â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚    Cascade d'Actions (infinie)       â”‚
           â”‚  (onSuccess / onFailure / onTimeout)  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚      40+ Types d'Actions              â”‚
           â”‚   (crÃ©ation, communication, IA, etc.) â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flux de Traitement d'un Ã‰vÃ©nement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ã‰vÃ©nement â”‚  (ex: email:urgent)
â”‚  DÃ©clenchÃ©  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. RECHERCHE DES RÃˆGLES CORRESPONDANTES            â”‚
â”‚     - Parcourir toutes les rÃ¨gles actives           â”‚
â”‚     - Matcher event.type avec trigger.events        â”‚
â”‚     - Filtrer par prioritÃ© (DESC)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Ã‰VALUATION DES CONDITIONS                       â”‚
â”‚     - Pour chaque rÃ¨gle trouvÃ©e                     â”‚
â”‚     - Ã‰valuer conditions (AND/OR rÃ©cursif)          â”‚
â”‚     - Garder seulement rÃ¨gles validÃ©es              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. EXÃ‰CUTION DES ACTIONS                           â”‚
â”‚     - Mode SÃ©quentiel : une par une                 â”‚
â”‚     - Mode ParallÃ¨le : toutes en mÃªme temps         â”‚
â”‚     - Mode Conditionnel : selon conditions          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. CASCADE D'ACTIONS                               â”‚
â”‚     - Si action.onSuccess â†’ DÃ©clencher Ã©vÃ©nements   â”‚
â”‚     - Si action.onFailure â†’ DÃ©clencher Ã©vÃ©nements   â”‚
â”‚     - Si action.onTimeout â†’ DÃ©clencher Ã©vÃ©nements   â”‚
â”‚     - RÃ©pÃ©ter le processus (rÃ©cursif)               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. RÃ‰SULTAT & AUDIT                                â”‚
â”‚     - Enregistrer exÃ©cution dans historique         â”‚
â”‚     - Logger tous les Ã©vÃ©nements                    â”‚
â”‚     - Mettre Ã  jour statistiques                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“§ Exemple Concret : Email Urgent CESEDA

```
Ã‰VÃ‰NEMENT INITIAL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  email:urgent                          â”‚
â”‚  - classification: "ceseda"            â”‚
â”‚  - clientName: "M. DUBOIS"             â”‚
â”‚  - priority: "critical"                â”‚
â”‚  - extractedInfo.procedureType: "OQTF"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RÃˆGLE 1 : "Email Urgent â†’ CrÃ©ation Workspace"                â”‚
â”‚  PrioritÃ©: 100                                                 â”‚
â”‚                                                                â”‚
â”‚  CONDITIONS:                                                   â”‚
â”‚    âœ“ payload.classification === "ceseda"                      â”‚
â”‚                                                                â”‚
â”‚  ACTIONS (SÃ©quentiel):                                         â”‚
â”‚    1. create_workspace                                         â”‚
â”‚       â†’ workspaceId = "ws_123"                                 â”‚
â”‚       â†’ onSuccess: DÃ©clencher "workspace:created"             â”‚
â”‚                                                                â”‚
â”‚    2. create_alert                                             â”‚
â”‚       â†’ severity: CRITICAL                                     â”‚
â”‚                                                                â”‚
â”‚    3. send_notification                                        â”‚
â”‚       â†’ recipientRole: ADMIN                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼ (CASCADE via onSuccess)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰VÃ‰NEMENT CASCADE 1                                           â”‚
â”‚  workspace:created                                             â”‚
â”‚  - workspaceId: "ws_123"                                       â”‚
â”‚  - clientId: "client_456"                                      â”‚
â”‚  - procedureType: "OQTF"                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RÃˆGLE 2 : "Workspace CrÃ©Ã© â†’ CrÃ©er ProcÃ©dure"                 â”‚
â”‚  PrioritÃ©: 95                                                  â”‚
â”‚                                                                â”‚
â”‚  ACTIONS (SÃ©quentiel):                                         â”‚
â”‚    1. create_procedure                                         â”‚
â”‚       â†’ procedureType: "OQTF"                                  â”‚
â”‚       â†’ procedureId = "proc_789"                               â”‚
â”‚       â†’ onSuccess: DÃ©clencher "procedure:created"             â”‚
â”‚                                                                â”‚
â”‚    2. create_timeline_event                                    â”‚
â”‚       â†’ eventType: "procedure_created"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼ (CASCADE via onSuccess)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ã‰VÃ‰NEMENT CASCADE 2                                           â”‚
â”‚  procedure:created                                             â”‚
â”‚  - procedureId: "proc_789"                                     â”‚
â”‚  - procedureType: "OQTF"                                       â”‚
â”‚  - notificationDate: "2026-01-15"                              â”‚
â”‚  - deadlineDate: "2026-01-17" (48h)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RÃˆGLE 3 : "ProcÃ©dure OQTF â†’ Extraire Ã‰chÃ©ances"              â”‚
â”‚  PrioritÃ©: 90                                                  â”‚
â”‚                                                                â”‚
â”‚  CONDITIONS:                                                   â”‚
â”‚    âœ“ payload.procedureType === "OQTF"                         â”‚
â”‚                                                                â”‚
â”‚  ACTIONS (ParallÃ¨le):                                          â”‚
â”‚    1. create_deadline (Recours contentieux)                    â”‚
â”‚       â†’ deadline: "2026-01-17" (48h)                           â”‚
â”‚       â†’ priority: CRITICAL                                     â”‚
â”‚       â†’ onSuccess: DÃ©clencher "deadline:created"              â”‚
â”‚                                                                â”‚
â”‚    2. create_deadline (Recours gracieux)                       â”‚
â”‚       â†’ deadline: "2026-01-17"                                 â”‚
â”‚                                                                â”‚
â”‚    3. send_email (Client)                                      â”‚
â”‚       â†’ subject: "URGENT : OQTF Notification"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RÃ‰SULTAT FINAL (aprÃ¨s 3 cascades automatiques)                â”‚
â”‚                                                                â”‚
â”‚  âœ… Workspace crÃ©Ã©                                             â”‚
â”‚  âœ… ProcÃ©dure OQTF crÃ©Ã©e                                       â”‚
â”‚  âœ… 2 Ã©chÃ©ances extraites (48h)                                â”‚
â”‚  âœ… Alertes critiques crÃ©Ã©es                                   â”‚
â”‚  âœ… Avocat notifiÃ©                                             â”‚
â”‚  âœ… Client informÃ© par email                                   â”‚
â”‚                                                                â”‚
â”‚  DurÃ©e totale: < 2 secondes                                    â”‚
â”‚  Actions exÃ©cutÃ©es: 8                                          â”‚
â”‚  Cascades dÃ©clenchÃ©es: 3                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§® Ã‰valuation des Conditions Complexes

```
CONDITION IMBRIQUÃ‰E (AND/OR)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

RequÃªte: (priority === "critical" AND (daysRemaining < 3 OR status === "urgent"))

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONDITION 1 (Root)                                â”‚
â”‚  field: payload.priority                           â”‚
â”‚  operator: equals                                  â”‚
â”‚  value: "critical"                                 â”‚
â”‚  logicalOperator: AND                              â”‚
â”‚                                                    â”‚
â”‚  Ã‰valuation: payload.priority === "critical"       â”‚
â”‚  RÃ©sultat: TRUE âœ“                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼ (AND - Doit continuer)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONDITION 1.1 (Nested)                            â”‚
â”‚  field: payload.daysRemaining                      â”‚
â”‚  operator: less_than                               â”‚
â”‚  value: 3                                          â”‚
â”‚  logicalOperator: OR                               â”‚
â”‚                                                    â”‚
â”‚  Ã‰valuation: payload.daysRemaining < 3             â”‚
â”‚  RÃ©sultat: TRUE âœ“ (daysRemaining = 2)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼ (OR - TRUE trouvÃ©, pas besoin de continuer)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONDITION 1.1.1 (Nested)                          â”‚
â”‚  field: payload.status                             â”‚
â”‚  operator: equals                                  â”‚
â”‚  value: "urgent"                                   â”‚
â”‚                                                    â”‚
â”‚  Ã‰valuation: SKIPPED (OR dÃ©jÃ  TRUE)                â”‚
â”‚  RÃ©sultat: N/A                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ‰SULTAT FINAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TRUE âœ“ (priority === "critical" AND (daysRemaining < 3))

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… RÃ¨gle dÃ©clenchÃ©e !                   â”‚
â”‚  â†’ ExÃ©cution des actions                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Modes d'ExÃ©cution des Actions

### Mode SÃ©quentiel

```
ACTIONS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 1  â”‚  â”€â”€â”€â–º ExÃ©cution
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (Attend rÃ©sultat)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 2  â”‚  â”€â”€â”€â–º ExÃ©cution (seulement aprÃ¨s Action 1)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (Attend rÃ©sultat)
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 3  â”‚  â”€â”€â”€â–º ExÃ©cution (seulement aprÃ¨s Action 2)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Avantages:
âœ“ Actions dÃ©pendantes (Action 2 utilise rÃ©sultat Action 1)
âœ“ ContrÃ´le total de l'ordre
âœ“ ArrÃªt si erreur (par dÃ©faut)

InconvÃ©nients:
âœ— Plus lent (attend chaque action)
```

### Mode ParallÃ¨le

```
ACTIONS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 1  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  Action 2  â”‚  â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¼â”€â”€â”€â–º ExÃ©cution simultanÃ©e
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â”‚
                      â”‚    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  Action 3  â”‚  â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Toutes finies  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Avantages:
âœ“ Maximum de performance
âœ“ IdÃ©al pour actions indÃ©pendantes

InconvÃ©nients:
âœ— Pas de garantie d'ordre
âœ— Actions ne peuvent pas dÃ©pendre les unes des autres
```

### Mode Conditionnel

```
ACTIONS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 1                          â”‚
â”‚  Condition: priority === "high"    â”‚  â”€â”€â”€ Ã‰value condition
â”‚                                    â”‚
â”‚  âœ“ Condition vraie                 â”‚  â”€â”€â”€â–º ExÃ©cute
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 2                          â”‚
â”‚  Condition: daysRemaining < 7      â”‚  â”€â”€â”€ Ã‰value condition
â”‚                                    â”‚
â”‚  âœ— Condition fausse                â”‚  â”€â”€â”€â–º Skip
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action 3                          â”‚
â”‚  Condition: status === "urgent"    â”‚  â”€â”€â”€ Ã‰value condition
â”‚                                    â”‚
â”‚  âœ“ Condition vraie                 â”‚  â”€â”€â”€â–º ExÃ©cute
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Avantages:
âœ“ Logique complexe par action
âœ“ ContrÃ´le fin de ce qui s'exÃ©cute

InconvÃ©nients:
âœ— Plus complexe Ã  configurer
```

---

## ğŸ¤– Validation IA (Niveaux d'Autonomie)

```
ACTION AVEC VALIDATION IA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Action Ã  exÃ©cuter            â”‚
â”‚  - requiresValidation: true   â”‚
â”‚  - autonomyLevel: ORANGE      â”‚
â”‚  - aiValidation.confidence: 0.7â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DÃ‰CISION SELON NIVEAU D'AUTONOMIE          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º Niveau GREEN (confiance >= 0.8)
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚  âœ… AUTO-APPROBATION         â”‚
         â”‚   â”‚  - ExÃ©cution immÃ©diate       â”‚
         â”‚   â”‚  - Aucune validation requise â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â–º Niveau ORANGE (0.5 <= confiance < 0.8)
         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   â”‚  ğŸ¤– VALIDATION IA            â”‚
         â”‚   â”‚  1. Appel Ollama            â”‚
         â”‚   â”‚  2. Analyse contexte        â”‚
         â”‚   â”‚  3. DÃ©cision approve/reject â”‚
         â”‚   â”‚                             â”‚
         â”‚   â”‚  Si approve: âœ… ExÃ©cute     â”‚
         â”‚   â”‚  Si reject: âŒ Bloque       â”‚
         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â–º Niveau RED (confiance < 0.5)
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  ğŸ‘¤ VALIDATION HUMAINE       â”‚
             â”‚  - Action mise en attente    â”‚
             â”‚  - Notification envoyÃ©e      â”‚
             â”‚  - Attente approbation       â”‚
             â”‚                              â”‚
             â”‚  AprÃ¨s validation humaine:   â”‚
             â”‚  âœ… ExÃ©cute                  â”‚
             â”‚  âŒ Annule                   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Cascade d'Actions (Exemple OQTF)

```
Ã‰VÃ‰NEMENT: email:urgent (OQTF)
â”‚
â”œâ”€â–º RÃˆGLE 1: CrÃ©er Workspace
â”‚   â”‚
â”‚   â”œâ”€â–º ACTION 1: create_workspace
â”‚   â”‚   â””â”€â–º onSuccess: workspace:created â”€â”€â”
â”‚   â”‚                                       â”‚
â”‚   â”œâ”€â–º ACTION 2: create_alert             â”‚
â”‚   â”‚                                       â”‚
â”‚   â””â”€â–º ACTION 3: send_notification        â”‚
â”‚                                           â”‚
â”‚                                           â”‚
â”‚   Ã‰VÃ‰NEMENT CASCADE: workspace:created â—„â”€â”€â”˜
â”‚   â”‚
â”‚   â””â”€â–º RÃˆGLE 2: CrÃ©er ProcÃ©dure
â”‚       â”‚
â”‚       â”œâ”€â–º ACTION 1: create_procedure
â”‚       â”‚   â””â”€â–º onSuccess: procedure:created â”€â”€â”
â”‚       â”‚                                       â”‚
â”‚       â””â”€â–º ACTION 2: create_timeline_event    â”‚
â”‚                                               â”‚
â”‚                                               â”‚
â”‚       Ã‰VÃ‰NEMENT CASCADE: procedure:created â—„â”€â”€â”˜
â”‚       â”‚
â”‚       â””â”€â–º RÃˆGLE 3: Extraire Ã‰chÃ©ances
â”‚           â”‚
â”‚           â”œâ”€â–º ACTION 1: create_deadline (48h recours)
â”‚           â”‚   â””â”€â–º onSuccess: deadline:created â”€â”€â”
â”‚           â”‚                                      â”‚
â”‚           â”œâ”€â–º ACTION 2: create_deadline (gracieux)
â”‚           â”‚                                      â”‚
â”‚           â””â”€â–º ACTION 3: send_email (client)     â”‚
â”‚                                                  â”‚
â”‚                                                  â”‚
â”‚           Ã‰VÃ‰NEMENT CASCADE: deadline:created â—„â”€â”€â”˜
â”‚           â”‚
â”‚           â””â”€â–º RÃˆGLE 4: Alerter Ã‰chÃ©ance Critique
â”‚               â”‚
â”‚               â”œâ”€â–º ACTION 1: create_alert (CRITICAL)
â”‚               â”œâ”€â–º ACTION 2: send_email (avocat)
â”‚               â”œâ”€â–º ACTION 3: send_notification
â”‚               â””â”€â–º ACTION 4: send_sms (< 24h)
â”‚
â”‚
â””â”€â–º RÃ‰SULTAT FINAL (4 niveaux de cascade)
    âœ… Workspace crÃ©Ã©
    âœ… ProcÃ©dure OQTF crÃ©Ã©e
    âœ… 2 Ã©chÃ©ances extraites
    âœ… 4 alertes critiques
    âœ… 3 notifications envoyÃ©es
    âœ… 2 emails envoyÃ©s
    âœ… 1 SMS si < 24h
    
    Total: 13 actions exÃ©cutÃ©es automatiquement
    DurÃ©e: < 3 secondes
```

---

## ğŸ“Š Architecture Technique

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ADVANCED WORKFLOW ENGINE                     â”‚
â”‚                  (Singleton - Instance unique)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                         â”‚
                 â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  RÃ¨gles EnregistrÃ©es â”‚  â”‚  Historique          â”‚
    â”‚  (WorkflowRule[])    â”‚  â”‚  ExÃ©cutions          â”‚
    â”‚                      â”‚  â”‚  (WorkflowExecution[])â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
        â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MÃ©thodes     â”‚  â”‚ MÃ©thodes         â”‚
â”‚ Publiques    â”‚  â”‚ PrivÃ©es          â”‚
â”‚              â”‚  â”‚                  â”‚
â”‚ - register   â”‚  â”‚ - evaluate       â”‚
â”‚ - trigger    â”‚  â”‚ - execute        â”‚
â”‚ - getStats   â”‚  â”‚ - cascade        â”‚
â”‚ - getRules   â”‚  â”‚ - validate       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DÃ‰PENDANCES EXTERNES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Prisma    â”‚  â”‚  Ollama    â”‚  â”‚  Logger    â”‚
â”‚  Client    â”‚  â”‚  Client    â”‚  â”‚  System    â”‚
â”‚            â”‚  â”‚            â”‚  â”‚            â”‚
â”‚ - Database â”‚  â”‚ - AI       â”‚  â”‚ - Audit    â”‚
â”‚ - CRUD     â”‚  â”‚ - Validationâ”‚  â”‚ - Trace   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Templates Dynamiques - RÃ©solution

```
EXEMPLE DE TEMPLATE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ParamÃ¨tres d'action:
{
  to: "{{payload.clientEmail}}",
  subject: "URGENT : {{payload.procedureType}}",
  body: "Bonjour {{payload.clientName}},
         Ã‰vÃ©nement: {{event.type}}
         Date: {{event.timestamp}}
         Tenant: {{context.tenantId}}"
}

SOURCES DE DONNÃ‰ES
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  event          â”‚  â†’ Type d'Ã©vÃ©nement dÃ©clenchÃ©
â”‚  - type         â”‚     Timestamp
â”‚  - timestamp    â”‚     ID
â”‚  - id           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  payload        â”‚  â†’ DonnÃ©es spÃ©cifiques Ã©vÃ©nement
â”‚  - clientEmail  â”‚     Informations mÃ©tier
â”‚  - clientName   â”‚     Contexte business
â”‚  - procedureTypeâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  context        â”‚  â†’ Contexte exÃ©cution
â”‚  - tenantId     â”‚     RÃ¨gle ID
â”‚  - ruleId       â”‚     ExÃ©cution ID
â”‚  - executionId  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  result         â”‚  â†’ RÃ©sultat action prÃ©cÃ©dente
â”‚  - id           â”‚     (dans cascade onSuccess)
â”‚  - ...          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ‰SOLUTION (Interpolation)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

to: "{{payload.clientEmail}}"
â†’ to: "dubois@example.com"

subject: "URGENT : {{payload.procedureType}}"
â†’ subject: "URGENT : OQTF"

body: "Bonjour {{payload.clientName}}, ..."
â†’ body: "Bonjour M. DUBOIS, ..."

RÃ‰SULTAT FINAL
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  to: "dubois@example.com",
  subject: "URGENT : OQTF",
  body: "Bonjour M. DUBOIS,
         Ã‰vÃ©nement: email:urgent
         Date: 2026-01-15T10:30:00Z
         Tenant: tenant_abc"
}
```

---

## ğŸ“ˆ Performance & ScalabilitÃ©

```
GESTION DE CHARGE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ScÃ©nario: 1000 Ã©vÃ©nements/heure
â”‚
â”œâ”€â–º Ã‰vÃ©nements indÃ©pendants (90%)
â”‚   â”œâ”€â–º Mode PARALLÃˆLE activÃ© automatiquement
â”‚   â”œâ”€â–º ExÃ©cution simultanÃ©e des actions
â”‚   â””â”€â–º Throughput: ~100 Ã©vÃ©nements/seconde
â”‚
â””â”€â–º Ã‰vÃ©nements avec dÃ©pendances (10%)
    â”œâ”€â–º Mode SÃ‰QUENTIEL pour garantir ordre
    â”œâ”€â–º Queue de traitement FIFO
    â””â”€â–º Throughput: ~10 Ã©vÃ©nements/seconde

OPTIMISATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. CACHE DES RÃˆGLES                â”‚
â”‚     - RÃ¨gles chargÃ©es en mÃ©moire    â”‚
â”‚     - Pas de DB query Ã  chaque      â”‚
â”‚       Ã©vÃ©nement                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Ã‰VALUATION LAZY                 â”‚
â”‚     - Conditions Ã©valuÃ©es seulement â”‚
â”‚       si Ã©vÃ©nement matche            â”‚
â”‚     - Short-circuit AND/OR          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. EXÃ‰CUTION ASYNCHRONE            â”‚
â”‚     - Toutes les actions en async   â”‚
â”‚     - Promise.all() pour parallÃ¨le  â”‚
â”‚     - Timeout pour Ã©viter blocage   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. RATE LIMITING                   â”‚
â”‚     - Protection contre spam        â”‚
â”‚     - Max 1000 exÃ©cutions/minute    â”‚
â”‚     - Par tenant et global          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

RÃ‰SULTAT
â”€â”€â”€â”€â”€â”€â”€â”€
âœ… ScalabilitÃ© horizontale
âœ… Performance constante
âœ… Gestion de pics de charge
âœ… Protection contre surcharge
```

---

## ğŸ› ï¸ IntÃ©gration dans le Code Existant

```
AVANT (Code manuel rÃ©pÃ©titif)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// API Route: /api/emails/urgent
export async function POST(req: Request) {
  const { emailData } = await req.json();
  
  // 1. CrÃ©er workspace manuellement
  const workspace = await prisma.workspace.create({...});
  
  // 2. CrÃ©er procÃ©dure manuellement
  const procedure = await prisma.procedure.create({...});
  
  // 3. CrÃ©er alertes manuellement
  const alert = await prisma.alert.create({...});
  
  // 4. Envoyer notifications manuellement
  await sendNotification({...});
  
  // 5. Logger manuellement
  logger.info('Workspace crÃ©Ã©', {...});
  
  return NextResponse.json({ success: true });
}


APRÃˆS (Avec systÃ¨me de workflow)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// API Route: /api/emails/urgent
import { triggerWorkflowEvent } from '@/lib/workflows/advanced-workflow-engine';

export async function POST(req: Request) {
  const { emailData } = await req.json();
  
  // 1 LIGNE â†’ Tout est automatique !
  await triggerWorkflowEvent('email:urgent', session.user.tenantId, {
    classification: emailData.classification,
    clientName: emailData.from.name,
    clientEmail: emailData.from.email,
    emailSubject: emailData.subject,
    priority: emailData.priority,
    extractedInfo: emailData.extractedInfo
  });
  
  return NextResponse.json({ success: true });
}

AVANTAGES
â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ 80% moins de code
âœ“ Logique centralisÃ©e
âœ“ Facile Ã  modifier (rÃ¨gles)
âœ“ Testable sÃ©parÃ©ment
âœ“ TraÃ§abilitÃ© complÃ¨te
âœ“ RÃ©utilisable partout
```

---

## ğŸ¯ Conclusion Visuelle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                AVANT: Code Spaghetti ğŸ                        â”‚
â”‚                                                                â”‚
â”‚  API Route 1 â”€â”€â”                                              â”‚
â”‚                â”œâ”€â”€â–º Logique mÃ©tier dispersÃ©e                  â”‚
â”‚  API Route 2 â”€â”€â”¤    - DupliquÃ©e partout                       â”‚
â”‚                â”‚    - Difficile Ã  maintenir                    â”‚
â”‚  API Route 3 â”€â”€â”¤    - Pas de cohÃ©rence                        â”‚
â”‚                â”‚    - Oublis frÃ©quents                         â”‚
â”‚  Worker 1 â”€â”€â”€â”€â”€â”¤                                              â”‚
â”‚                â”‚                                              â”‚
â”‚  Worker 2 â”€â”€â”€â”€â”€â”˜                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                            â–¼ TRANSFORMATION

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         APRÃˆS: SystÃ¨me de Workflow CentralisÃ© ğŸ¯               â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           ADVANCED WORKFLOW ENGINE                   â”‚    â”‚
â”‚  â”‚  - 60+ Ã©vÃ©nements                                    â”‚    â”‚
â”‚  â”‚  - 40+ actions                                       â”‚    â”‚
â”‚  â”‚  - Cascade infinie                                   â”‚    â”‚
â”‚  â”‚  - Validation IA                                     â”‚    â”‚
â”‚  â”‚  - Audit complet                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â–²                                     â”‚
â”‚                          â”‚                                     â”‚
â”‚  API Routes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â–º triggerWorkflowEvent()       â”‚
â”‚  Workers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚  Crons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚  Webhooks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚                                                                â”‚
â”‚  RÃ‰SULTAT:                                                     â”‚
â”‚  âœ… Logique centralisÃ©e                                       â”‚
â”‚  âœ… Facile Ã  modifier                                         â”‚
â”‚  âœ… 100% cohÃ©rence                                            â”‚
â”‚  âœ… ZÃ©ro oubli                                                â”‚
â”‚  âœ… TraÃ§abilitÃ© totale                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ğŸ¨ Comprendre visuellement le systÃ¨me de workflow conditionnel !**

**ğŸ“š Documentation complÃ¨te :**
- [Guide d'Utilisation](./docs/GUIDE_WORKFLOW_USAGE.md)
- [Architecture Technique](./docs/WORKFLOW_CONDITIONNEL_AVANCE.md)
- [DÃ©marrage Rapide](./WORKFLOW_QUICKSTART.md)

*Diagrammes crÃ©Ã©s le 7 janvier 2026*
