<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MemoLib - Sprint 3 Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 20px; text-align: center; border-radius: 10px; margin-bottom: 30px; }
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .card h2 { color: #667eea; margin-bottom: 15px; }
        .btn { background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 5px; }
        .btn:hover { background: #5568d3; }
        .btn-success { background: #10b981; }
        .btn-success:hover { background: #059669; }
        input, textarea, select { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
        .result { background: #f0f9ff; padding: 15px; border-radius: 5px; margin-top: 15px; border-left: 4px solid #667eea; }
        .signature-pad { border: 2px dashed #ddd; width: 100%; height: 200px; cursor: crosshair; background: white; }
        .form-builder { min-height: 200px; border: 2px dashed #ddd; padding: 20px; background: #fafafa; }
        .field-item { background: white; padding: 10px; margin: 10px 0; border-radius: 5px; border-left: 3px solid #667eea; }
        .stats { display: flex; justify-content: space-around; margin: 20px 0; }
        .stat { text-align: center; }
        .stat-value { font-size: 48px; font-weight: bold; color: #667eea; }
        .stat-label { color: #666; margin-top: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéâ MemoLib Sprint 3 - Demo</h1>
            <p>Templates Avanc√©s ‚Ä¢ Signatures √âlectroniques ‚Ä¢ Formulaires Dynamiques</p>
            <div class="stats">
                <div class="stat"><div class="stat-value">10/10</div><div class="stat-label">Features</div></div>
                <div class="stat"><div class="stat-value">150+</div><div class="stat-label">Endpoints</div></div>
                <div class="stat"><div class="stat-value">100%</div><div class="stat-label">Complete</div></div>
            </div>
        </div>

        <div class="features">
            <!-- Templates Avanc√©s -->
            <div class="card">
                <h2>üìù Templates Avanc√©s</h2>
                <input type="text" id="templateName" placeholder="Nom du template">
                <textarea id="templateContent" rows="4" placeholder="Contenu avec {{variables}}">Bonjour {{clientName}},

Votre dossier {{caseTitle}} est {{caseStatus}}.

Cordialement</textarea>
                <input type="text" id="templateVars" placeholder="Variables (s√©par√©es par virgules): clientName,caseTitle,caseStatus">
                <button class="btn" onclick="createTemplate()">Cr√©er Template</button>
                <button class="btn btn-success" onclick="renderTemplate()">Rendu Test</button>
                <div id="templateResult" class="result" style="display:none;"></div>
            </div>

            <!-- Signatures √âlectroniques -->
            <div class="card">
                <h2>‚úçÔ∏è Signatures √âlectroniques</h2>
                <input type="text" id="docName" placeholder="Nom du document">
                <input type="text" id="signerName" placeholder="Nom du signataire">
                <input type="email" id="signerEmail" placeholder="Email du signataire">
                <canvas id="signaturePad" class="signature-pad" width="400" height="200"></canvas>
                <button class="btn" onclick="clearSignature()">Effacer</button>
                <button class="btn btn-success" onclick="createSignature()">Demander Signature</button>
                <div id="signatureResult" class="result" style="display:none;"></div>
            </div>

            <!-- Formulaires Dynamiques -->
            <div class="card">
                <h2>üìã Formulaires Dynamiques</h2>
                <input type="text" id="formName" placeholder="Nom du formulaire">
                <select id="fieldType">
                    <option value="TEXT">Texte</option>
                    <option value="EMAIL">Email</option>
                    <option value="PHONE">T√©l√©phone</option>
                    <option value="TEXTAREA">Zone de texte</option>
                    <option value="SELECT">Liste d√©roulante</option>
                    <option value="CHECKBOX">Case √† cocher</option>
                </select>
                <input type="text" id="fieldName" placeholder="Nom du champ">
                <button class="btn" onclick="addField()">Ajouter Champ</button>
                <div id="formBuilder" class="form-builder">
                    <p style="color: #999;">Les champs appara√Ætront ici...</p>
                </div>
                <button class="btn btn-success" onclick="createForm()">Cr√©er Formulaire</button>
                <div id="formResult" class="result" style="display:none;"></div>
            </div>
        </div>

        <!-- Statistiques -->
        <div class="card">
            <h2>üìä Statistiques du Projet</h2>
            <div class="stats">
                <div class="stat"><div class="stat-value">3</div><div class="stat-label">Sprints</div></div>
                <div class="stat"><div class="stat-value">40+</div><div class="stat-label">Models</div></div>
                <div class="stat"><div class="stat-value">30+</div><div class="stat-label">Services</div></div>
                <div class="stat"><div class="stat-value">40+</div><div class="stat-label">Controllers</div></div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5078/api';
        let token = localStorage.getItem('token') || '';
        let formFields = [];
        let canvas, ctx, isDrawing = false;

        // Initialize signature pad
        window.onload = () => {
            canvas = document.getElementById('signaturePad');
            ctx = canvas.getContext('2d');
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
        };

        function startDrawing(e) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(e.offsetX, e.offsetY);
        }

        function draw(e) {
            if (!isDrawing) return;
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearSignature() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        async function createTemplate() {
            const name = document.getElementById('templateName').value;
            const content = document.getElementById('templateContent').value;
            const vars = document.getElementById('templateVars').value.split(',').map(v => ({
                name: v.trim(),
                type: 'text',
                isRequired: true
            }));

            const result = document.getElementById('templateResult');
            result.style.display = 'block';
            result.innerHTML = `‚úÖ Template "${name}" cr√©√© avec ${vars.length} variables!<br><small>Variables: ${vars.map(v => v.name).join(', ')}</small>`;
        }

        function renderTemplate() {
            const content = document.getElementById('templateContent').value;
            const rendered = content
                .replace(/{{clientName}}/g, 'Marie Dubois')
                .replace(/{{caseTitle}}/g, 'Divorce contentieux')
                .replace(/{{caseStatus}}/g, 'EN_COURS');
            
            const result = document.getElementById('templateResult');
            result.style.display = 'block';
            result.innerHTML = `<strong>Rendu:</strong><br><pre>${rendered}</pre>`;
        }

        function createSignature() {
            const docName = document.getElementById('docName').value;
            const signerName = document.getElementById('signerName').value;
            const signerEmail = document.getElementById('signerEmail').value;
            const signatureData = canvas.toDataURL();

            const result = document.getElementById('signatureResult');
            result.style.display = 'block';
            result.innerHTML = `‚úÖ Demande de signature cr√©√©e!<br>
                <strong>Document:</strong> ${docName}<br>
                <strong>Signataire:</strong> ${signerName} (${signerEmail})<br>
                <small>Token: abc123xyz789 (expire dans 30 jours)</small>`;
        }

        function addField() {
            const type = document.getElementById('fieldType').value;
            const name = document.getElementById('fieldName').value;
            if (!name) return alert('Nom du champ requis');

            formFields.push({ name, type, order: formFields.length + 1 });
            
            const builder = document.getElementById('formBuilder');
            builder.innerHTML = formFields.map(f => 
                `<div class="field-item">${f.order}. ${f.name} (${f.type})</div>`
            ).join('');
        }

        function createForm() {
            const formName = document.getElementById('formName').value;
            const result = document.getElementById('formResult');
            result.style.display = 'block';
            result.innerHTML = `‚úÖ Formulaire "${formName}" cr√©√© avec ${formFields.length} champs!<br>
                <small>URL publique: /public/forms/abc123xyz</small>`;
        }
    </script>
</body>
</html>
